{
  "id": "gh_architecture_01389",
  "source": "github",
  "source_url": "https://github.com/yaml/go-yaml/blob/6d97a84ef13c520d255c2c1777737e56c1544b6e/docs/dev/comment-flow.mmd",
  "github_repo": "yaml/go-yaml",
  "github_file_path": "docs/dev/comment-flow.mmd",
  "diagram_type": "architecture",
  "code": "---\ntitle: Comment Flow Through Load Stack\n---\nflowchart TB\n    subgraph SCANNER [\"Scanner\"]\n        S1[scanLineComment<br/>same-line comments]\n        S2[scanComments<br/>classify head/foot/line]\n        S3[Comment struct<br/>head, line, foot fields]\n        S1 --> S3\n        S2 --> S3\n    end\n\n    subgraph PARSER [\"Parser\"]\n        P1[UnfoldComments<br/>join to tokens by position]\n        P2[Parser fields<br/>HeadComment, LineComment, FootComment]\n        P3[setEventComments<br/>transfer to Event]\n        P4[TAIL_COMMENT_EVENT<br/>block-end foot comments]\n        P1 --> P2\n        P2 --> P3\n        P2 --> P4\n    end\n\n    subgraph COMPOSER [\"Composer\"]\n        C1[node<br/>basic transfer]\n        C2[mapping<br/>reassignment logic]\n        C3[Node fields<br/>HeadComment, LineComment, FootComment]\n        C1 --> C3\n        C2 --> C3\n    end\n\n    S3 --> P1\n    P3 --> C1\n    P4 --> C2\n",
  "content_size": 894,
  "collected_at": "2026-02-06T01:45:37.082751",
  "license": "apache-2.0",
  "license_name": "Apache License 2.0",
  "compilation_status": "success",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license_url": "https://api.github.com/licenses/apache-2.0",
  "repo_stars": 426,
  "repo_forks": 41,
  "cscw_dialogue": [
    {
      "turn_id": 1,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "这里必须包含 \"Scanner\" 和 scanLineComment<br/>same-line comments 这一块。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 2,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "收到。这是不是一个判断条件？我暂时写成 '\"Scanner\" 和 scanLineComment<br/>same-line comments'。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 3,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "没问题。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 4,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "SCANNER",
        "S1"
      ],
      "is_repair": false
    },
    {
      "turn_id": 5,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "接下来是关于 scanComments<br/>classify head/foot/line 和 Comment struct<br/>head, line, foot fields 的逻辑。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 6,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "收到。这是不是一个判断条件？我暂时写成 'scanComments<br/>classify head/foot/line 和 Comment struct<br/>head, line, foot fields'。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 7,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "对的，就这样。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 8,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "S2",
        "S3"
      ],
      "is_repair": false
    },
    {
      "turn_id": 9,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "这里必须包含 \"Parser\" 和 UnfoldComments<br/>join to tokens by position 这一块。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 10,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "我把它加进去了，标签显示为 '\"Parser\" 和 UnfoldComments<br/>join to tokens by position'，你看看合适吗？",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 11,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "可以，继续吧。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 12,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "PARSER",
        "P1"
      ],
      "is_repair": false
    },
    {
      "turn_id": 13,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "我们需要加一个处理 Parser fields<br/>HeadComment, LineComment, FootComment 和 setEventComments<br/>transfer to Event 的环节。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 14,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "好的，我把它画成一个矩形框，名字叫 'Parser fields<br/>HeadComment, LineComment, FootComment 和 setEventComments<br/>transfer to Event'，对吧？",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 15,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "可以，继续吧。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 16,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "P2",
        "P3"
      ],
      "is_repair": false
    },
    {
      "turn_id": 17,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "我们需要加一个处理 TAIL_COMMENT_EVENT<br/>block-end foot comments 和 \"Composer\" 的环节。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 18,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "收到。这是不是一个判断条件？我暂时写成 'TAIL_COMMENT_EVENT<br/>block-end foot comments 和 \"Composer\"'。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 19,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "嗯，这样看起来很清晰。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 20,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "P4",
        "COMPOSER"
      ],
      "is_repair": false
    },
    {
      "turn_id": 21,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "接下来是关于 node<br/>basic transfer 和 mapping<br/>reassignment logic 的逻辑。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 22,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "好的，我把它画成一个矩形框，名字叫 'node<br/>basic transfer 和 mapping<br/>reassignment logic'，对吧？",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 23,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "对的，就这样。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 24,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "C1",
        "C2"
      ],
      "is_repair": false
    },
    {
      "turn_id": 25,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "然后，流程会走到 Node fields<br/>HeadComment, LineComment, FootComment。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 26,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "收到。这是不是一个判断条件？我暂时写成 'Node fields<br/>HeadComment, LineComment, FootComment'。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 27,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "嗯，这样看起来很清晰。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 28,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "C3"
      ],
      "is_repair": false
    }
  ],
  "dialogue_metadata": {
    "total_turns": 28,
    "repair_count": 0,
    "grounding_acts_count": 14,
    "theoretical_framework": "Grounding in Communication (Clark & Brennan, 1991)"
  }
}