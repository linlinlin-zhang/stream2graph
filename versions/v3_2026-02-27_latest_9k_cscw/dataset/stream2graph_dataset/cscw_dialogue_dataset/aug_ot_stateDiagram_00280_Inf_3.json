{
  "id": "aug_ot_stateDiagram_00280_Inf_3",
  "source": "augmented_real_structure",
  "source_url": "https://github.com/jacero-io/kode-operator/blob/5d36809dc147909b7087b0e1aa1f785b7ce569a6/docs/diagrams/kode-ensure-resources.mmd",
  "source_type": "github_search_special",
  "github_repo": "jacero-io/kode-operator",
  "diagram_type": "stateDiagram",
  "code": "stateDiagram-v2\n    [Infra_IngressController] --> FetchTemplate\n    FetchTemplate --> InitializeConfig : Template Found\n    InitializeConfig --> EnsureSecret\n    \n    EnsureSecret --> EnsureService : Secret Created/Updated\n    EnsureSecret --> HandleError : Error\n\n    EnsureService --> EnsurePVC : Service Created/Updated\n    EnsureService --> HandleError : Error\n\n    EnsurePVC --> EnsureStatefulSet : PVC Created/Updated\n    EnsurePVC --> HandleError : Error\n\n    EnsureStatefulSet --> ResourcesEnsured : StatefulSet Created/Updated\n    EnsureStatefulSet --> HandleError : Error\n\n    HandleError --> [Infra_IngressController] : Return Error\n\n    ResourcesEnsured --> [Infra_LoadBalancer] : All Resources Created/Updated\n\n    state HandleError {Infra_WorkerNode] --> LogError\n        LogError --> UpdateFailedStatus\n        UpdateFailedStatus --> ReturnError\n        ReturnError --> [Infra_IngressController]\n    }\n\n    note right of FetchTemplate\n        Fetches the template using TemplateManager\n    end note\n\n    note right of InitializeConfig\n        Initializes KodeResourceConfig\n    end note\n\n    note right of EnsureSecret\n        Creates or updates the Secret\n        if Credentials are specified\n    end note\n\n    note right of EnsureService\n        Creates or updates the Service\n    end note\n\n    note right of EnsurePVC\n        Creates or updates the PVC\n        if Storage is specified\n    end note\n\n    note right of EnsureStatefulSet\n        Creates or updates the StatefulSet\n    end note",
  "content_size": 1420,
  "collected_at": "2026-02-06T10:40:07.311690",
  "compilation_status": "success",
  "license": "apache-2.0",
  "license_name": "Apache License 2.0",
  "license_url": "https://api.github.com/licenses/apache-2.0",
  "repo_stars": 0,
  "repo_forks": 0,
  "repo_owner": "jacero-io",
  "repo_name": "kode-operator",
  "repo_description": "Development environments, the cloud-native way",
  "repo_language": "Go",
  "repo_topics": [],
  "repo_created_at": "2024-05-19T07:04:51Z",
  "repo_updated_at": "2025-01-18T14:42:33Z",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "augmentation_domain": "Infra",
  "seed_id": "ot_stateDiagram_00280",
  "cscw_dialogue": [
    {
      "turn_id": 1,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "用户在这里会遇到 Infra_IngressController 和 Infra_WorkerNode 的分支。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 2,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "好的，我把它画成一个矩形框，名字叫 'Infra_IngressController 和 Infra_WorkerNode'，对吧？",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 3,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "没问题。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 4,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "v2",
        "HandleError"
      ],
      "is_repair": false
    }
  ],
  "dialogue_metadata": {
    "total_turns": 4,
    "repair_count": 0,
    "grounding_acts_count": 2,
    "theoretical_framework": "Grounding in Communication (Clark & Brennan, 1991)"
  }
}