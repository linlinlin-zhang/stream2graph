{
  "id": "gh_architecture_01830",
  "source": "github",
  "source_url": "https://github.com/KiritoMainBro88/kiritomainbro-monorepo/blob/f022137c7dc280db2b032ae9e3a88a305fa49167/docs/diagrams/architecture.mmd",
  "github_repo": "KiritoMainBro88/kiritomainbro-monorepo",
  "github_file_path": "docs/diagrams/architecture.mmd",
  "diagram_type": "architecture",
  "code": "graph TB\n    subgraph \"Client Layer\"\n        WEB[Web Frontend<br/>Next.js + React]\n        MOBILE[Mobile App<br/>React Native]\n        API_CLIENT[API Client<br/>SDK]\n    end\n    \n    subgraph \"CDN & Load Balancer\"\n        CDN[Vercel Edge Network]\n        LB[Load Balancer<br/>Nginx]\n    end\n    \n    subgraph \"Application Layer\"\n        API[API Server<br/>NestJS + Fastify<br/>Port 4000]\n        WEB_APP[Web App<br/>Next.js<br/>Port 3000]\n    end\n    \n    subgraph \"Authentication & Security\"\n        JWT[JWT Tokens<br/>Access + Refresh]\n        CSRF[CSRF Protection<br/>Double Submit]\n        RATE_LIMIT[Rate Limiting<br/>Redis-based]\n    end\n    \n    subgraph \"Business Logic\"\n        AUTH[Authentication<br/>Service]\n        PAYMENTS[Payments<br/>Service]\n        ORDERS[Orders<br/>Service]\n        DELIVERIES[Deliveries<br/>Service]\n        TICKETS[Tickets<br/>Service]\n        SEARCH[Search<br/>Service]\n        NEWS[News<br/>Service]\n        EXPORTS[Exports<br/>Service]\n    end\n    \n    subgraph \"Data Layer\"\n        DB[(PostgreSQL<br/>Neon Database)]\n        REDIS[(Redis<br/>Upstash Cache)]\n        FILES[(File Storage<br/>S3/R2)]\n    end\n    \n    subgraph \"External Services\"\n        SEPAY[SEPay<br/>Payment Gateway]\n        DISCORD[Discord<br/>Notifications]\n        EMAIL[Email<br/>SMTP]\n    end\n    \n    subgraph \"Infrastructure\"\n        DOCKER[Docker<br/>Containers]\n        JENKINS[Jenkins<br/>CI/CD]\n        SONAR[SonarQube<br/>Quality Gate]\n        MONITORING[Monitoring<br/>Prometheus + Grafana]\n    end\n    \n    subgraph \"Deployment\"\n        VERCEL[Vercel<br/>Frontend]\n        FLY[Fly.io<br/>API Production]\n        KOYEB[Koyeb<br/>API Staging]\n    end\n    \n    %% Client connections\n    WEB --> CDN\n    MOBILE --> CDN\n    API_CLIENT --> CDN\n    \n    %% CDN to Load Balancer\n    CDN --> LB\n    \n    %% Load Balancer to Applications\n    LB --> API\n    LB --> WEB_APP\n    \n    %% API to Business Logic\n    API --> AUTH\n    API --> PAYMENTS\n    API --> ORDERS\n    API --> DELIVERIES\n    API --> TICKETS\n    API --> SEARCH\n    API --> NEWS\n    API --> EXPORTS\n    \n    %% Business Logic to Data Layer\n    AUTH --> DB\n    AUTH --> REDIS\n    PAYMENTS --> DB\n    ORDERS --> DB\n    DELIVERIES --> DB\n    TICKETS --> DB\n    SEARCH --> DB\n    NEWS --> DB\n    EXPORTS --> DB\n    EXPORTS --> FILES\n    \n    %% Authentication & Security\n    API --> JWT\n    API --> CSRF\n    API --> RATE_LIMIT\n    RATE_LIMIT --> REDIS\n    \n    %% External Services\n    PAYMENTS --> SEPAY\n    TICKETS --> DISCORD\n    AUTH --> EMAIL\n    \n    %% Infrastructure\n    API --> DOCKER\n    WEB_APP --> DOCKER\n    DOCKER --> JENKINS\n    JENKINS --> SONAR\n    JENKINS --> MONITORING\n    \n    %% Deployment\n    WEB_APP --> VERCEL\n    API --> FLY\n    API --> KOYEB\n    \n    %% Styling\n    classDef client fill:#e1f5fe\n    classDef cdn fill:#f3e5f5\n    classDef app fill:#e8f5e8\n    classDef security fill:#fff3e0\n    classDef business fill:#fce4ec\n    classDef data fill:#e0f2f1\n    classDef external fill:#f1f8e9\n    classDef infra fill:#e3f2fd\n    classDef deploy fill:#f9fbe7\n    \n    class WEB,MOBILE,API_CLIENT client\n    class CDN,LB cdn\n    class API,WEB_APP app\n    class JWT,CSRF,RATE_LIMIT security\n    class AUTH,PAYMENTS,ORDERS,DELIVERIES,TICKETS,SEARCH,NEWS,EXPORTS business\n    class DB,REDIS,FILES data\n    class SEPAY,DISCORD,EMAIL external\n    class DOCKER,JENKINS,SONAR,MONITORING infra\n    class VERCEL,FLY,KOYEB deploy\n",
  "content_size": 3416,
  "collected_at": "2026-02-06T02:03:53.041003",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "mit",
  "license_name": "MIT License",
  "license_url": "https://api.github.com/licenses/mit",
  "repo_stars": 2,
  "repo_forks": 0
}