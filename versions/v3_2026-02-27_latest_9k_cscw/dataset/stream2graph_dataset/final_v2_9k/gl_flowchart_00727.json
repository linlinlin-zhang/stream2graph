{
  "id": "gl_flowchart_00727",
  "source": "gitlab",
  "source_url": "https://github.com/Fayezx0/Tarjuman/blob/af2f3808c4079a5b1235a70ec53c6d35922a48c6/ARCHITECTURE_FLOW.mmd",
  "source_note": "collected_from_github_final",
  "github_repo": "Fayezx0/Tarjuman",
  "diagram_type": "flowchart",
  "code": "flowchart TD\n    START([User Types Verse<br/>عفت الديار محلها فمقامها]) --> FRONT[Frontend<br/>Next.js]\n    \n    FRONT --> |POST /search| API[FastAPI Backend]\n    \n    API --> GUARD{Guardrails Check}\n    GUARD -->|Invalid| REJECT[400 Error<br/>Not Poetry Query]\n    GUARD -->|Valid| HYBRID[Hybrid Search]\n    \n    HYBRID --> EXACT{Exact Match?}\n    EXACT -->|Found| RESULT1[Result: Score 1.0]\n    EXACT -->|Not Found| BM25_SEARCH[BM25 Search]\n    \n    BM25_SEARCH --> BM25_RESULT[Top 5 Results<br/>Score: 0.85]\n    BM25_SEARCH --> FAISS_SEARCH[FAISS Search]\n    \n    FAISS_SEARCH --> FAISS_RESULT[Top 5 Results<br/>Score: 0.78]\n    \n    BM25_RESULT --> MERGE[Merge & Rank<br/>0.7 × BM25 + 0.3 × FAISS]\n    FAISS_RESULT --> MERGE\n    RESULT1 --> MERGE\n    \n    MERGE --> FINAL[Final Result<br/>Score: 0.829]\n    \n    FINAL --> LLM_CHECK{LLM Available?}\n    LLM_CHECK -->|Yes| LLM[Enhance Explanation<br/>Llama 3.3 70B]\n    LLM_CHECK -->|No| ORIGINAL[Original Explanation]\n    \n    LLM --> ENHANCED[Enhanced Explanation]\n    ORIGINAL --> ENHANCED\n    \n    ENHANCED --> RESPONSE[API Response<br/>JSON]\n    RESPONSE --> DISPLAY[Display Result<br/>Verse Card]\n    DISPLAY --> END([User Sees Result])\n    \n    style START fill:#e3f2fd\n    style FRONT fill:#e1f5ff\n    style API fill:#fff4e1\n    style HYBRID fill:#f3e5f5\n    style LLM fill:#e8f5e9\n    style DISPLAY fill:#e1f5ff\n    style END fill:#e3f2fd\n    style REJECT fill:#ffebee\n",
  "content_size": 1430,
  "collected_at": "2026-02-06T14:19:30.825930",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}