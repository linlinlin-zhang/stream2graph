{
  "id": "gh_flowchart_00219",
  "source": "github",
  "source_url": "https://github.com/curatorian/voile/blob/b80ea51e93e2eb3038fb0d4eae73f0102228663e/docs/architecture.mmd",
  "github_repo": "curatorian/voile",
  "github_file_path": "docs/architecture.mmd",
  "diagram_type": "flowchart",
  "code": "flowchart LR\n  %% Client\n  subgraph Client\n    direction TB\n    A[User Browser / Mobile App] -->|\"HTTP / WebSocket LiveView\"| Endpoint[Phoenix Endpoint]\n    Atrium[Atrium Patron Portal] -->|\"HTTP / WS\"| Endpoint\n  end\n\n  %% Phoenix App\n  subgraph WebLayer[Phoenix App]\n    direction TB\n    Endpoint --> Router[Router & Pipelines]\n    Router --> LiveView[LiveView / LiveComponents]\n    Router --> Controllers[Controllers / API Controllers]\n    LiveView --> UI[Core Components / Forms / Streams]\n    Controllers --> Contexts[Contexts business logic]\n    Contexts --> Repo[(Ecto.Repo / Postgres)]\n    Contexts --> AttachmentMgr[Attachment Manager / Presigner]\n    Contexts --> Auth[\"Auth & Session / RBAC (phx.gen.auth)\"]\n    LiveView -->|\"pubsub events\"| PubSub[(Phoenix.PubSub)]\n  end\n\n  %% Storage & Attachment flow\n  subgraph Storage\n    direction TB\n    AttachmentMgr --> Presigner[Presigner Service]\n    Presigner --> ObjectStorage[(S3-compatible Object Storage)]\n    ObjectStorage --> AttachmentWorker[\"Attachment Processor (background job)\"]\n    AttachmentWorker --> Repo\n  end\n\n  %% Background processing\n  subgraph Background\n    direction TB\n    Queue[Oban / Background Queue] --> AttachmentWorker\n    Queue --> FineBot[Fine Bot / Scheduler]\n    FineBot --> Repo\n    FineBot --> Notifier[\"Notification System (Email/SMS)\"]\n    Notifier --> ExternalMail[(SMTP / Gmail API)]\n  end\n\n  %% Infrastructure & integrations (project-specific)\n  subgraph Infra\n    direction TB\n    Repo --> Postgres[(Postgres DB)]\n    Assets[_build/esbuild & tailwind] --> Static[Static Assets Served]\n    Container[\"Podman / Containerfile & Containerfile.dev\"] --> Image[Podman Image]\n    Scripts[\"./scripts/deploy.sh, ./scripts/manage.sh, mix precommit\"] --> Container\n    ExternalAPI[\"Third-party APIs (Payment, Xendit, Gmail API, etc.)\"]\n  end\n\n  %% cross connections\n  Endpoint -->|\"on_mount/fetch\"| Auth\n  Contexts -->|\"enqueue jobs\"| Queue\n  Contexts -->|\"http\"| Req[Req HTTP client]\n  Notifier -->|\"send\"| ExternalMail\n  Image -->|\"deploy via podman\"| ImageDeployed[\"Deployed Instance (host)\"]\n\n  %% styling\n  classDef client fill:#fef3c7,stroke:#f59e0b\n  classDef web fill:#eef2ff,stroke:#4338ca\n  classDef storage fill:#ecfeff,stroke:#0891b2\n  classDef infra fill:#f0f9ff,stroke:#0ea5a4\n\n  class A,Atrium client\n  class Endpoint,Router,LiveView,Controllers,UI,Contexts,Auth,PubSub web\n  class Presigner,ObjectStorage,AttachmentWorker,AttachmentMgr storage\n  class Repo,Postgres,Assets,Container,Image,Scripts,ExternalAPI,Req infra\n\n  %% short legend\n  subgraph Legend\n    direction LR\n    L1[HTTP / WS flows] --> L2[Background / Async flows]\n  end\n",
  "content_size": 2640,
  "collected_at": "2026-02-06T01:42:44.954102",
  "compilation_status": "success",
  "license": "apache-2.0",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "repo_owner": "curatorian",
  "repo_name": "voile",
  "repo_description": "Voile, the Magic Library",
  "repo_language": "Elixir",
  "repo_topics": [],
  "repo_created_at": "2025-02-25T03:35:19Z",
  "repo_updated_at": "2026-02-04T16:38:51Z"
}