{
  "id": "gl_timeline_00130",
  "source": "gitlab",
  "source_url": "https://github.com/suprachakra/AtlasMesh-Fleet-OS/blob/de69e6cd300f1e29301b16e68db67ac7874e847b/docs/diagrams/sequence/business-flows/security_incident_response_v1.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "suprachakra/AtlasMesh-Fleet-OS",
  "diagram_type": "timeline",
  "code": "---\r\ntitle: Security Incident Response - AtlasMesh Fleet OS\r\n---\r\nsequenceDiagram\r\n    participant VA as Vehicle Agent\r\n    participant ZT as Zero-Trust IAM\r\n    participant SM as Security Monitor\r\n    participant IR as Incident Response\r\n    participant PE as Policy Engine\r\n    participant KS as Key/Secret Management\r\n    participant AL as Audit Log\r\n    participant OC as On-Call Team\r\n    \r\n    Note over VA,OC: Security Incident Detection & Response\r\n    \r\n    %% Anomaly Detection\r\n    VA->>+ZT: AuthenticateRequest(certificate, requestDetails)\r\n    ZT->>ZT: Validate certificate and permissions\r\n    ZT->>+SM: LogAuthenticationAttempt(vehicleId, result, metadata)\r\n    SM->>SM: Analyze authentication patterns\r\n    \r\n    alt Suspicious Activity Detected\r\n        SM->>SM: Correlate with threat intelligence\r\n        SM->>+IR: TriggerSecurityAlert(alertType=SUSPICIOUS_AUTH, vehicleId, evidence)\r\n        IR->>IR: Classify incident severity\r\n        IR->>AL: Log security incident\r\n        \r\n        %% Immediate Response\r\n        alt High Severity Incident\r\n            IR->>+PE: EvaluatePolicy(securityIncident, vehicleId, threatLevel)\r\n            PE->>PE: Execute emergency security policies\r\n            PE->>AL: Log emergency policy activation\r\n            PE->>-IR: PolicyResult(isolateVehicle=true, revokeAccess=true)\r\n            \r\n            IR->>+ZT: RevokeVehicleAccess(vehicleId, reason=SECURITY_INCIDENT)\r\n            ZT->>ZT: Revoke all active tokens\r\n            ZT->>AL: Log access revocation\r\n            ZT->>-IR: AccessRevoked()\r\n            \r\n            IR->>+KS: RotateVehicleSecrets(vehicleId, emergency=true)\r\n            KS->>KS: Generate new certificates immediately\r\n            KS->>AL: Log emergency secret rotation\r\n            KS->>-IR: SecretsRotated(newCertificates)\r\n            \r\n            IR->>+OC: PageOnCallTeam(incident=SECURITY_BREACH, vehicleId, severity=HIGH)\r\n            OC->>-IR: IncidentAcknowledged(responderId)\r\n            \r\n        else Medium/Low Severity\r\n            IR->>+PE: EvaluatePolicy(securityIncident, vehicleId, threatLevel)\r\n            PE->>-IR: PolicyResult(enhanceMonitoring=true)\r\n            \r\n            IR->>+SM: EnhanceMonitoring(vehicleId, duration=24h)\r\n            SM->>-IR: MonitoringEnhanced()\r\n            \r\n            IR->>+OC: NotifySecurityTeam(incident=SUSPICIOUS_ACTIVITY, vehicleId)\r\n            OC->>-IR: NotificationReceived()\r\n        end\r\n        \r\n        %% Investigation & Remediation\r\n        IR->>IR: Begin incident investigation\r\n        IR->>+AL: CollectForensicEvidence(vehicleId, timeRange)\r\n        AL->>AL: Generate forensic timeline\r\n        AL->>-IR: ForensicEvidence(timeline, artifacts)\r\n        \r\n        IR->>+VA: RequestDiagnosticData(vehicleId, forensicMode=true)\r\n        VA->>VA: Collect detailed system state\r\n        VA->>-IR: DiagnosticData(systemState, logs, metrics)\r\n        \r\n        %% Recovery Process\r\n        alt Incident Contained\r\n            IR->>+ZT: RestoreVehicleAccess(vehicleId, newCertificates)\r\n            ZT->>ZT: Validate new identity\r\n            ZT->>AL: Log access restoration\r\n            ZT->>-IR: AccessRestored()\r\n            \r\n            IR->>+VA: NotifySecurityClearance(vehicleId, incidentId)\r\n            VA->>VA: Resume normal operations\r\n            VA->>AL: Log security clearance\r\n            VA->>-IR: OperationsResumed()\r\n            \r\n        else Incident Escalated\r\n            IR->>+OC: EscalateIncident(incidentId, reason, evidence)\r\n            OC->>OC: Engage security experts\r\n            OC->>-IR: IncidentEscalated(expertTeamId)\r\n        end\r\n        \r\n        %% Post-Incident Activities\r\n        IR->>IR: Generate incident report\r\n        IR->>+AL: ArchiveIncidentEvidence(incidentId, report)\r\n        AL->>-IR: EvidenceArchived()\r\n        \r\n        IR->>+PE: UpdateSecurityPolicies(lessonsLearned, newRules)\r\n        PE->>PE: Incorporate security improvements\r\n        PE->>AL: Log policy updates\r\n        PE->>-IR: PoliciesUpdated()\r\n        \r\n    else Normal Activity\r\n        ZT->>-VA: AuthenticationSuccess(token, permissions)\r\n        SM->>-ZT: ActivityLogged()\r\n    end\r\n",
  "content_size": 4153,
  "collected_at": "2026-02-06T14:03:20.321720",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}