{
  "id": "gh_ind_2b2d89194e",
  "source": "github_industrial",
  "repo": "OdyseeTeam/odysee-api",
  "license": "mit",
  "code": "---\ntitle: Publish v4 Flow\n---\nsequenceDiagram\n    actor Client\n    participant OAPI as Odysee API\n    participant Uploads as Uploads Service\n\n    Client->>OAPI: POST /api/v1/asynqueries/uploads/\n    activate OAPI\n    OAPI->>OAPI: token auth\n    OAPI-->>Client: 201 Created (<<token>>, <<location>>)\n    deactivate OAPI\n\n    Client->>Uploads: POST /:location, <<token>>\n    activate Uploads\n    Uploads->>Uploads: validate upload token\n    Uploads-->>Client: 201 Created (Location: <<upload-url>>)\n\n    loop TUS Uploads\n        Client->>Uploads: PATCH /:upload-id, <<token>>\n        Uploads-->>Client: 204 No Content\n    end\n    deactivate Uploads\n\n    Client->>OAPI: POST /api/v1/asynqueries/\n    activate OAPI\n    note Left of OAPI: stream_create {file_path: <<upload-url>>}\n    OAPI-->>Client: 201 Created (<<query-id>>)\n    deactivate OAPI\n\n    loop Status Check\n      Client->>OAPI: GET /api/v1/asynqueries/:query-id\n      activate OAPI\n      alt pending\n        OAPI-->>Client: 204 No Content\n      else completed\n        OAPI-->>Client: 200 OK (JSON-RPC response)\n      else not found\n        OAPI-->>Client: 404 Not Found\n      end\n      deactivate OAPI\n    end\n",
  "diagram_type": "actor size:900..1500",
  "collected_at": "2026-02-27T04:27:41.380852"
}