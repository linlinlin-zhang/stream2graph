{
  "id": "gh_ind_0221a444c5",
  "source": "github_industrial",
  "repo": "wyunchi-ms/azure-shell",
  "license": "mit",
  "code": "graph TD\n    subgraph UserInteraction[\"User Interaction\"]\n        A[User Enters a Prompt] --> B{Interactive or Non-interactive?}\n    end\n\n    subgraph CLIFrontend[\"CLI Frontend (packages/cli)\"]\n        B -->|Interactive| C[Render UI<br/>App.tsx]\n        B -->|Non-interactive| D[Run Non-interactive<br/>nonInteractiveCli.ts]\n        C --> E{Process Input}\n        D --> E\n        E --> F{Input Type?}\n        F -->|\"/command\"| G[Slash Command Processor<br/>slashCommandProcessor.ts]\n        F -->|\"@file\"| H[At Command Processor<br/>atCommandProcessor.ts]\n        F -->|\"!shell\"| I[Shell Command Processor<br/>shellCommandProcessor.ts]\n        F -->|Normal Query| J[Prepare Query for Gemini]\n        G --> K[Execute UI Action<br/>e.g., /clear, /help]\n        H --> L[Read Files/Context<br/>read_many_files tool]\n        L --> J\n        I --> M[Execute Shell Command]\n    end\n\n    subgraph CoreBackend[\"Core Backend (packages/core)\"]\n        J --> N[Send to Core Package]\n        N --> O{Start or Continue Chat}\n        O --> P[Send Message to Gemini API<br/>with tool definitions]\n    end\n\n    subgraph GeminiAPI[\"Gemini API Interaction\"]\n        P --> Q[Gemini API Processes Request]\n        Q --> R{Response Type?}\n        R -->|Content| S[Stream Text Response]\n        R -->|Tool Call Request| T[Request Tool Execution]\n    end\n\n    subgraph ToolExecution[\"Tool Execution Loop\"]\n        T --> U[Schedule Tool Call]\n        U --> V{Requires User Approval?}\n        V -->|Yes| W[Prompt User for Confirmation]\n        W --> X{Approved?}\n        X -->|Yes| Y[Execute Tool<br/>e.g., file system, web search]\n        X -->|No| Z[Cancel Tool Call]\n        V -->|No| Y\n        Y --> AA[Send Tool Result to Gemini API]\n        AA --> Q\n    end\n\n    subgraph FinalOutput[\"Final Output\"]\n      S --> BB[Display Formatted Output to User]\n      K --> BB\n      M --> BB\n      Z --> BB\n    end\n\n    style UserInteraction fill:#f9f,stroke:#333,stroke-width:2px\n    style CLIFrontend fill:#ccf,stroke:#333,stroke-width:2px\n    style CoreBackend fill:#cfc,stroke:#333,stroke-width:2px\n    style GeminiAPI fill:#ffc,stroke:#333,stroke-width:2px\n    style ToolExecution fill:#fcc,stroke:#333,stroke-width:2px\n    style FinalOutput fill:#cff,stroke:#333,stroke-width:2px\n",
  "diagram_type": "graph size:>1500",
  "collected_at": "2026-02-27T04:14:01.402517"
}