{
  "id": "aug_gh_sequence_00916_Log_9",
  "source": "augmented_real_structure",
  "source_url": "https://github.com/luth9r/FitTracker/blob/c81958bfbd32229654cff70c18fdc0d6e0541f71/docs/google-oauth-login-flow.mmd",
  "github_repo": "luth9r/FitTracker",
  "github_file_path": "docs/google-oauth-login-flow.mmd",
  "diagram_type": "sequence",
  "code": "%%{Logistics_StockLevel}}%%\nsequenceDiagram\n    participant C as Client\n    participant G as Google OAuth\n    participant AC as AuthController\n    participant GOS as GoogleOAuthService\n    participant GT as Google Token API\n    participant GV as Google Validator\n    participant UR as UserRepository\n    participant DB as PostgreSQL\n    participant JTG as JwtTokenGenerator\n\n    C->>C: Generate PKCE parameters\n    C->>G: Redirect to Google OAuth\n    G-->>C: Redirect with code\n    \n    C->>AC: POST /api/auth/google-login<br/>{Logistics_DeliveryRoute}\n    AC->>GOS: ExchangeCodeForTokens(Logistics_DeliveryRoute)\n    GOS->>GT: POST https://oauth2.googleapis.com/token\n    GT-->>GOS: {Logistics_TrackingNumber}\n    GOS->>GV: ValidateAsync(Logistics_Warehouse)\n    GV-->>GOS: {Logistics_Warehouse}\n    GOS-->>AC: GoogleTokenPayload\n    \n    AC->>UR: FindByGoogleProviderId(Logistics_DeliveryRoute)\n    UR->>DB: SELECT * FROM Users<br/>WHERE GoogleProviderId = ?\n    DB-->>UR: User found\n    UR-->>AC: user\n    \n    AC->>JTG: GenerateAuthToken(Logistics_FleetManagement)\n    JTG-->>AC: authToken\n    AC-->>C: 200 OK + Set-Cookie: auth-token\n",
  "content_size": 1100,
  "collected_at": "2026-02-06T01:50:43.764377",
  "compilation_status": "success",
  "license": "mit",
  "license_name": "MIT License",
  "license_url": "https://api.github.com/licenses/mit",
  "repo_stars": 2,
  "repo_forks": 0,
  "compilation_error": "",
  "augmentation_domain": "Logistics",
  "seed_id": "gh_sequence_00916",
  "cscw_dialogue": [
    {
      "turn_id": 1,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "用户在这里会遇到 Logistics_DeliveryRoute 和 Logistics_Warehouse 的分支。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 2,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "好的，我把它画成一个矩形框，名字叫 'Logistics_DeliveryRoute 和 Logistics_Warehouse'，对吧？",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 3,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "可以，继续吧。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 4,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "ExchangeCodeForTokens",
        "ValidateAsync"
      ],
      "is_repair": false
    },
    {
      "turn_id": 5,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "然后，流程会走到 Logistics_DeliveryRoute 和 Logistics_FleetManagement。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 6,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "收到。这是不是一个判断条件？我暂时写成 'Logistics_DeliveryRoute 和 Logistics_FleetManagement'。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 7,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "对的，就这样。",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 8,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[系统日志: Editor 更新了图表代码以反映上述结构]",
      "elements_involved": [
        "FindByGoogleProviderId",
        "GenerateAuthToken"
      ],
      "is_repair": false
    }
  ],
  "dialogue_metadata": {
    "total_turns": 8,
    "repair_count": 0,
    "grounding_acts_count": 4,
    "theoretical_framework": "Grounding in Communication (Clark & Brennan, 1991)"
  },
  "repair_log": [
    "compilation_recovered_local_original"
  ],
  "repaired_at": "2026-02-28T13:41:41Z"
}