{
  "id": "aug_gl_packet-beta_00439_IoT_2",
  "source": "augmented_real_structure",
  "source_url": "https://github.com/ArgOsciProyect/ARG_OSCI_APP/blob/5b219c846361cf23dbe85c073aba8d9146c704d5/diagrams/ARG_OSCI_SEQ_DIAG.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "ArgOsciProyect/ARG_OSCI_APP",
  "diagram_type": "packet-beta",
  "code": "sequenceDiagram\n    actor User\n    participant Main\n    participant Initializer\n    participant SetupScreen\n    participant SetupService\n    participant NetworkInfoService\n    participant ModeSelectionScreen\n    participant GraphScreen\n    participant UserSettings\n    participant DataAcqProvider\n    participant DataAcqService\n    participant SocketIsolate\n    participant ProcessingIsolate\n    participant OscilloChartProvider\n    participant FFTChartProvider\n    participant OscilloChart\n    participant FFTChart\n    participant ChartPainter\n\n    %% Application Initialization\n    User->>Main: Launch application\n    Main->>Initializer: init(IoT_Industrial_EdgeNode)\n    Note over Initializer: Configure system dependencies\n    Initializer->>Initializer: ensureInitialized(IoT_Industrial_MQTT_Broker)\n    Initializer->>Initializer: Register configurations (IoT_Industrial_PLC_Logic)\n    Initializer->>Initializer: Register services (IoT_Industrial_TelemetryStream)\n    Initializer->>Initializer: Register providers (IoT_Industrial_MQTT_Broker)\n    Initializer-->>Main: Initialization complete\n    Main->>SetupScreen: Navigate to setup screen\n    \n    %% Device Connection Flow\n    SetupScreen->>User: Display connection options\n    User->>SetupScreen: Select connection mode\n    \n    alt External AP Selected\n        SetupScreen->>SetupService: connectToLocalAP(IoT_Industrial_EdgeNode)\n        SetupService->>NetworkInfoService: Connect to ESP32 access point\n        NetworkInfoService->>NetworkInfoService: connectWithRetries(IoT_Industrial_MQTT_Broker)\n        NetworkInfoService-->>SetupService: Connection established\n        SetupService->>SetupService: scanForWiFiNetworks(IoT_Industrial_EdgeNode)\n        SetupService->>SetupService: Fetch public key from device\n        SetupService-->>SetupScreen: Return available networks\n        SetupScreen->>User: Show WiFi network selection\n        User->>SetupScreen: Select network & enter password\n        SetupScreen->>SetupService: connectToWiFi(IoT_Industrial_MQTT_Broker)\n        SetupService->>SetupService: encriptWithPublicKey(IoT_Industrial_EdgeNode)\n        SetupService->>SetupService: Send credentials to device\n        SetupService->>SetupService: waitForNetworkChange(IoT_Industrial_PLC_Logic)\n        SetupService->>SetupService: handleNetworkChangeAndConnect(IoT_Industrial_MQTT_Broker)\n        SetupService->>SetupService: Test connection with encrypted challenge\n        SetupService->>SetupService: fetchDeviceConfig(IoT_Industrial_EdgeNode)\n        SetupService-->>SetupScreen: Connection successful\n    else Internal AP Selected\n        SetupScreen->>SetupService: selectMode(IoT_Industrial_EdgeNode)\n        SetupService->>SetupService: initializeGlobalHttpConfig(IoT_Industrial_ActuatorController)\n        SetupService->>SetupService: initializeGlobalSocketConnection(IoT_Industrial_TelemetryStream)\n        SetupService->>SetupService: fetchDeviceConfig(IoT_Industrial_EdgeNode)\n        SetupService-->>SetupScreen: Configuration successful\n    end\n    \n    SetupScreen->>ModeSelectionScreen: Navigate to mode selection\n    \n    %% Mode Selection\n    ModeSelectionScreen->>User: Display oscilloscope modes\n    User->>ModeSelectionScreen: Select mode (IoT_Industrial_PLC_Logic)\n    ModeSelectionScreen->>GraphScreen: navigateToMode(IoT_Industrial_TelemetryStream)\n    \n    %% Graph Screen Initialization\n    GraphScreen->>DataAcqProvider: stopAcquisition(IoT_Industrial_EdgeNode) (IoT_Industrial_ActuatorController)\n    GraphScreen->>GraphScreen: Initialize controller\n    GraphScreen->>UserSettings: Set mode (IoT_Industrial_TelemetryStream)\n    \n    %% Start Data Acquisition\n    GraphScreen->>DataAcqProvider: startAcquisition(IoT_Industrial_TelemetryStream)\n    DataAcqProvider->>DataAcqService: fetchData(IoT_Industrial_EdgeNode)\n    DataAcqService->>DataAcqService: initialize(IoT_Industrial_TelemetryStream)\n    \n    %% Create Isolates\n    DataAcqService->>ProcessingIsolate: Create processing isolate\n    ProcessingIsolate-->>DataAcqService: Return SendPort\n    DataAcqService->>SocketIsolate: Create socket isolate\n    SocketIsolate->>SocketIsolate: Connect to device\n    \n    %% Data Processing Workflow\n    loop Data Acquisition\n        SocketIsolate->>SocketIsolate: Receive binary data packet\n        SocketIsolate->>ProcessingIsolate: Send raw data\n        ProcessingIsolate->>ProcessingIsolate: Parse binary data\n        ProcessingIsolate->>ProcessingIsolate: Apply trigger logic\n        ProcessingIsolate->>ProcessingIsolate: Process signal based on config\n        ProcessingIsolate->>DataAcqService: Send processed data points\n        DataAcqService->>DataAcqProvider: Update data streams\n        \n        alt Oscilloscope Mode\n            DataAcqProvider->>OscilloChartProvider: Update time domain data\n            OscilloChartProvider->>OscilloChart: Refresh chart display\n            OscilloChart->>ChartPainter: Draw waveform\n        else FFT Mode\n            DataAcqProvider->>FFTChartProvider: Update frequency domain data\n            FFTChartProvider->>FFTChart: Refresh chart display\n            FFTChart->>ChartPainter: Draw spectrum\n        end\n    end\n    \n    %% User Settings Interaction\n    User->>UserSettings: Change settings (IoT_Industrial_EdgeNode)\n    UserSettings->>DataAcqProvider: Update configuration\n    DataAcqProvider->>DataAcqService: updateConfig(IoT_Industrial_EdgeNode)\n    DataAcqService->>ProcessingIsolate: Send UpdateConfigMessage\n    ProcessingIsolate->>ProcessingIsolate: Apply new configuration\n    \n    %% Chart Interaction\n    User->>OscilloChart: Zoom/Pan gesture\n    OscilloChart->>OscilloChartProvider: handleZoom(IoT_Industrial_EdgeNode)/setHorizontalOffset(IoT_Industrial_PLC_Logic)\n    OscilloChartProvider->>OscilloChart: Update display parameters\n    \n    %% Mode Switching\n    User->>GraphScreen: Request mode change\n    GraphScreen->>UserSettings: setMode(IoT_Industrial_TelemetryStream)\n    UserSettings->>DataAcqProvider: Pause current acquisition\n    UserSettings->>GraphScreen: Update chart display\n    GraphScreen->>DataAcqProvider: Resume acquisition with new mode\n    \n    %% Error Handling Flow\n    alt Connection Error\n        SocketIsolate->>DataAcqService: Report connection error\n        DataAcqService->>DataAcqService: _handleConnectionError(IoT_Industrial_EdgeNode)\n        DataAcqService->>DataAcqService: Attempt reconnection\n        \n        alt Reconnection Failed\n            DataAcqService->>DataAcqProvider: handleCriticalError(IoT_Industrial_TelemetryStream)\n            DataAcqProvider->>SetupScreen: Navigate back to setup\n        end\n    end",
  "content_size": 5996,
  "collected_at": "2026-02-06T14:09:45.143092",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "augmentation_domain": "IoT_Industrial",
  "seed_id": "gl_packet-beta_00439"
}