{
  "id": "gl_packet-beta_00403",
  "source": "gitlab",
  "source_url": "https://github.com/patla001/network_AI_agent/blob/0537b5540ea4523798d9582c6efec8fc62a8a54a/diagrams/00-architecture-overview.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "patla001/network_AI_agent",
  "diagram_type": "packet-beta",
  "code": "graph TB\n    subgraph \"ğŸ“¡ Data Collection Layer\"\n        Network[ğŸŒ Network Traffic<br/>Interface: en0/en5]\n        PyShark[ğŸ“¡ PyShark + tshark<br/>Real-time capture<br/>100 packets/5s]\n        Features[ğŸ“Š Feature Extraction<br/>26 ML features<br/>flows, rates, protocols]\n    end\n    \n    subgraph \"ğŸ§  ML & Analysis Layer\"\n        Isolation[ğŸ” Isolation Forest<br/>Anomaly Detection<br/>Score: 0.0-1.0]\n        RandomForest[ğŸŒ² Random Forest<br/>Traffic Classification<br/>normal/attack/scan]\n        Online[ğŸ“ˆ River Online Learning<br/>Adaptive models<br/>continuous training]\n    end\n    \n    subgraph \"ğŸ¤– AI Agent Layer (LangGraph)\"\n        Monitor[ğŸ” Monitor Node<br/>Packet capture<br/>Feature extraction]\n        Analysis[ğŸ“Š Analysis Node<br/>ML prediction<br/>Anomaly detection]\n        Decision[ğŸ’¡ Decision Node<br/>Claude + RAG<br/>Smart decisions]\n        ActionNode[âš¡ Action Node<br/>Execute & store<br/>Remediation]\n    end\n    \n    subgraph \"ğŸ’¾ Storage & Memory\"\n        ChromaDB[ğŸ’¾ ChromaDB<br/>Vector database<br/>Incident storage<br/>Semantic search]\n        Postgres[ğŸ—„ï¸ PostgreSQL<br/>TimescaleDB<br/>Time-series data<br/>Port: 5433]\n        Models[ğŸ¯ ML Models<br/>anomaly_detector.pkl<br/>traffic_classifier.pkl]\n    end\n    \n    subgraph \"ğŸ¤– LLM Integration\"\n        Claude[ğŸ¤– Claude Sonnet 4<br/>Anthropic API<br/>Context-aware decisions]\n        RAG[ğŸ” RAG System<br/>Retrieval-Augmented<br/>Generation]\n    end\n    \n    subgraph \"ğŸ“Š Monitoring & Visualization\"\n        PrometheusMetrics[ğŸ“ˆ Metrics Exporter<br/>Port: 9100<br/>Real-time metrics]\n        Prometheus[ğŸ“Š Prometheus<br/>Port: 9090<br/>Time-series DB<br/>15s scrape]\n        Grafana[ğŸ“‰ Grafana<br/>Port: 3000<br/>Dashboards<br/>admin/admin]\n        HTMLDash[ğŸ¨ HTML Dashboard<br/>Port: 8080<br/>Real-time charts<br/>Auto-refresh]\n    end\n    \n    subgraph \"ğŸ³ Infrastructure\"\n        Docker[ğŸ³ Docker Compose<br/>Postgres, Prometheus<br/>Grafana containers]\n        Python[ğŸ Python 3.12<br/>Virtual env<br/>asyncio runtime]\n    end\n    \n    %% Data Flow\n    Network -->|raw packets| PyShark\n    PyShark -->|parsed| Features\n    Features -->|26 features| Monitor\n    Monitor -->|data| Analysis\n    Analysis -->|ML inference| Isolation\n    Analysis -->|classification| RandomForest\n    Isolation -->|anomaly score| Analysis\n    RandomForest -->|traffic type| Analysis\n    \n    Analysis -->|score >= 0.8| Decision\n    Analysis -->|score < 0.8| PrometheusMetrics\n    \n    Decision -->|query| RAG\n    RAG -->|retrieve| ChromaDB\n    ChromaDB -->|similar incidents| RAG\n    RAG -->|context| Claude\n    Claude -->|decision| Decision\n    \n    Decision -->|action| ActionNode\n    ActionNode -->|store| ChromaDB\n    ActionNode -->|save| Postgres\n    ActionNode -->|metrics| PrometheusMetrics\n    \n    PrometheusMetrics -->|expose| Prometheus\n    Prometheus -->|scrape| Prometheus\n    Prometheus -->|data| Grafana\n    Prometheus -->|API| HTMLDash\n    \n    Models -.->|load| Isolation\n    Models -.->|load| RandomForest\n    Online -.->|update| Models\n    \n    Docker -.->|runs| Postgres\n    Docker -.->|runs| Prometheus\n    Docker -.->|runs| Grafana\n    Python -.->|runtime| Monitor\n    \n    %% Styling\n    style Decision fill:#4ecdc4,stroke:#333,stroke-width:3px,color:#000\n    style Claude fill:#ff6b6b,stroke:#333,stroke-width:3px,color:#fff\n    style ChromaDB fill:#95e1d3,stroke:#333,stroke-width:3px,color:#000\n    style Prometheus fill:#e63946,stroke:#333,stroke-width:2px,color:#fff\n    style HTMLDash fill:#ffd93d,stroke:#333,stroke-width:2px,color:#000\n    style Monitor fill:#a8dadc,stroke:#333,stroke-width:2px,color:#000\n\n",
  "content_size": 3581,
  "collected_at": "2026-02-06T14:09:02.767157",
  "compilation_status": "success",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "",
  "cscw_dialogue": [
    {
      "turn_id": 1,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "ç„¶åï¼Œæµç¨‹ä¼šèµ°åˆ° ğŸŒ Network Traffic<br/>Interface: en0/en5 å’Œ ğŸ“¡ PyShark + tshark<br/>Real-time capture<br/>100 packets/5sã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 2,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æˆ‘æŠŠå®ƒåŠ è¿›å»äº†ï¼Œæ ‡ç­¾æ˜¾ç¤ºä¸º 'ğŸŒ Network Traffic<br/>Interface: en0/en5 å’Œ ğŸ“¡ PyShark + tshark<br/>Real-time capture<br/>100 packets/5s'ï¼Œä½ çœ‹çœ‹åˆé€‚å—ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 3,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯¹çš„ï¼Œå°±è¿™æ ·ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 4,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Network",
        "PyShark"
      ],
      "is_repair": false
    },
    {
      "turn_id": 5,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "ç”¨æˆ·åœ¨è¿™é‡Œä¼šé‡åˆ° ğŸ“Š Feature Extraction<br/>26 ML features<br/>flows, rates, protocols å’Œ ğŸ” Isolation Forest<br/>Anomaly Detection<br/>Score: 0.0-1.0 çš„åˆ†æ”¯ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 6,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "å¥½çš„ï¼Œæˆ‘æŠŠå®ƒç”»æˆä¸€ä¸ªçŸ©å½¢æ¡†ï¼Œåå­—å« 'ğŸ“Š Feature Extraction<br/>26 ML features<br/>flows, rates, protocols å’Œ ğŸ” Isolation Forest<br/>Anomaly Detection<br/>Score: 0.0-1.0'ï¼Œå¯¹å§ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 7,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "æ²¡é—®é¢˜ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 8,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Features",
        "Isolation"
      ],
      "is_repair": false
    },
    {
      "turn_id": 9,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "ç„¶åï¼Œæµç¨‹ä¼šèµ°åˆ° ğŸŒ² Random Forest<br/>Traffic Classification<br/>normal/attack/scan å’Œ ğŸ“ˆ River Online Learning<br/>Adaptive models<br/>continuous trainingã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 10,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æ˜ç™½ï¼Œæ‰€ä»¥å®ƒæ˜¯æ‰¿æ¥ä¸Šä¸€æ­¥çš„ï¼Œå†…å®¹æ˜¯ 'ğŸŒ² Random Forest<br/>Traffic Classification<br/>normal/attack/scan å’Œ ğŸ“ˆ River Online Learning<br/>Adaptive models<br/>continuous training'ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 11,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯¹çš„ï¼Œå°±è¿™æ ·ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 12,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "RandomForest",
        "Online"
      ],
      "is_repair": false
    },
    {
      "turn_id": 13,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "ç„¶åï¼Œæµç¨‹ä¼šèµ°åˆ° LangGraph å’Œ ğŸ” Monitor Node<br/>Packet capture<br/>Feature extractionã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 14,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æ˜ç™½ï¼Œæ‰€ä»¥å®ƒæ˜¯æ‰¿æ¥ä¸Šä¸€æ­¥çš„ï¼Œå†…å®¹æ˜¯ 'LangGraph å’Œ ğŸ” Monitor Node<br/>Packet capture<br/>Feature extraction'ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 15,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "æ²¡é—®é¢˜ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 16,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Layer",
        "Monitor"
      ],
      "is_repair": false
    },
    {
      "turn_id": 17,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "æ¥ä¸‹æ¥æ˜¯å…³äº ğŸ“Š Analysis Node<br/>ML prediction<br/>Anomaly detection å’Œ ğŸ’¡ Decision Node<br/>Claude + RAG<br/>Smart decisions çš„é€»è¾‘ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 18,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æ˜ç™½ï¼Œæ‰€ä»¥å®ƒæ˜¯æ‰¿æ¥ä¸Šä¸€æ­¥çš„ï¼Œå†…å®¹æ˜¯ 'ğŸ“Š Analysis Node<br/>ML prediction<br/>Anomaly detection å’Œ ğŸ’¡ Decision Node<br/>Claude + RAG<br/>Smart decisions'ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 19,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯¹çš„ï¼Œå°±è¿™æ ·ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 20,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Analysis",
        "Decision"
      ],
      "is_repair": false
    },
    {
      "turn_id": 21,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "ç”¨æˆ·åœ¨è¿™é‡Œä¼šé‡åˆ° âš¡ Action Node<br/>Execute & store<br/>Remediation å’Œ ğŸ’¾ ChromaDB<br/>Vector database<br/>Incident storage<br/>Semantic search çš„åˆ†æ”¯ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 22,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æˆ‘æŠŠå®ƒåŠ è¿›å»äº†ï¼Œæ ‡ç­¾æ˜¾ç¤ºä¸º 'âš¡ Action Node<br/>Execute & store<br/>Remediation å’Œ ğŸ’¾ ChromaDB<br/>Vector database<br/>Incident storage<br/>Semantic search'ï¼Œä½ çœ‹çœ‹åˆé€‚å—ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 23,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯ä»¥ï¼Œç»§ç»­å§ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 24,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "ActionNode",
        "ChromaDB"
      ],
      "is_repair": false
    },
    {
      "turn_id": 25,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "è¿™é‡Œå¿…é¡»åŒ…å« ğŸ—„ï¸ PostgreSQL<br/>TimescaleDB<br/>Time-series data<br/>Port: 5433 å’Œ ğŸ¯ ML Models<br/>anomaly_detector.pkl<br/>traffic_classifier.pkl è¿™ä¸€å—ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 26,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æˆ‘æŠŠå®ƒåŠ è¿›å»äº†ï¼Œæ ‡ç­¾æ˜¾ç¤ºä¸º 'ğŸ—„ï¸ PostgreSQL<br/>TimescaleDB<br/>Time-series data<br/>Port: 5433 å’Œ ğŸ¯ ML Models<br/>anomaly_detector.pkl<br/>traffic_classifier.pkl'ï¼Œä½ çœ‹çœ‹åˆé€‚å—ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 27,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯ä»¥ï¼Œç»§ç»­å§ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 28,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Postgres",
        "Models"
      ],
      "is_repair": false
    },
    {
      "turn_id": 29,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "è¿™é‡Œå¿…é¡»åŒ…å« ğŸ¤– Claude Sonnet 4<br/>Anthropic API<br/>Context-aware decisions å’Œ ğŸ” RAG System<br/>Retrieval-Augmented<br/>Generation è¿™ä¸€å—ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 30,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æ”¶åˆ°ã€‚è¿™æ˜¯ä¸æ˜¯ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ï¼Ÿæˆ‘æš‚æ—¶å†™æˆ 'ğŸ¤– Claude Sonnet 4<br/>Anthropic API<br/>Context-aware decisions å’Œ ğŸ” RAG System<br/>Retrieval-Augmented<br/>Generation'ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 31,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯¹çš„ï¼Œå°±è¿™æ ·ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 32,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Claude",
        "RAG"
      ],
      "is_repair": false
    },
    {
      "turn_id": 33,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "è¿™é‡Œå¿…é¡»åŒ…å« ğŸ“ˆ Metrics Exporter<br/>Port: 9100<br/>Real-time metrics å’Œ ğŸ“Š Prometheus<br/>Port: 9090<br/>Time-series DB<br/>15s scrape è¿™ä¸€å—ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 34,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æˆ‘æŠŠå®ƒåŠ è¿›å»äº†ï¼Œæ ‡ç­¾æ˜¾ç¤ºä¸º 'ğŸ“ˆ Metrics Exporter<br/>Port: 9100<br/>Real-time metrics å’Œ ğŸ“Š Prometheus<br/>Port: 9090<br/>Time-series DB<br/>15s scrape'ï¼Œä½ çœ‹çœ‹åˆé€‚å—ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 35,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯¹çš„ï¼Œå°±è¿™æ ·ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 36,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "PrometheusMetrics",
        "Prometheus"
      ],
      "is_repair": false
    },
    {
      "turn_id": 37,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "è¿™é‡Œå¿…é¡»åŒ…å« ğŸ“‰ Grafana<br/>Port: 3000<br/>Dashboards<br/>admin/admin å’Œ ğŸ¨ HTML Dashboard<br/>Port: 8080<br/>Real-time charts<br/>Auto-refresh è¿™ä¸€å—ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 38,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "æ˜ç™½ï¼Œæ‰€ä»¥å®ƒæ˜¯æ‰¿æ¥ä¸Šä¸€æ­¥çš„ï¼Œå†…å®¹æ˜¯ 'ğŸ“‰ Grafana<br/>Port: 3000<br/>Dashboards<br/>admin/admin å’Œ ğŸ¨ HTML Dashboard<br/>Port: 8080<br/>Real-time charts<br/>Auto-refresh'ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 39,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯¹çš„ï¼Œå°±è¿™æ ·ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 40,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Grafana",
        "HTMLDash"
      ],
      "is_repair": false
    },
    {
      "turn_id": 41,
      "role": "Domain_Expert",
      "action_type": "propose",
      "utterance": "ç„¶åï¼Œæµç¨‹ä¼šèµ°åˆ° ğŸ³ Docker Compose<br/>Postgres, Prometheus<br/>Grafana containers å’Œ ğŸ Python 3.12<br/>Virtual env<br/>asyncio runtimeã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 42,
      "role": "Diagram_Editor",
      "action_type": "clarify",
      "utterance": "å¥½çš„ï¼Œæˆ‘æŠŠå®ƒç”»æˆä¸€ä¸ªçŸ©å½¢æ¡†ï¼Œåå­—å« 'ğŸ³ Docker Compose<br/>Postgres, Prometheus<br/>Grafana containers å’Œ ğŸ Python 3.12<br/>Virtual env<br/>asyncio runtime'ï¼Œå¯¹å§ï¼Ÿ",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 43,
      "role": "Domain_Expert",
      "action_type": "confirm",
      "utterance": "å¯ä»¥ï¼Œç»§ç»­å§ã€‚",
      "elements_involved": [],
      "is_repair": false
    },
    {
      "turn_id": 44,
      "role": "Diagram_Editor",
      "action_type": "execute",
      "utterance": "[ç³»ç»Ÿæ—¥å¿—: Editor æ›´æ–°äº†å›¾è¡¨ä»£ç ä»¥åæ˜ ä¸Šè¿°ç»“æ„]",
      "elements_involved": [
        "Docker",
        "Python"
      ],
      "is_repair": false
    }
  ],
  "dialogue_metadata": {
    "total_turns": 44,
    "repair_count": 0,
    "grounding_acts_count": 22,
    "theoretical_framework": "Grounding in Communication (Clark & Brennan, 1991)"
  },
  "repair_log": [
    "compilation_recovered_local_original"
  ],
  "repaired_at": "2026-02-28T13:41:36Z"
}