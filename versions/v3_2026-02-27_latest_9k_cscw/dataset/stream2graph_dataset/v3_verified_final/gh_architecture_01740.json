{
  "id": "gh_architecture_01740",
  "source": "github",
  "source_url": "https://github.com/JuliaMirandaC/susep-ses-db/blob/3a1280571f424ef689826a93ea9ec1aca8d4b276/fluxograma.mmd",
  "github_repo": "JuliaMirandaC/susep-ses-db",
  "github_file_path": "fluxograma.mmd",
  "diagram_type": "architecture",
  "code": "flowchart TD\n    subgraph Host[\"Máquina Host\"]\n        StartSH[\"iniciar.sh\"]\n        DockerCompose[\"docker-compose.yml\"]\n        DadosCSV_Host[\"./dados_csv/\"]\n        DocsHost[\"./docs/\"]\n    end\n\n    subgraph PostgresContainer[\"Container: ses_postgres (postgres:15-alpine)\"]\n        InitDB[\"/docker-entrypoint-initdb.d/\"]\n        Script01[\"01-criar-tabelas.sql\"]\n        Script02[\"02-criar-views-dashboard.sql\"]\n        DB[(\"ses_database\")]\n    end\n\n    subgraph IngestionContainer[\"Container: ses_csv_ingestion (python:3.11-slim)\"]\n        Command[\"Cadeia de Comandos\"]\n        BaixarScript[\"scripts/baixar_dados_susep.py\"]\n        IngerirScript[\"scripts/ingerir_dados.py\"]\n        DadosCSV_Container[\"/dados_csv/\"]\n    end\n\n    subgraph DashboardContainer[\"Container: ses_dashboard (python:3.11-slim)\"]\n        ShinyApp[\"dashboard/app.py\"]\n        Forecasting[\"forecasting.py (Chronos-2)\"]\n        Backtesting[\"Backtesting (6 folds)\"]\n        PlotlyCharts[\"Plotly Charts\"]\n        Port8050[\"Porta 8050\"]\n    end\n\n    subgraph PgAdminContainer[\"Container: ses_pgadmin\"]\n        PgAdminApp[\"pgAdmin 4\"]\n    end\n\n    subgraph GitHubPages[\"GitHub Pages\"]\n        StaticHTML[\"docs/index.html\"]\n        ExportScript[\"exportar_dashboard_estatico.py\"]\n    end\n\n    subgraph Cleanup[\"Limpeza Automática\"]\n        CleanCSV[\"Limpa CSV/ZIP (~3GB)\"]\n        DockerPrune[\"docker system prune\"]\n    end\n\n    %% Fluxo Principal\n    StartSH -->|\"docker-compose up -d\"| DockerCompose\n    StartSH -->|\"--restart (pula ingestão)\"| PostgresContainer\n    DockerCompose -->|\"Inicia\"| PostgresContainer\n    DockerCompose -->|\"Inicia (depende do postgres)\"| IngestionContainer\n    DockerCompose -->|\"Inicia\"| PgAdminContainer\n    DockerCompose -->|\"--profile dashboard\"| DashboardContainer\n\n    %% Inicialização Postgres\n    PostgresContainer --\"Monta ./scripts-inicializacao\"--> InitDB\n    InitDB -->|\"Executa na inicialização\"| Script01\n    Script01 -->|\"Cria Tabelas\"| DB\n    InitDB -->|\"Executa após tabelas\"| Script02\n    Script02 -->|\"Cria Views BI\"| DB\n\n    %% Processo de Ingestão\n    IngestionContainer --\"Monta ./scripts & ./dados_csv\"--> Command\n    Command -->|\"1. python\"| BaixarScript\n    BaixarScript -->|\"Baixa & Extrai\"| DadosCSV_Container\n    Command -->|\"2. python\"| IngerirScript\n    IngerirScript -->|\"Lê\"| DadosCSV_Container\n    IngerirScript -->|\"COPY bulk insert\"| DB\n\n    %% Limpeza após ingestão\n    IngerirScript -->|\"Após sucesso\"| Cleanup\n    CleanCSV --> DockerPrune\n\n    %% Dashboard Interativo\n    DashboardContainer -->|\"Consulta Views\"| DB\n    ShinyApp --> Forecasting\n    Forecasting -->|\"amazon/chronos-2\"| PlotlyCharts\n    Forecasting -->|\"Walk-forward\"| Backtesting\n    Backtesting -->|\"MAPE/RMSE/MAE\"| PlotlyCharts\n    PlotlyCharts --> Port8050\n\n    %% Dashboard Estático\n    ExportScript -->|\"Gera HTML\"| StaticHTML\n    StaticHTML -.->|\"Publicado em\"| GitHubPages\n    DocsHost -.->|\"GitHub Actions\"| GitHubPages\n\n    %% Mapeamento de Volume\n    DadosCSV_Host -.->|\"Montagem de Volume\"| DadosCSV_Container\n\n    %% Estilo\n    classDef script fill:#e1f5fe,stroke:#01579b,stroke-width:2px;\n    classDef db fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;\n    classDef container fill:#fff3e0,stroke:#ef6c00,stroke-width:2px,stroke-dasharray: 5 5;\n    classDef host fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px;\n    classDef dashboard fill:#e3f2fd,stroke:#1565c0,stroke-width:2px;\n    classDef github fill:#fce4ec,stroke:#c2185b,stroke-width:2px;\n    classDef cleanup fill:#fff8e1,stroke:#ff8f00,stroke-width:2px;\n\n    class StartSH,BaixarScript,IngerirScript,Script01,Script02,ExportScript script;\n    class DB db;\n    class PostgresContainer,IngestionContainer,PgAdminContainer container;\n    class DashboardContainer,ShinyApp,Forecasting,PlotlyCharts,Port8050 dashboard;\n    class Host host;\n    class GitHubPages,StaticHTML github;\n    class Cleanup,CleanCSV,DockerPrune cleanup;\n",
  "content_size": 3892,
  "collected_at": "2026-02-06T02:02:44.650360",
  "compilation_status": "success",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "mit",
  "license_name": "MIT License",
  "license_url": "https://api.github.com/licenses/mit",
  "repo_stars": 1,
  "repo_forks": 0
}