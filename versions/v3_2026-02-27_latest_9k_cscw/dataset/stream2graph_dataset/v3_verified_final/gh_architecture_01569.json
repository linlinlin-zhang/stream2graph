{
  "id": "gh_architecture_01569",
  "source": "github",
  "source_url": "https://github.com/amiduai/Architecture_Knowledge_Base/blob/3018cd5b202eaf6cfd0c04d6d954d49f62f0a9f4/practice/templates/deployment-diagram.mmd",
  "github_repo": "amiduai/Architecture_Knowledge_Base",
  "github_file_path": "practice/templates/deployment-diagram.mmd",
  "diagram_type": "architecture",
  "code": "%% 部署图模板\n%% 用于展示系统在生产环境中的部署架构\n\ngraph TB\n    %% 网络层\n    subgraph \"Internet\"\n        INTERNET[互联网用户]\n    end\n    \n    subgraph \"CDN网络\"\n        CDN1[CDN节点1<br/>北京]\n        CDN2[CDN节点2<br/>上海]\n        CDN3[CDN节点3<br/>广州]\n    end\n    \n    %% DMZ区域\n    subgraph \"DMZ区域\"\n        LB1[负载均衡器1<br/>Nginx + Keepalived<br/>192.168.1.10]\n        LB2[负载均衡器2<br/>Nginx + Keepalived<br/>192.168.1.11]\n        WAF[Web应用防火墙<br/>ModSecurity<br/>192.168.1.5]\n    end\n    \n    %% Web层\n    subgraph \"Web服务器集群\"\n        WEB1[Web服务器1<br/>Nginx + Node.js<br/>192.168.2.10<br/>CPU: 4核, RAM: 8GB]\n        WEB2[Web服务器2<br/>Nginx + Node.js<br/>192.168.2.11<br/>CPU: 4核, RAM: 8GB]\n        WEB3[Web服务器3<br/>Nginx + Node.js<br/>192.168.2.12<br/>CPU: 4核, RAM: 8GB]\n    end\n    \n    %% 应用层\n    subgraph \"应用服务器集群\"\n        APP1[应用服务器1<br/>Docker + K8s<br/>192.168.3.10<br/>CPU: 8核, RAM: 16GB]\n        APP2[应用服务器2<br/>Docker + K8s<br/>192.168.3.11<br/>CPU: 8核, RAM: 16GB]\n        APP3[应用服务器3<br/>Docker + K8s<br/>192.168.3.12<br/>CPU: 8核, RAM: 16GB]\n    end\n    \n    %% 微服务容器\n    subgraph \"Kubernetes集群\"\n        subgraph \"用户服务Pod\"\n            USER_POD1[用户服务实例1<br/>user-service:v1.2.3]\n            USER_POD2[用户服务实例2<br/>user-service:v1.2.3]\n        end\n        \n        subgraph \"订单服务Pod\"\n            ORDER_POD1[订单服务实例1<br/>order-service:v2.1.0]\n            ORDER_POD2[订单服务实例2<br/>order-service:v2.1.0]\n        end\n        \n        subgraph \"商品服务Pod\"\n            PRODUCT_POD1[商品服务实例1<br/>product-service:v1.5.2]\n            PRODUCT_POD2[商品服务实例2<br/>product-service:v1.5.2]\n        end\n    end\n    \n    %% 数据层\n    subgraph \"数据库集群\"\n        subgraph \"主数据库\"\n            DB_MASTER[PostgreSQL主库<br/>192.168.4.10<br/>CPU: 16核, RAM: 64GB<br/>SSD: 2TB]\n        end\n        \n        subgraph \"从数据库\"\n            DB_SLAVE1[PostgreSQL从库1<br/>192.168.4.11<br/>CPU: 16核, RAM: 64GB<br/>SSD: 2TB]\n            DB_SLAVE2[PostgreSQL从库2<br/>192.168.4.12<br/>CPU: 16核, RAM: 64GB<br/>SSD: 2TB]\n        end\n        \n        subgraph \"缓存集群\"\n            REDIS1[Redis主节点<br/>192.168.4.20<br/>RAM: 32GB]\n            REDIS2[Redis从节点<br/>192.168.4.21<br/>RAM: 32GB]\n            REDIS3[Redis哨兵<br/>192.168.4.22<br/>RAM: 8GB]\n        end\n    end\n    \n    %% 存储层\n    subgraph \"存储系统\"\n        STORAGE1[分布式存储1<br/>MinIO<br/>192.168.5.10<br/>SSD: 10TB]\n        STORAGE2[分布式存储2<br/>MinIO<br/>192.168.5.11<br/>SSD: 10TB]\n        STORAGE3[分布式存储3<br/>MinIO<br/>192.168.5.12<br/>SSD: 10TB]\n    end\n    \n    %% 中间件层\n    subgraph \"消息中间件\"\n        MQ1[RabbitMQ节点1<br/>192.168.6.10<br/>RAM: 16GB]\n        MQ2[RabbitMQ节点2<br/>192.168.6.11<br/>RAM: 16GB]\n        MQ3[RabbitMQ节点3<br/>192.168.6.12<br/>RAM: 16GB]\n    end\n    \n    subgraph \"搜索引擎集群\"\n        ES1[Elasticsearch节点1<br/>192.168.6.20<br/>CPU: 8核, RAM: 32GB]\n        ES2[Elasticsearch节点2<br/>192.168.6.21<br/>CPU: 8核, RAM: 32GB]\n        ES3[Elasticsearch节点3<br/>192.168.6.22<br/>CPU: 8核, RAM: 32GB]\n    end\n    \n    %% 监控系统\n    subgraph \"监控运维\"\n        PROMETHEUS[Prometheus<br/>192.168.7.10<br/>监控数据收集]\n        GRAFANA[Grafana<br/>192.168.7.11<br/>监控数据展示]\n        ELK_E[Elasticsearch<br/>192.168.7.20<br/>日志存储]\n        ELK_L[Logstash<br/>192.168.7.21<br/>日志处理]\n        ELK_K[Kibana<br/>192.168.7.22<br/>日志展示]\n        ALERT[AlertManager<br/>192.168.7.30<br/>告警管理]\n    end\n    \n    %% 外部系统\n    subgraph \"外部服务\"\n        PAYMENT_EXT[支付网关<br/>第三方支付]\n        SMS_EXT[短信服务<br/>阿里云SMS]\n        EMAIL_EXT[邮件服务<br/>SendGrid]\n        OSS_EXT[对象存储<br/>阿里云OSS]\n    end\n    \n    %% 网络连接\n    INTERNET --> CDN1\n    INTERNET --> CDN2\n    INTERNET --> CDN3\n    \n    CDN1 --> WAF\n    CDN2 --> WAF\n    CDN3 --> WAF\n    \n    WAF --> LB1\n    WAF --> LB2\n    \n    LB1 --> WEB1\n    LB1 --> WEB2\n    LB2 --> WEB2\n    LB2 --> WEB3\n    \n    WEB1 --> APP1\n    WEB2 --> APP2\n    WEB3 --> APP3\n    \n    APP1 --> USER_POD1\n    APP1 --> ORDER_POD1\n    APP2 --> USER_POD2\n    APP2 --> PRODUCT_POD1\n    APP3 --> ORDER_POD2\n    APP3 --> PRODUCT_POD2\n    \n    %% 数据库连接\n    USER_POD1 --> DB_MASTER\n    USER_POD2 --> DB_SLAVE1\n    ORDER_POD1 --> DB_MASTER\n    ORDER_POD2 --> DB_SLAVE2\n    PRODUCT_POD1 --> DB_SLAVE1\n    PRODUCT_POD2 --> DB_SLAVE2\n    \n    %% 主从复制\n    DB_MASTER -.-> DB_SLAVE1\n    DB_MASTER -.-> DB_SLAVE2\n    \n    %% 缓存连接\n    USER_POD1 --> REDIS1\n    USER_POD2 --> REDIS1\n    ORDER_POD1 --> REDIS1\n    ORDER_POD2 --> REDIS1\n    REDIS1 -.-> REDIS2\n    REDIS3 -.-> REDIS1\n    REDIS3 -.-> REDIS2\n    \n    %% 消息队列连接\n    ORDER_POD1 --> MQ1\n    ORDER_POD2 --> MQ2\n    USER_POD1 --> MQ1\n    USER_POD2 --> MQ3\n    \n    %% 搜索引擎连接\n    PRODUCT_POD1 --> ES1\n    PRODUCT_POD2 --> ES2\n    \n    %% 文件存储连接\n    USER_POD1 --> STORAGE1\n    PRODUCT_POD1 --> STORAGE2\n    \n    %% 外部服务连接\n    ORDER_POD1 --> PAYMENT_EXT\n    ORDER_POD2 --> PAYMENT_EXT\n    USER_POD1 --> SMS_EXT\n    USER_POD2 --> EMAIL_EXT\n    PRODUCT_POD1 --> OSS_EXT\n    \n    %% 监控连接\n    APP1 -.-> PROMETHEUS\n    APP2 -.-> PROMETHEUS\n    APP3 -.-> PROMETHEUS\n    DB_MASTER -.-> PROMETHEUS\n    REDIS1 -.-> PROMETHEUS\n    \n    PROMETHEUS --> GRAFANA\n    PROMETHEUS --> ALERT\n    \n    APP1 -.-> ELK_L\n    APP2 -.-> ELK_L\n    APP3 -.-> ELK_L\n    ELK_L --> ELK_E\n    ELK_E --> ELK_K\n    \n    %% 样式定义\n    classDef networkLayer fill:#e3f2fd\n    classDef webLayer fill:#e8f5e8  \n    classDef appLayer fill:#fff3e0\n    classDef dataLayer fill:#fce4ec\n    classDef storageLayer fill:#f3e5f5\n    classDef middlewareLayer fill:#e0f2f1\n    classDef monitorLayer fill:#fff8e1\n    classDef externalLayer fill:#efebe9\n    \n    class CDN1,CDN2,CDN3,LB1,LB2,WAF networkLayer\n    class WEB1,WEB2,WEB3 webLayer\n    class APP1,APP2,APP3,USER_POD1,USER_POD2,ORDER_POD1,ORDER_POD2,PRODUCT_POD1,PRODUCT_POD2 appLayer\n    class DB_MASTER,DB_SLAVE1,DB_SLAVE2,REDIS1,REDIS2,REDIS3 dataLayer\n    class STORAGE1,STORAGE2,STORAGE3 storageLayer\n    class MQ1,MQ2,MQ3,ES1,ES2,ES3 middlewareLayer\n    class PROMETHEUS,GRAFANA,ELK_E,ELK_L,ELK_K,ALERT monitorLayer\n    class PAYMENT_EXT,SMS_EXT,EMAIL_EXT,OSS_EXT externalLayer\n",
  "content_size": 5883,
  "collected_at": "2026-02-06T01:48:00.856515",
  "license": "none",
  "license_name": "No License",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license_url": "",
  "repo_stars": 2,
  "repo_forks": 0
}