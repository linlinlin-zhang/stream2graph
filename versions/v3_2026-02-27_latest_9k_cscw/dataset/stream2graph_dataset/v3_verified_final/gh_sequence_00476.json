{
  "id": "gh_sequence_00476",
  "source": "github",
  "source_url": "https://github.com/DamienReichhart/ChatApp/blob/c4cc2ad171949d92ad0d8e0f12a4ddf246c319f3/documentation/uml/sequence/sequence-connection-flow.mmd",
  "github_repo": "DamienReichhart/ChatApp",
  "github_file_path": "documentation/uml/sequence/sequence-connection-flow.mmd",
  "diagram_type": "sequence",
  "code": "sequenceDiagram\n    %% Participants\n    participant ClientUI as Client UI\n    participant AuthController as Auth Controller\n    participant SessionSvc as SessionService\n    participant WebSocketSvc as WebSocketService\n    participant WebSocketHandler as WebSocketHandler\n    participant ConnManager as WebSocketConnectionManager\n    participant StompClient as STOMP Client\n    participant ClientDB as Client Database\n    participant UserDAO as User DAO\n    participant ServerEndpoint as Server WebSocket Endpoint\n    participant ServerController as Server Controller\n\n    %% Connection Flow\n    ClientUI->>AuthController: login(username, password)\n    AuthController->>UserDAO: getUserByCredentials(username, password)\n    UserDAO->>ClientDB: SELECT * FROM users\n    ClientDB-->>UserDAO: userData\n    UserDAO-->>AuthController: authenticatedUser\n    \n    alt Authentication Success\n        AuthController->>SessionSvc: setCurrentUser(authenticatedUser)\n        SessionSvc->>AuthController: sessionStarted\n        AuthController->>WebSocketSvc: connect(authenticatedUser)\n        WebSocketSvc->>WebSocketSvc: this.currentUser = user\n        WebSocketSvc->>WebSocketHandler: connect(user)\n        WebSocketHandler->>ConnManager: connect(user)\n        ConnManager->>ConnManager: this.currentUser = user\n        ConnManager->>ConnManager: createWebSocketClient()\n        ConnManager->>StompClient: connect()\n        StompClient->>ServerEndpoint: WebSocket connection request\n        \n        %% Async Connection Handling\n        ServerEndpoint-->>StompClient: connection established\n        StompClient-->>ConnManager: stompSession created\n        ConnManager->>WebSocketHandler: handleSuccessfulConnection(session)\n        WebSocketHandler->>WebSocketSvc: onConnectionStatusChanged(true)\n        WebSocketSvc->>WebSocketSvc: processPendingJoins()\n        \n        Note over WebSocketSvc: Process any chats<br/>waiting to be joined\n        \n        WebSocketSvc->>AuthController: notify connection listeners\n        AuthController->>ClientUI: update UI (connected)\n        \n        %% Load user data from local database\n        AuthController->>SessionSvc: loadUserData()\n        SessionSvc->>UserDAO: getUserChats(userId)\n        UserDAO->>ClientDB: SELECT * FROM chat_participants WHERE user_id = ?\n        ClientDB-->>UserDAO: chatParticipantData\n        UserDAO-->>SessionSvc: userChats\n        SessionSvc-->>AuthController: userData loaded\n        AuthController->>ClientUI: navigate to main view\n    else Authentication Failure\n        AuthController->>ClientUI: show error message\n    end\n    \n    %% Error Handling Path (Alternative Flow)\n    ServerEndpoint--xStompClient: connection error\n    StompClient--xConnManager: connection error\n    ConnManager->>WebSocketHandler: handleTransportError(session, exception)\n    WebSocketHandler->>WebSocketSvc: onError(errorMessage)\n    WebSocketSvc->>AuthController: notify error listeners\n    AuthController->>ClientUI: show connection error\n",
  "content_size": 2989,
  "collected_at": "2026-02-06T01:32:50.845607",
  "compilation_status": "failed",
  "license": "mit",
  "license_name": "MIT License",
  "license_url": "https://api.github.com/licenses/mit",
  "repo_stars": 1,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}