{
  "id": "aug_gl_packet-beta_00353_Hea_1",
  "source": "augmented_real_structure",
  "source_url": "https://github.com/SiliconLabs/wiseconnect/blob/dbddc46f86fab9728a390680290781b7d1ae8bb5/components/sli_queue_manager/queue_manager.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "SiliconLabs/wiseconnect",
  "diagram_type": "packet-beta",
  "code": "%%{HealthTech_LabAnalyzer} }%%\r\nsequenceDiagram\r\n    participant A as AppThread\r\n    participant E as EventThread\r\n    participant B as CommandEngine\r\n    participant R as RoutingUtility\r\n\r\n    Note over A: User calls API to send a command<br>A command packet is prepared with<br>all the command parameters\r\n    A->>A: Enter Critical Section\r\n    Note over A: Allocate unique packet id for the command<br>packet before it is being added to the queue\r\n    A->>A: Exit Critical Section\r\n    Note over A: Prepared command packet to be added<br>into respected command queue using<br>sli_queue_manager_enqueue(HealthTech_EMR_Sync)\r\n    Note left of A: Invoke the add to queue with atomic action API with<br>sli_queue_handle_t *handle<br>sl_slist_node_t *node<br>sli_queue_manager_action_handler_t action_handler\r\n\r\n    rect rgba(HealthTech_PatientRecords)\r\n        opt sli_queue_manager_enqueue(HealthTech_LabAnalyzer)\r\n            A->>A: Enter Critical Section\r\n\r\n            Note over A: This API facilitates user to perform an action<br>under the protection of queue's critical section\r\n            alt if handler is not NULL\r\n                A->>A: Invoke the handler with user specific data\r\n            end\r\n\r\n            A->>A: Add the command packet data to the queue\r\n            A->>A: Exit Critical Section\r\n        end\r\n    end\r\n\r\n    Note over A: Once the packet is queued in the respective command queue,<br>packet is dequeued in Command Engine and processed\r\n    A->>B: Trigger TX event to Command Engine\r\n\r\n    rect rgba(HealthTech_EMR_Sync)\r\n        B->>B: Check the status of the queues<br>using SLI_QUEUE_GET_STATUS(HealthTech_LabAnalyzer)\r\n\r\n        opt SLI_QUEUE_GET_STATUS(HealthTech_DiagnosticEngine)\r\n            B->>B: Return true if list is empty\r\n        end\r\n\r\n        Note over B: If the corresponding queue is not Empty, <br>then Command Engine will process the<br>comamnds in the commanmd queues\r\n    end\r\n\r\n    rect rgba(HealthTech_EMR_Sync)\r\n        Note over R: When the underlying HAL layer receives <br>a packet, it will forward it to command <br>engine through routing utility\r\n        R->>R: Add the packet to BUS RX queue\r\n\r\n        opt sli_queue_manager_enqueue(HealthTech_EMR_Sync)\r\n            R->>R: Enter Critical Section\r\n            R->>R: Add the command response <br>packet data to the queue\r\n            R->>R: Exit critical section\r\n        end\r\n\r\n        R->>B: Set BUS RX event for Command Engine\r\n    end\r\n\r\n    rect rgba(HealthTech_LabAnalyzer)\r\n        Note over B: When a command response or a asynchronous data<br>packet is received, Command Engine will add the packet<br>to either response queue or the notification queue\r\n\r\n        B->>B: Dequeue the RX Packet\r\n        opt sli_queue_manager_dequeue(HealthTech_DiagnosticEngine)\r\n            B->>B: Enter Critical Section\r\n            B->>B: Remove the BUS RX packet data from the queue head\r\n            B->>B: Exit Critical Section\r\n            B->>B: Return the data to Command Engine\r\n        end\r\n\r\n        opt sli_queue_manager_enqueue(HealthTech_DiagnosticEngine)\r\n            B->>B: Enter Critical Section\r\n            B->>B: Add the command response packet data to<br>the response or Async notification queue\r\n            B->>B: Exit critical section\r\n        end\r\n    end\r\n\r\n    B->>A: If the response is a synchronous command response<br>Trigger corresponding RX Event\r\n    rect rgba(HealthTech_LabAnalyzer)\r\n        A->>A: The thread waiting on the corresponding response wakes up\r\n        Note over A: After waking up from desired event, thread checks if<br>and dequeues the response for expected packet id<br>using sli_queue_manager_remove_node_from_queue(HealthTech_LabAnalyzer)\r\n\r\n        opt sli_queue_manager_remove_node_from_queue(HealthTech_LabAnalyzer)\r\n            A->>A: Enter Critical Section\r\n\r\n            alt if queue is empty\r\n                A->>A: Exit Critical Section\r\n                A->>A: Return SL_STATUS_EMPTY\r\n            end\r\n\r\n            loop Iterate through the nodes in the list\r\n                A->>A: Invoke the compare function to identify the node\r\n                Note over A: In this situation, packet_id identification<br>function is invoked\r\n            end\r\n\r\n            alt if comapre function returns true\r\n                A->>A: Remove node from list \r\n                A->>A: Exit Critical Section\r\n                A->>A: Return the response packet\r\n            else\r\n                A->>A: Exit Critical Section\r\n                A->>A: Return SL_STATUS_NOT_FOUND\r\n            end\r\n        end\r\n    end\r\n\r\n    rect rgba(HealthTech_LabAnalyzer)\r\n        alt if the received data packet is a Async data packet\r\n            B->>B: Add received data packet to corresponding<br>notification event queue\r\n            B->>E: Trigger Notification event to event handler thread\r\n\r\n            Note over E: Event thread will be waiting for<br>notification events to be triggered\r\n            Note over E: Once the Event is triggered, the<br> notification events are dequeued<br>from respective notification event queues<br>using sli_queue_manager_dequeue(HealthTech_LabAnalyzer)\r\n\r\n            opt sli_queue_manager_dequeue(HealthTech_DiagnosticEngine)\r\n                E->>E: Enter Critical Section\r\n                E->>E: Remove the Notification event packet data from the queue head\r\n                E->>E: Exit Critical Section\r\n                E->>E: Return the data to the application\r\n            end\r\n\r\n            Note over E: Invoke appropriate event handler with the event data\r\n        end\r\n    end",
  "content_size": 5561,
  "collected_at": "2026-02-06T14:08:07.626730",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "repo_stars": 23,
  "repo_forks": 26,
  "repo_owner": "SiliconLabs",
  "repo_name": "wiseconnect",
  "repo_description": "Next-generation Silicon Labs Wi-Fi API for SiWx91x chipset family.",
  "repo_language": "C",
  "repo_topics": [
    "siwx917-dk2605a",
    "siwx917-wireless-soc",
    "wi-fi",
    "wifi"
  ],
  "repo_created_at": "2023-06-06T16:26:11Z",
  "repo_updated_at": "2026-01-22T17:46:41Z",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "augmentation_domain": "HealthTech",
  "seed_id": "gl_packet-beta_00353",
  "dialogue": [
    {
      "turn_id": 1,
      "speaker": "Speaker_B",
      "utterance": "让我们从头开始，先确定入口点。",
      "speech_act": "sequential",
      "diagram_elements_added": [],
      "timestamp_offset": 15
    },
    {
      "turn_id": 2,
      "speaker": "Speaker_A",
      "utterance": "我同意这个观点。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 30
    },
    {
      "turn_id": 3,
      "speaker": "Speaker_B",
      "utterance": "你能详细说明一下AppThread吗？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 45
    },
    {
      "turn_id": 4,
      "speaker": "Speaker_A",
      "utterance": "在AppThread中，我们需要定义核心逻辑。",
      "speech_act": "structural",
      "diagram_elements_added": [
        "A"
      ],
      "timestamp_offset": 60
    },
    {
      "turn_id": 5,
      "speaker": "Speaker_B",
      "utterance": "关于EventThread、CommandEngine，你有什么想法？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 75
    },
    {
      "turn_id": 6,
      "speaker": "Speaker_A",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 90
    },
    {
      "turn_id": 7,
      "speaker": "Speaker_B",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "E",
        "B",
        "R"
      ],
      "timestamp_offset": 105
    },
    {
      "turn_id": 8,
      "speaker": "Speaker_A",
      "utterance": "Enter Critical Section、Exit Critical Section主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 120
    },
    {
      "turn_id": 9,
      "speaker": "Speaker_B",
      "utterance": "我同意这个观点。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 135
    },
    {
      "turn_id": 10,
      "speaker": "Speaker_A",
      "utterance": "从结构上看，我们有Enter Critical Section、Exit Critical Section。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 150
    },
    {
      "turn_id": 11,
      "speaker": "Speaker_B",
      "utterance": "你能详细说明一下Enter Critical Section、Exit Critical Section吗？",
      "speech_act": "request",
      "diagram_elements_added": [
        "msg_0",
        "msg_1",
        "msg_2"
      ],
      "timestamp_offset": 165
    },
    {
      "turn_id": 12,
      "speaker": "Speaker_A",
      "utterance": "我们可以将Invoke the handler with user specific data、Add the command packet data to the queue分为几个类型。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 180
    },
    {
      "turn_id": 13,
      "speaker": "Speaker_B",
      "utterance": "我同意这个观点。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 195
    },
    {
      "turn_id": 14,
      "speaker": "Speaker_A",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "msg_3",
        "msg_4",
        "msg_5"
      ],
      "timestamp_offset": 210
    },
    {
      "turn_id": 15,
      "speaker": "Speaker_B",
      "utterance": "这个系统主要由Trigger TX event to Command Engine、Check the status of the queues<br>using SLI_QUEUE_GET_STATUS(HealthTech_LabAnalyzer)组成。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 225
    },
    {
      "turn_id": 16,
      "speaker": "Speaker_A",
      "utterance": "好的，那就按这个方案。",
      "speech_act": "confirm",
      "diagram_elements_added": [
        "msg_6",
        "msg_7"
      ],
      "timestamp_offset": 240
    },
    {
      "turn_id": 17,
      "speaker": "Speaker_B",
      "utterance": "我们应该如何处理Return true if list is empty、Add the packet to BUS RX queue？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 255
    },
    {
      "turn_id": 18,
      "speaker": "Speaker_A",
      "utterance": "明白了，Return true if list is empty、Add the packet to BUS RX queue就这样设计。",
      "speech_act": "confirm",
      "diagram_elements_added": [],
      "timestamp_offset": 270
    },
    {
      "turn_id": 19,
      "speaker": "Speaker_B",
      "utterance": "让我澄清一下，Return true if list is empty、Add the packet to BUS RX queue的作用是...",
      "speech_act": "clarify",
      "diagram_elements_added": [
        "msg_8",
        "msg_9"
      ],
      "timestamp_offset": 285
    },
    {
      "turn_id": 20,
      "speaker": "Speaker_A",
      "utterance": "Enter Critical Section、Add the command response <br>packet data to the queue主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 300
    },
    {
      "turn_id": 21,
      "speaker": "Speaker_B",
      "utterance": "我们需要确保这个逻辑是正确的。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 315
    },
    {
      "turn_id": 22,
      "speaker": "Speaker_A",
      "utterance": "Enter Critical Section、Add the command response <br>packet data to the queue主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 330
    },
    {
      "turn_id": 23,
      "speaker": "Speaker_B",
      "utterance": "在Enter Critical Section、Add the command response <br>packet data to the queue中，我们需要定义核心逻辑。",
      "speech_act": "structural",
      "diagram_elements_added": [
        "msg_10",
        "msg_11"
      ],
      "timestamp_offset": 345
    },
    {
      "turn_id": 24,
      "speaker": "Speaker_A",
      "utterance": "我们可以将Exit critical section、Set BUS RX event for Command Engine分为几个类型。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 360
    },
    {
      "turn_id": 25,
      "speaker": "Speaker_B",
      "utterance": "明白了，Exit critical section、Set BUS RX event for Command Engine就这样设计。",
      "speech_act": "confirm",
      "diagram_elements_added": [],
      "timestamp_offset": 375
    },
    {
      "turn_id": 26,
      "speaker": "Speaker_A",
      "utterance": "最后，流程到达Exit critical section、Set BUS RX event for Command Engine结束。",
      "speech_act": "sequential",
      "diagram_elements_added": [],
      "timestamp_offset": 390
    },
    {
      "turn_id": 27,
      "speaker": "Speaker_B",
      "utterance": "我们需要确保这个逻辑是正确的。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "msg_12",
        "msg_13",
        "msg_14"
      ],
      "timestamp_offset": 405
    },
    {
      "turn_id": 28,
      "speaker": "Speaker_A",
      "utterance": "我们可以将Enter Critical Section、Remove the BUS RX packet data from the queue head分为几个类型。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 420
    },
    {
      "turn_id": 29,
      "speaker": "Speaker_B",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 435
    },
    {
      "turn_id": 30,
      "speaker": "Speaker_A",
      "utterance": "最后，流程到达Enter Critical Section、Remove the BUS RX packet data from the queue head结束。",
      "speech_act": "sequential",
      "diagram_elements_added": [],
      "timestamp_offset": 450
    },
    {
      "turn_id": 31,
      "speaker": "Speaker_B",
      "utterance": "关于Enter Critical Section、Remove the BUS RX packet data from the queue head，你有什么想法？",
      "speech_act": "request",
      "diagram_elements_added": [
        "msg_15",
        "msg_16"
      ],
      "timestamp_offset": 465
    },
    {
      "turn_id": 32,
      "speaker": "Speaker_A",
      "utterance": "Exit Critical Section、Return the data to Command Engine主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 480
    },
    {
      "turn_id": 33,
      "speaker": "Speaker_B",
      "utterance": "好的，那就按这个方案。",
      "speech_act": "confirm",
      "diagram_elements_added": [
        "msg_17",
        "msg_18"
      ],
      "timestamp_offset": 495
    },
    {
      "turn_id": 34,
      "speaker": "Speaker_A",
      "utterance": "关于Enter Critical Section、Add the command response packet data to<br>the response or Async notification queue，你有什么想法？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 510
    },
    {
      "turn_id": 35,
      "speaker": "Speaker_B",
      "utterance": "我们需要确保这个逻辑是正确的。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 525
    },
    {
      "turn_id": 36,
      "speaker": "Speaker_A",
      "utterance": "关于Enter Critical Section、Add the command response packet data to<br>the response or Async notification queue，你有什么想法？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 540
    },
    {
      "turn_id": 37,
      "speaker": "Speaker_B",
      "utterance": "你能详细说明一下Enter Critical Section、Add the command response packet data to<br>the response or Async notification queue吗？",
      "speech_act": "request",
      "diagram_elements_added": [
        "msg_19",
        "msg_20"
      ],
      "timestamp_offset": 555
    },
    {
      "turn_id": 38,
      "speaker": "Speaker_A",
      "utterance": "Exit critical section、If the response is a synchronous command response<br>Trigger corresponding RX Event主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 570
    },
    {
      "turn_id": 39,
      "speaker": "Speaker_B",
      "utterance": "我的意思是Exit critical section、If the response is a synchronous command response<br>Trigger corresponding RX Event应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [
        "msg_21",
        "msg_22"
      ],
      "timestamp_offset": 585
    },
    {
      "turn_id": 40,
      "speaker": "Speaker_A",
      "utterance": "从结构上看，我们有The thread waiting on the corresponding response wakes up、Enter Critical Section。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 600
    },
    {
      "turn_id": 41,
      "speaker": "Speaker_B",
      "utterance": "我同意这个观点。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 615
    },
    {
      "turn_id": 42,
      "speaker": "Speaker_A",
      "utterance": "最终，我们在The thread waiting on the corresponding response wakes up、Enter Critical Section完成整个流程。",
      "speech_act": "sequential",
      "diagram_elements_added": [
        "msg_23",
        "msg_24"
      ],
      "timestamp_offset": 630
    },
    {
      "turn_id": 43,
      "speaker": "Speaker_B",
      "utterance": "关于Exit Critical Section，你有什么想法？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 645
    },
    {
      "turn_id": 44,
      "speaker": "Speaker_A",
      "utterance": "我的意思是Exit Critical Section应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [],
      "timestamp_offset": 660
    },
    {
      "turn_id": 45,
      "speaker": "Speaker_B",
      "utterance": "Exit Critical Section和另一个方案相比，优势在于...",
      "speech_act": "contrastive",
      "diagram_elements_added": [],
      "timestamp_offset": 675
    },
    {
      "turn_id": 46,
      "speaker": "Speaker_A",
      "utterance": "我同意这个观点。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "msg_25"
      ],
      "timestamp_offset": 690
    },
    {
      "turn_id": 47,
      "speaker": "Speaker_B",
      "utterance": "从结构上看，我们有Return SL_STATUS_EMPTY、Invoke the compare function to identify the node。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 705
    },
    {
      "turn_id": 48,
      "speaker": "Speaker_A",
      "utterance": "明白了，Return SL_STATUS_EMPTY、Invoke the compare function to identify the node就这样设计。",
      "speech_act": "confirm",
      "diagram_elements_added": [
        "msg_26",
        "msg_27",
        "msg_28"
      ],
      "timestamp_offset": 720
    },
    {
      "turn_id": 49,
      "speaker": "Speaker_B",
      "utterance": "你能详细说明一下Exit Critical Section吗？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 735
    },
    {
      "turn_id": 50,
      "speaker": "Speaker_A",
      "utterance": "我的意思是Exit Critical Section应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [],
      "timestamp_offset": 750
    },
    {
      "turn_id": 51,
      "speaker": "Speaker_B",
      "utterance": "好的，那就按这个方案。",
      "speech_act": "confirm",
      "diagram_elements_added": [
        "msg_29"
      ],
      "timestamp_offset": 765
    },
    {
      "turn_id": 52,
      "speaker": "Speaker_A",
      "utterance": "这个系统主要由Return the response packet、Exit Critical Section组成。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 780
    },
    {
      "turn_id": 53,
      "speaker": "Speaker_B",
      "utterance": "我的意思是Return the response packet、Exit Critical Section应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [
        "msg_30",
        "msg_31"
      ],
      "timestamp_offset": 795
    },
    {
      "turn_id": 54,
      "speaker": "Speaker_A",
      "utterance": "你能详细说明一下Return SL_STATUS_NOT_FOUND、Add received data packet to corresponding<br>notification event queue吗？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 810
    },
    {
      "turn_id": 55,
      "speaker": "Speaker_B",
      "utterance": "我的意思是Return SL_STATUS_NOT_FOUND、Add received data packet to corresponding<br>notification event queue应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [],
      "timestamp_offset": 825
    },
    {
      "turn_id": 56,
      "speaker": "Speaker_A",
      "utterance": "最终，我们在Return SL_STATUS_NOT_FOUND、Add received data packet to corresponding<br>notification event queue完成整个流程。",
      "speech_act": "sequential",
      "diagram_elements_added": [
        "msg_32",
        "msg_33"
      ],
      "timestamp_offset": 840
    },
    {
      "turn_id": 57,
      "speaker": "Speaker_B",
      "utterance": "我们可以将Trigger Notification event to event handler thread、Enter Critical Section分为几个类型。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 855
    },
    {
      "turn_id": 58,
      "speaker": "Speaker_A",
      "utterance": "我们需要确保这个逻辑是正确的。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 870
    },
    {
      "turn_id": 59,
      "speaker": "Speaker_B",
      "utterance": "你能详细说明一下Trigger Notification event to event handler thread、Enter Critical Section吗？",
      "speech_act": "request",
      "diagram_elements_added": [
        "msg_34",
        "msg_35",
        "msg_36"
      ],
      "timestamp_offset": 885
    },
    {
      "turn_id": 60,
      "speaker": "Speaker_A",
      "utterance": "我们可以将Exit Critical Section、Return the data to the application分为几个类型。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 900
    },
    {
      "turn_id": 61,
      "speaker": "Speaker_B",
      "utterance": "明白了，Exit Critical Section、Return the data to the application就这样设计。",
      "speech_act": "confirm",
      "diagram_elements_added": [],
      "timestamp_offset": 915
    },
    {
      "turn_id": 62,
      "speaker": "Speaker_A",
      "utterance": "最终，我们在Exit Critical Section、Return the data to the application完成整个流程。",
      "speech_act": "sequential",
      "diagram_elements_added": [
        "msg_37",
        "msg_38"
      ],
      "timestamp_offset": 930
    }
  ],
  "dialogue_stats": {
    "total_turns": 62,
    "speaker_distribution": {
      "Speaker_B": 31,
      "Speaker_A": 31
    },
    "speech_act_distribution": {
      "sequential": 6,
      "inform": 13,
      "request": 12,
      "structural": 7,
      "classification": 10,
      "confirm": 7,
      "clarify": 6,
      "contrastive": 1
    },
    "avg_turn_length": 57.193548387096776,
    "dialogue_duration": 930
  }
}