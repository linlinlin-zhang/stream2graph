{
  "id": "aug_gh_sequence_00916_Gro_5",
  "source": "augmented_real_structure",
  "source_url": "https://github.com/luth9r/FitTracker/blob/c81958bfbd32229654cff70c18fdc0d6e0541f71/docs/google-oauth-login-flow.mmd",
  "github_repo": "luth9r/FitTracker",
  "github_file_path": "docs/google-oauth-login-flow.mmd",
  "diagram_type": "sequence",
  "code": "%%{Groupware_WikiPage}}%%\nsequenceDiagram\n    participant C as Client\n    participant G as Google OAuth\n    participant AC as AuthController\n    participant GOS as GoogleOAuthService\n    participant GT as Google Token API\n    participant GV as Google Validator\n    participant UR as UserRepository\n    participant DB as PostgreSQL\n    participant JTG as JwtTokenGenerator\n\n    C->>C: Generate PKCE parameters\n    C->>G: Redirect to Google OAuth\n    G-->>C: Redirect with code\n    \n    C->>AC: POST /api/auth/google-login<br/>{Groupware_WikiPage}\n    AC->>GOS: ExchangeCodeForTokens(Groupware_KanbanBoard)\n    GOS->>GT: POST https://oauth2.googleapis.com/token\n    GT-->>GOS: {Groupware_ChatRoom}\n    GOS->>GV: ValidateAsync(Groupware_KanbanBoard)\n    GV-->>GOS: {Groupware_IssueTracker}\n    GOS-->>AC: GoogleTokenPayload\n    \n    AC->>UR: FindByGoogleProviderId(Groupware_SprintBacklog)\n    UR->>DB: SELECT * FROM Users<br/>WHERE GoogleProviderId = ?\n    DB-->>UR: User found\n    UR-->>AC: user\n    \n    AC->>JTG: GenerateAuthToken(Groupware_KanbanBoard)\n    JTG-->>AC: authToken\n    AC-->>C: 200 OK + Set-Cookie: auth-token\n",
  "content_size": 1100,
  "collected_at": "2026-02-06T01:50:43.764377",
  "compilation_status": "failed",
  "license": "mit",
  "license_name": "MIT License",
  "license_url": "https://api.github.com/licenses/mit",
  "repo_stars": 2,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "augmentation_domain": "Groupware",
  "seed_id": "gh_sequence_00916",
  "dialogue": [
    {
      "turn_id": 1,
      "speaker": "Speaker_B",
      "utterance": "首先，我们需要定义流程的起点。",
      "speech_act": "sequential",
      "diagram_elements_added": [],
      "timestamp_offset": 15
    },
    {
      "turn_id": 2,
      "speaker": "Speaker_A",
      "utterance": "我的意思是Client、Google OAuth应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [],
      "timestamp_offset": 30
    },
    {
      "turn_id": 3,
      "speaker": "Speaker_B",
      "utterance": "相较于方案A，Client、Google OAuth有更好的性能。",
      "speech_act": "contrastive",
      "diagram_elements_added": [],
      "timestamp_offset": 45
    },
    {
      "turn_id": 4,
      "speaker": "Speaker_A",
      "utterance": "我们来设计一下这个流程，首先需要一个开始节点。",
      "speech_act": "sequential",
      "diagram_elements_added": [
        "C",
        "G",
        "AC"
      ],
      "timestamp_offset": 60
    },
    {
      "turn_id": 5,
      "speaker": "Speaker_B",
      "utterance": "我们应该如何处理GoogleOAuthService？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 75
    },
    {
      "turn_id": 6,
      "speaker": "Speaker_A",
      "utterance": "让我澄清一下，GoogleOAuthService的作用是...",
      "speech_act": "clarify",
      "diagram_elements_added": [],
      "timestamp_offset": 90
    },
    {
      "turn_id": 7,
      "speaker": "Speaker_B",
      "utterance": "好的，那就按这个方案。",
      "speech_act": "confirm",
      "diagram_elements_added": [],
      "timestamp_offset": 105
    },
    {
      "turn_id": 8,
      "speaker": "Speaker_A",
      "utterance": "我的意思是GoogleOAuthService应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [
        "GOS"
      ],
      "timestamp_offset": 120
    },
    {
      "turn_id": 9,
      "speaker": "Speaker_B",
      "utterance": "你能详细说明一下Google Token API、Google Validator吗？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 135
    },
    {
      "turn_id": 10,
      "speaker": "Speaker_A",
      "utterance": "我们需要确保这个逻辑是正确的。",
      "speech_act": "inform",
      "diagram_elements_added": [],
      "timestamp_offset": 150
    },
    {
      "turn_id": 11,
      "speaker": "Speaker_B",
      "utterance": "这个系统主要由Google Token API、Google Validator组成。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 165
    },
    {
      "turn_id": 12,
      "speaker": "Speaker_A",
      "utterance": "相较于方案A，Google Token API、Google Validator有更好的性能。",
      "speech_act": "contrastive",
      "diagram_elements_added": [
        "GT",
        "GV"
      ],
      "timestamp_offset": 180
    },
    {
      "turn_id": 13,
      "speaker": "Speaker_B",
      "utterance": "这个系统主要由UserRepository、PostgreSQL组成。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 195
    },
    {
      "turn_id": 14,
      "speaker": "Speaker_A",
      "utterance": "确认一下，UserRepository、PostgreSQL是正确的吧？",
      "speech_act": "confirm",
      "diagram_elements_added": [
        "UR",
        "DB"
      ],
      "timestamp_offset": 210
    },
    {
      "turn_id": 15,
      "speaker": "Speaker_B",
      "utterance": "从结构上看，我们有JwtTokenGenerator、Generate PKCE parameters。",
      "speech_act": "structural",
      "diagram_elements_added": [],
      "timestamp_offset": 225
    },
    {
      "turn_id": 16,
      "speaker": "Speaker_A",
      "utterance": "确认一下，JwtTokenGenerator、Generate PKCE parameters是正确的吧？",
      "speech_act": "confirm",
      "diagram_elements_added": [
        "JTG",
        "msg_0"
      ],
      "timestamp_offset": 240
    },
    {
      "turn_id": 17,
      "speaker": "Speaker_B",
      "utterance": "我们可以将Redirect to Google OAuth、POST /api/auth/google-login<br/>{Groupware_WikiPage}分为几个类型。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 255
    },
    {
      "turn_id": 18,
      "speaker": "Speaker_A",
      "utterance": "确认一下，Redirect to Google OAuth、POST /api/auth/google-login<br/>{Groupware_WikiPage}是正确的吧？",
      "speech_act": "confirm",
      "diagram_elements_added": [],
      "timestamp_offset": 270
    },
    {
      "turn_id": 19,
      "speaker": "Speaker_B",
      "utterance": "Redirect to Google OAuth、POST /api/auth/google-login<br/>{Groupware_WikiPage}和另一个方案相比，优势在于...",
      "speech_act": "contrastive",
      "diagram_elements_added": [],
      "timestamp_offset": 285
    },
    {
      "turn_id": 20,
      "speaker": "Speaker_A",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "msg_1",
        "msg_2"
      ],
      "timestamp_offset": 300
    },
    {
      "turn_id": 21,
      "speaker": "Speaker_B",
      "utterance": "我们应该如何处理ExchangeCodeForTokens(Groupware_KanbanBoard)？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 315
    },
    {
      "turn_id": 22,
      "speaker": "Speaker_A",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "msg_3"
      ],
      "timestamp_offset": 330
    },
    {
      "turn_id": 23,
      "speaker": "Speaker_B",
      "utterance": "POST https://oauth2.googleapis.com/token主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 345
    },
    {
      "turn_id": 24,
      "speaker": "Speaker_A",
      "utterance": "这个设计看起来不错。",
      "speech_act": "inform",
      "diagram_elements_added": [
        "msg_4"
      ],
      "timestamp_offset": 360
    },
    {
      "turn_id": 25,
      "speaker": "Speaker_B",
      "utterance": "ValidateAsync(Groupware_KanbanBoard)、FindByGoogleProviderId(Groupware_SprintBacklog)主要包含以下几类。",
      "speech_act": "classification",
      "diagram_elements_added": [],
      "timestamp_offset": 375
    },
    {
      "turn_id": 26,
      "speaker": "Speaker_A",
      "utterance": "我的意思是ValidateAsync(Groupware_KanbanBoard)、FindByGoogleProviderId(Groupware_SprintBacklog)应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [],
      "timestamp_offset": 390
    },
    {
      "turn_id": 27,
      "speaker": "Speaker_B",
      "utterance": "我的意思是ValidateAsync(Groupware_KanbanBoard)、FindByGoogleProviderId(Groupware_SprintBacklog)应该这样理解...",
      "speech_act": "clarify",
      "diagram_elements_added": [
        "msg_5",
        "msg_6",
        "msg_7"
      ],
      "timestamp_offset": 405
    },
    {
      "turn_id": 28,
      "speaker": "Speaker_A",
      "utterance": "你能详细说明一下GenerateAuthToken(Groupware_KanbanBoard)吗？",
      "speech_act": "request",
      "diagram_elements_added": [],
      "timestamp_offset": 420
    },
    {
      "turn_id": 29,
      "speaker": "Speaker_B",
      "utterance": "最后，流程到达GenerateAuthToken(Groupware_KanbanBoard)结束。",
      "speech_act": "sequential",
      "diagram_elements_added": [
        "msg_8"
      ],
      "timestamp_offset": 435
    }
  ],
  "dialogue_stats": {
    "total_turns": 29,
    "speaker_distribution": {
      "Speaker_B": 15,
      "Speaker_A": 14
    },
    "speech_act_distribution": {
      "sequential": 3,
      "clarify": 5,
      "contrastive": 3,
      "request": 4,
      "confirm": 4,
      "inform": 4,
      "structural": 3,
      "classification": 3
    },
    "avg_turn_length": 45.55172413793103,
    "dialogue_duration": 435
  }
}