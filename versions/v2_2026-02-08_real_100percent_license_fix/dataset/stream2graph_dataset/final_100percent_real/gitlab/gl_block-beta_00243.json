{
  "id": "gl_block-beta_00243",
  "source": "gitlab",
  "source_url": "https://github.com/opensensor/openimp/blob/248392a45289e37606d51c3bdea12059453ee6a7/assets/data-flow.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "opensensor/openimp",
  "diagram_type": "block-beta",
  "code": "%% OpenIMP Data Flow Diagram\n%% This diagram shows the complete end-to-end data flow from hardware to user application\n\ngraph TD\n    %% Hardware Layer\n    HW[Hardware Layer<br/>Ingenic ISP → Kernel Driver<br/>/dev/framechan0-5]\n    \n    %% Frame Capture\n    FCT[Frame Capture Thread<br/>frame_capture_thread<br/>- Poll for frames<br/>- Get from VBM<br/>- Notify observers]\n    \n    %% VBM\n    VBM[VBM Frame Pool<br/>Physical/Virtual Memory DMA<br/>- IMP_Alloc via kernel<br/>- mmap physical→virtual<br/>- VBMPool: 0x180 + buffers<br/>- VBMFrame: 0x428 bytes]\n    \n    %% Observer Pattern\n    OBS[Observer Pattern<br/>System Module<br/>- Traverse observer list<br/>- Call update callbacks<br/>- Observer: next, module, frame]\n    \n    %% Encoder Thread\n    ENC[Encoder Thread<br/>encoder_thread<br/>- Receive frame notification<br/>- Process through codec<br/>- Signal stream thread]\n    \n    %% Codec Frame FIFO\n    CFF[Codec Frame FIFO<br/>Thread-safe Queue<br/>- Mutex + CondVar + Sem<br/>- Timeout support<br/>- Abort flag]\n    \n    %% Stream Thread\n    STR[Stream Thread<br/>stream_thread<br/>- Wait for eventfd<br/>- Get encoded stream<br/>- Queue for user]\n    \n    %% Codec Stream FIFO\n    CSF[Codec Stream FIFO<br/>Thread-safe Queue<br/>- H.264/H.265 streams<br/>- Same Fifo impl<br/>- Thread-safe dequeue]\n    \n    %% User Application\n    APP[User Application<br/>prudynt-t, custom apps<br/>- IMP_Encoder_GetStream<br/>- Process stream<br/>- IMP_Encoder_ReleaseStream]\n    \n    %% Connections\n    HW -->|ioctl VIDIOC_POLL_FRAME<br/>0x400456bf| FCT\n    FCT -->|VBMGetFrame chn, &frame| VBM\n    VBM -->|notify_observers module, frame| OBS\n    OBS -->|encoder_update module| ENC\n    ENC -->|AL_Codec_Encode_Process<br/>codec, frame, NULL| CFF\n    CFF -->|eventfd signal write| STR\n    STR -->|AL_Codec_Encode_GetStream<br/>codec, &stream| CSF\n    CSF -->|IMP_Encoder_GetStream<br/>chn, stream, block| APP\n    \n    %% Styling\n    classDef hardware fill:#f9f,stroke:#333,stroke-width:2px\n    classDef thread fill:#bbf,stroke:#333,stroke-width:2px\n    classDef queue fill:#bfb,stroke:#333,stroke-width:2px\n    classDef system fill:#fbb,stroke:#333,stroke-width:2px\n    classDef user fill:#ffb,stroke:#333,stroke-width:2px\n    \n    class HW hardware\n    class FCT,ENC,STR thread\n    class VBM,CFF,CSF queue\n    class OBS system\n    class APP user\n\n",
  "content_size": 2350,
  "collected_at": "2026-02-06T14:05:15.765980",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 7,
  "repo_forks": 0,
  "repo_owner": "opensensor",
  "repo_name": "openimp",
  "repo_description": "An open implementation replacement of libimp",
  "repo_language": "C",
  "repo_topics": [],
  "repo_created_at": "2025-10-11T02:26:56Z",
  "repo_updated_at": "2025-11-18T19:16:06Z",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}