{
  "id": "gl_requirementDiagram_00513",
  "source": "gitlab",
  "source_url": "https://github.com/SWM16-SlowStarter/DYNAMI_AI/blob/d280a7687341f609f2e96392d2496102571dd5d9/docs/present/04-database-erd.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "SWM16-SlowStarter/DYNAMI_AI",
  "diagram_type": "requirementDiagram",
  "code": "erDiagram\n    %% Foundation Entities\n    ProjectEntity {\n        bigint id PK\n        uuid uuid \"common_key - Spring communication\"\n        string name\n        string domain\n        text context\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    UseCaseEntity {\n        bigint id PK\n        uuid common_key\n        string code UK \"e.g. dashboard_suggestion\"\n        string domain \"dashboard/widget/query/resource/common\"\n        string name\n        text description\n        text example_usage\n        jsonb required_placeholders\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    PromptTemplateEntity {\n        bigint id PK\n        uuid common_key\n        bigint use_case_id FK\n        string version\n        text system_prompt\n        text user_prompt\n        boolean is_default\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    PromptActiveMappingEntity {\n        bigint id PK\n        bigint use_case_id FK\n        bigint prompt_template_id FK\n        timestamp activated_at\n    }\n\n    %% Configuration Entities\n    LLMConfigurationEntity {\n        bigint id PK\n        uuid common_key\n        bigint use_case_id FK \"UNIQUE\"\n        string provider \"openai/anthropic/google\"\n        string model\n        numeric temperature\n        integer max_tokens\n        jsonb additional_config\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    LLMProviderEntity {\n        bigint id PK\n        uuid common_key\n        string name UK\n        text description\n        boolean is_active\n    }\n\n    LLMModelEntity {\n        bigint id PK\n        uuid common_key\n        bigint provider_id FK\n        string name\n        text description\n        boolean is_active\n    }\n\n    GridSettingsEntity {\n        bigint id PK\n        uuid common_key\n        integer horizontal_columns\n        integer horizontal_px\n        integer vertical_columns\n        integer vertical_px\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    %% Resource Entities\n    ResourceEntity {\n        bigint id PK\n        uuid uuid \"common_key\"\n        bigint project_id FK\n        string name\n        string category\n        text detail\n        text context\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    %% Dashboard Entities\n    DashboardEntity {\n        bigint id PK\n        bigint project_id FK\n        uuid common_key\n        string name\n        text context\n        timestamp created_at\n        timestamp updated_at\n        timestamp deleted_at\n    }\n\n    DashboardSuggestionEntity {\n        bigint id PK\n        bigint project_id FK\n        uuid common_key \"suggestion record ID\"\n        uuid session_id \"conversation tracking\"\n        text requirement\n        jsonb dashboard_list\n        text context\n        timestamp created_at\n    }\n\n    %% Widget Entities\n    WidgetCategoryEntity {\n        bigint id PK\n        string code UK\n        string display_name\n    }\n\n    WidgetTypeEntity {\n        bigint id PK\n        string code UK\n        bigint category_id FK\n        boolean has_template\n        boolean is_active\n        integer default_height\n        integer sort_order\n    }\n\n    WidgetEntity {\n        bigint id PK\n        bigint dashboard_id FK\n        bigint project_id FK\n        bigint resource_id FK\n        uuid common_key\n        bigint widget_type_id FK\n        string name\n        text context\n        timestamp created_at\n        timestamp updated_at\n        timestamp deleted_at\n    }\n\n    WidgetSuggestionEntity {\n        bigint id PK\n        uuid common_key UK\n        bigint project_id FK\n        bigint dashboard_id FK\n        uuid session_id\n        bigint widget_type_id FK\n        text requirement\n        text explanation\n        text rendering_plan\n        jsonb actions\n        text context\n    }\n\n    WidgetTemplateEntity {\n        bigint id PK\n        uuid common_key\n        bigint widget_type_id FK\n        string name\n        text source_code\n        text description\n    }\n\n    %% Query Entities\n    QueryHistoryEntity {\n        bigint id PK\n        bigint project_id \"indexed\"\n        bigint resource_id \"indexed\"\n        text requirement\n        text original_query\n        text generated_query\n        text impact\n        timestamp created_at\n    }\n\n    %% Common Domain Entities\n    RequestLogEntity {\n        bigint id PK\n        string request_id\n        text endpoint\n        text method\n        jsonb request_body\n        integer response_status\n        timestamp created_at\n    }\n\n    %% Relationships\n\n    %% Foundation relationships\n    UseCaseEntity ||--o{ PromptTemplateEntity : \"has templates\"\n    UseCaseEntity ||--o{ PromptActiveMappingEntity : \"has mappings\"\n    UseCaseEntity ||--o{ LLMConfigurationEntity : \"has config\"\n    PromptTemplateEntity ||--o{ PromptActiveMappingEntity : \"mapped in\"\n\n    %% LLM Configuration relationships\n    LLMProviderEntity ||--o{ LLMModelEntity : \"provides models\"\n\n    %% Project relationships (CASCADE deletes)\n    ProjectEntity ||--o{ ResourceEntity : \"has resources (CASCADE)\"\n    ProjectEntity ||--o{ DashboardEntity : \"has dashboards (CASCADE)\"\n    ProjectEntity ||--o{ WidgetEntity : \"has widgets (CASCADE)\"\n    ProjectEntity ||--o{ DashboardSuggestionEntity : \"has suggestions (CASCADE)\"\n    ProjectEntity ||--o{ WidgetSuggestionEntity : \"has suggestions (CASCADE)\"\n    ProjectEntity ||--o{ QueryHistoryEntity : \"has query history\"\n\n    %% Dashboard-Widget relationships\n    DashboardEntity ||--o{ WidgetEntity : \"contains widgets (CASCADE)\"\n    DashboardEntity ||--o| WidgetSuggestionEntity : \"suggested for (SET NULL)\"\n\n    %% Widget Type relationships (RESTRICT - prevent orphans)\n    WidgetCategoryEntity ||--o{ WidgetTypeEntity : \"categorizes\"\n    WidgetTypeEntity ||--o{ WidgetEntity : \"defines type (RESTRICT)\"\n    WidgetTypeEntity ||--o{ WidgetSuggestionEntity : \"suggests type\"\n    WidgetTypeEntity ||--o{ WidgetTemplateEntity : \"has templates\"\n\n    %% Resource relationships\n    ResourceEntity ||--o{ WidgetEntity : \"powers widget (SET NULL)\"\n    ResourceEntity ||--o{ QueryHistoryEntity : \"used in queries\"\n",
  "content_size": 6086,
  "collected_at": "2026-02-06T14:11:24.385532",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}