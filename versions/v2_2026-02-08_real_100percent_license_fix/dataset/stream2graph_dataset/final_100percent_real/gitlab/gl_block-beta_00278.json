{
  "id": "gl_block-beta_00278",
  "source": "gitlab",
  "source_url": "https://github.com/dreamworks2050/retro-login/blob/a5d9c30e1981d58ace1167830b9fec57a8fa08d1/docs/architecture.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "dreamworks2050/retro-login",
  "diagram_type": "block-beta",
  "code": "# RetroLogin Architecture Documentation\n\nThis document provides visual architecture diagrams for the RetroLogin WordPress plugin.\n\n## System Overview\n\nThe RetroLogin plugin enhances the WordPress login page with retro-themed styling while maintaining full compatibility with WordPress authentication.\n\n## Component Architecture\n\n```mermaid\ngraph TD\n    subgraph WordPress Core\n        WP[WordPress Login Page<br/>/wp-login.php]\n        AUTH[Authentication<br/>System]\n        HOOKS[Hook System<br/>Actions & Filters]\n    end\n\n    subgraph RetroLogin Plugin\n        MAIN[retrologin.php<br/>Main Plugin File]\n        \n        subgraph Core Components\n            INIT[Bootstrap<br/>Initialization]\n            LOADER[Autoloader<br/>PSR-4]\n        end\n        \n        subgraph Application Layer\n            LOGIN[Login<br/>Handler]\n            SETTINGS[Settings<br/>Manager]\n            LOGGER[Logger<br/>Structured]\n        end\n        \n        subgraph Assets\n            CSS[CSS<br/>Styles]\n            JS[JavaScript<br/>Scripts]\n            ICONS[Icon<br/>Assets]\n        end\n    end\n\n    WP --> HOOKS\n    HOOKS --> MAIN\n    MAIN --> INIT\n    MAIN --> LOADER\n    \n    INIT --> LOGIN\n    INIT --> SETTINGS\n    INIT --> LOGGER\n    \n    LOGIN --> CSS\n    LOGIN --> JS\n    LOGIN --> ICONS\n    \n    HOOKS --> AUTH\n    \n    SETTINGS --> OPTIONS[(WordPress<br/>Options DB)]\n```\n\n## Directory Structure\n\n```mermaid\ngraph TD\n    ROOT[retrologin/]\n    \n    subgraph Plugin Root\n        MAIN[retrologin.php<br/>Entry Point]\n        CONFIG[composer.json<br/>Package Config]\n    end\n    \n    subgraph Application Layer [app/]\n        CORE[Retrologin/<br/>Namespace]\n        LOGIN[Login.php<br/>Login Handler]\n        SETTINGS[Settings.php<br/>Settings Manager]\n        LOGGER[Logger.php<br/>Logging]\n    end\n    \n    subgraph Includes [inc/]\n        BOOT[bootstrap/<br/>Bootstrap Files]\n        LANG[languages/<br/>Translations]\n    end\n    \n    subgraph Assets [dist/]\n        DIST_CSS[css/<br/>Compiled CSS]\n        DIST_JS[js/<br/>Compiled JS]\n    end\n    \n    subgraph Source [src/]\n        SRC_BLOCKS[block/<br/>Gutenberg Blocks]\n        SRC_PAGES[setting-page/<br/>Admin Pages]\n    end\n    \n    ROOT --> MAIN\n    ROOT --> CONFIG\n    ROOT --> APP\n    ROOT --> INC\n    ROOT --> DIST\n    ROOT --> SRC\n```\n\n## Data Flow: Login Page Request\n\n```mermaid\nsequenceDiagram\n    participant User as User/Browser\n    participant WP as WordPress\n    participant Plugin as RetroLogin Plugin\n    participant DB as WordPress DB\n    participant Assets as Static Assets\n    \n    User->>WP: GET /wp-login.php\n    WP->>Plugin: Load Plugin\n    Plugin->>Plugin: Initialize Autoloader\n    Plugin->>Plugin: Register Hooks\n    \n    Note over Plugin: Hook: login_enqueue_scripts\n    Plugin->>Assets: Enqueue CSS\n    Plugin->>Assets: Enqueue JavaScript\n    \n    Note over Plugin: Hook: login_head\n    Plugin->>Plugin: Apply Custom Styles\n    \n    User->>WP: Submit Credentials\n    WP->>WP: Process Authentication\n    WP->>DB: Verify Credentials\n    \n    alt Authentication Success\n        DB-->>WP: Valid User\n        WP-->>User: Redirect to Dashboard\n    else Authentication Failed\n        DB-->>WP: Invalid Credentials\n        WP-->>User: Show Error Message\n    end\n```\n\n## Settings Data Flow\n\n```mermaid\nsequenceDiagram\n    participant Admin as Admin User\n    participant Page as Settings Page\n    participant API as WordPress Settings API\n    participant Options as Options Table\n    participant Login as Login Handler\n    \n    Admin->>Page:访问设置页面\n    Page->>API: 获取当前设置\n    API->>Options: 读取选项值\n    Options-->>Page: 返回设置\n    \n    Admin->>Page: 保存设置\n    Page->>API: 验证并保存\n    API->>Options: 存储到数据库\n    \n    Note over Options: 设置已更新\n    \n    Login->>API: 获取用户设置\n    API->>Options: 读取选项值\n    Options-->>Login: 返回设置\n    Login->>Login: 应用自定义样式\n```\n\n## Hook Points\n\n```mermaid\ngraph LR\n    subgraph Action Hooks\n        A1[login_init]\n        A2[login_enqueue_scripts]\n        A3[login_head]\n        A4[login_footer]\n    end\n    \n    subgraph Filter Hooks\n        F1[login_headerurl]\n        F2[login_headertitle]\n        F3[login_message]\n        F4[retrieve_password_message]\n    end\n    \n    subgraph Shortcodes\n        S1[retro_login_form]\n    end\n    \n    RETRO[RetroLogin Plugin] --> A1\n    RETRO --> A2\n    RETRO --> A3\n    RETRO --> A4\n    \n    RETRO --> F1\n    RETRO --> F2\n    RETRO --> F3\n    RETRO --> F4\n    \n    RETRO --> S1\n```\n\n## Testing Architecture\n\n```mermaid\ngraph TD\n    subgraph Test Suite\n        UNIT[Unit Tests<br/>tests/Unit/]\n        INT[Integration Tests<br/>tests/Integration/]\n        \n        subgraph Test Coverage\n            COV1[Plugin Class]\n            COV2[Login Handler]\n            COV3[Settings Manager]\n            COV4[Logger]\n        end\n    end\n    \n    subgraph CI/CD Pipeline\n        GHA[GitHub Actions]\n        TEST[Run Tests]\n        BUILD[Build Assets]\n        DEPLOY[Deploy]\n    end\n    \n    UNIT --> COV1\n    UNIT --> COV2\n    UNIT --> COV3\n    UNIT --> COV4\n    \n    INT --> COV1\n    INT --> COV2\n    \n    TEST --> UNIT\n    TEST --> INT\n    \n    GHA --> TEST\n    GHA --> BUILD\n```\n\n## Error Handling Flow\n\n```mermaid\nflowchart TD\n    A[Error Occurs] --> B{Is Debug Mode?}\n    B -->|Yes| C[Log Error Details]\n    B -->|No| D[Log Minimal Info]\n    \n    C --> E{Error Severity}\n    D --> E\n    \n    E -->|Debug| F[Debug Log]\n    E -->|Info| G[Info Log]\n    E -->|Warning| H[Warning Log]\n    E -->|Error| I[Error Log + WP Debug]\n    \n    F --> J[Output to debug.log]\n    G --> J\n    H --> J\n    I --> J\n    I --> K[Display Error if WP_DEBUG_DISPLAY]\n```\n",
  "content_size": 5571,
  "collected_at": "2026-02-06T14:06:07.548840",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com"
}