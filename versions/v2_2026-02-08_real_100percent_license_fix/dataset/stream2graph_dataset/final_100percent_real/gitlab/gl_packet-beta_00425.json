{
  "id": "gl_packet-beta_00425",
  "source": "gitlab",
  "source_url": "https://github.com/patla001/network_AI_agent/blob/0537b5540ea4523798d9582c6efec8fc62a8a54a/diagrams/03-sequence.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "patla001/network_AI_agent",
  "diagram_type": "packet-beta",
  "code": "sequenceDiagram\n    participant Network as ğŸŒ Network Interface\n    participant PyShark as ğŸ“¡ PyShark Capture\n    participant Features as ğŸ“Š Feature Extractor\n    participant ML as ğŸ§  ML Models\n    participant Monitor as ğŸ” Monitor Node\n    participant Analysis as ğŸ“ˆ Analysis Node\n    participant Decision as ğŸ’¡ Decision Node\n    participant ChromaDB as ğŸ’¾ ChromaDB RAG\n    participant Claude as ğŸ¤– Claude AI\n    participant Action as âš¡ Action Node\n    participant Prometheus as ğŸ“Š Prometheus\n    \n    Network->>PyShark: Raw network traffic\n    PyShark->>PyShark: Capture 100 packets (5 seconds)\n    PyShark->>Monitor: Parsed packets (IP, ports, flags)\n    Monitor->>Features: Extract features\n    Features->>Features: Calculate 26 features<br/>(flows, rates, IAT, flags)\n    Features->>Monitor: Feature vector\n    Monitor->>Analysis: Packets + Features\n    Analysis->>ML: Feature vector\n    ML->>ML: Isolation Forest prediction\n    ML->>Analysis: Anomaly score (0.0-1.0)\n    \n    alt Score < 0.8 (Normal)\n        Analysis->>Prometheus: Update metrics (normal)\n        Prometheus-->>Analysis: Metrics recorded\n    else Score >= 0.8 (Anomaly!)\n        Analysis->>Decision: Anomaly detected!\n        Decision->>ChromaDB: Query similar incidents\n        ChromaDB->>ChromaDB: Semantic search<br/>(embeddings)\n        ChromaDB->>Decision: Top 3 similar incidents\n        Decision->>Claude: Current anomaly + historical context\n        Claude->>Claude: Analyze patterns<br/>Make decision\n        Claude->>Decision: Action + reasoning\n        Decision->>Action: Execute decision\n        Action->>Action: Apply action<br/>(block/limit/alert)\n        Action->>ChromaDB: Store new incident\n        ChromaDB-->>Action: Incident stored\n        Action->>Prometheus: Update metrics (anomaly)\n        Prometheus-->>Action: Metrics recorded\n    end\n\n",
  "content_size": 1825,
  "collected_at": "2026-02-06T14:09:30.659983",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚"
}