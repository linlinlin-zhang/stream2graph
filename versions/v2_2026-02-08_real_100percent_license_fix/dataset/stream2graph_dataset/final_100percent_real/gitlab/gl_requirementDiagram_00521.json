{
  "id": "gl_requirementDiagram_00521",
  "source": "gitlab",
  "source_url": "https://github.com/DrowningToast/decm/blob/92bfff13cda49f59fa0e9b27979453bdf90a2f88/diagrams/entity-relationship-diagram.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "DrowningToast/decm",
  "diagram_type": "requirementDiagram",
  "code": "erDiagram\n    %% Core Authentication & User Management\n    authentication_credentials ||--|| profiles : \"has exactly one\"\n    authentication_credentials ||--o{ events : \"owns zero or many\"\n    authentication_credentials ||--o{ event_attendees : \"attends zero or many\"\n    authentication_credentials ||--o{ event_issuers : \"issues for zero or many\"\n    authentication_credentials ||--o{ inbox_messages : \"sends zero or many\"\n    authentication_credentials ||--o{ inbox_messages : \"receives zero or many\"\n\n    %% Event Management\n    events ||--|| event_registration_configs : \"has exactly one\"\n    events ||--o| event_certificate_configs : \"has zero or one\"\n    events ||--o{ event_issuers : \"has zero or many issuers\"\n    events ||--o| event_contracts : \"has zero or one\"\n    events ||--o{ event_attendees : \"has zero or many attendees\"\n    events ||--o{ event_registration_invitations : \"has zero or many invitations\"\n    events ||--o{ event_registration_email_referrals : \"has zero or many referrals\"\n    events ||--o{ event_registration_requirements : \"has zero or many requirements\"\n\n    %% Event Registration Requirements\n    event_registration_requirements }o--|| event_registration_requirement_types : \"has exactly one type\"\n    event_registration_requirements ||--o{ event_registration_requirements_trusted_identities : \"requires zero or many identities\"\n    trusted_identities ||--o{ event_registration_requirements_trusted_identities : \"trusted by zero or many\"\n\n    %% Inbox Messaging\n    inbox_messages }o--|| inbox_message_types : \"has exactly one type\"\n    inbox_messages ||--o| event_registration_invitations : \"has zero or one invitation\"\n\n    %% Table Definitions\n    authentication_credentials {\n        uuid id PK\n        integer solution_status \"0: BYOPK, 1: System Managed\"\n        varchar hashed_password \"Argon2id hash\"\n        bytea encrypted_private_key \"AES-256-GCM encrypted\"\n        varchar wallet_address UK \"Unique wallet address\"\n        text google_connector_ref \"PII Encrypted\"\n        text github_connector_ref \"PII Encrypted\"\n        integer is_verified_organizer\n        integer is_verified_issuer\n        integer is_verified_student\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    profiles {\n        uuid id PK\n        uuid authentication_credential_id FK\n        integer is_profile_picture_public\n        text profile_picture_url \"PII Encrypted\"\n        integer is_first_name_public\n        text first_name \"PII Encrypted\"\n        integer is_last_name_public\n        text last_name \"PII Encrypted\"\n        integer is_email_public\n        text email \"PII Encrypted\"\n        integer is_bio_public\n        text bio \"PII Encrypted\"\n        integer is_phone_number_public\n        text phone_number \"PII Encrypted\"\n        integer is_address_public\n        text address \"PII Encrypted\"\n        integer is_academic_institution_public\n        text academic_institution \"PII Encrypted\"\n        integer is_academic_email_public\n        text academic_email \"PII Encrypted\"\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    events {\n        uuid id PK\n        integer chain_id\n        varchar contact_number\n        varchar contact_address\n        uuid owner_credential_id FK\n        varchar banner_storage_key\n        varchar icon_storage_key\n        varchar title\n        varchar short_description\n        text long_description\n        timestamptz start_date\n        timestamptz end_date\n        varchar location\n        varchar google_map_query\n        integer max_attendees\n        integer is_public \"0: Private, 1: Public\"\n        integer is_booking_request_required\n        integer is_verified\n        integer is_ticket_transferable\n        timestamptz created_at\n        timestamptz updated_at\n        timestamptz deleted_at\n    }\n\n    event_attendees {\n        uuid id PK\n        uuid event_id FK\n        uuid attendee_credential_id FK\n        varchar contact_address \"Wallet address\"\n        integer is_attendee_accepted\n        text first_name \"PII Encrypted\"\n        text last_name \"PII Encrypted\"\n        text email \"PII Encrypted\"\n        text bio \"PII Encrypted\"\n        text phone_number \"PII Encrypted\"\n        text address \"PII Encrypted\"\n        text academic_institution \"PII Encrypted\"\n        text academic_email \"PII Encrypted\"\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_registration_configs {\n        uuid id PK\n        uuid event_id FK\n        timestamptz final_call_for_registration\n        text registration_password\n        integer first_name_requirement_status \"0: Not Required, 1: Required, 2: Optional\"\n        integer last_name_requirement_status\n        integer email_requirement_status\n        integer bio_requirement_status\n        integer phone_number_requirement_status\n        integer address_requirement_status\n        integer academic_institution_requirement_status\n        integer academic_email_requirement_status\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_certificate_configs {\n        uuid id PK\n        uuid event_id FK\n        varchar base_certificate_storage_key\n        float event_name_pos_x\n        float event_name_pos_y\n        float name_pos_x\n        float name_pos_y\n        float academic_institution_pos_x\n        float academic_institution_pos_y\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_issuers {\n        uuid id PK\n        uuid event_id FK\n        uuid issuer_credential_id FK\n        integer is_signed \"0: Not Signed, 1: Signed\"\n        text signature \"Digital signature\"\n        text sign_message\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_contracts {\n        uuid id PK\n        uuid event_id FK\n        varchar access_manager_contract_address\n        varchar event_contract_address\n        varchar ticket_contract_address\n        varchar certificate_contract_address\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    inbox_message_types {\n        integer id PK\n        varchar name\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    inbox_messages {\n        uuid id PK\n        uuid sender_credential_id FK\n        uuid receiver_credential_id FK\n        integer message_type FK\n        jsonb message_content \"i18n translations\"\n        text fallback_message_content\n        integer is_read \"0: Unread, 1: Read\"\n        timestamptz created_at\n        timestamptz updated_at\n        timestamptz hidden_at\n        timestamptz deleted_at\n    }\n\n    trusted_identities {\n        uuid id PK\n        varchar name\n        text[] expected_identifiers\n        text[] expected_issuer_addresses\n        integer is_self_issued \"0: External, 1: Self-Issued\"\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_registration_requirement_types {\n        integer id PK\n        varchar name \"password-protected, invite-only\"\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_registration_requirements {\n        uuid id PK\n        uuid event_id FK\n        integer requirement_type_id FK\n        text password\n        integer max_attempts_in_period\n        integer period_duration_seconds\n        integer is_identity_verification_required\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_registration_requirements_trusted_identities {\n        uuid id PK\n        uuid event_registration_requirement_id FK\n        uuid trusted_identity_id FK\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_registration_invitations {\n        uuid id PK\n        uuid event_id FK\n        uuid inbox_message_id FK\n        timestamptz valid_until\n        text code\n        timestamptz created_at\n        timestamptz updated_at\n    }\n\n    event_registration_email_referrals {\n        uuid id PK\n        uuid event_id FK\n        timestamptz valid_until\n        integer is_used \"0: Unused, 1: Used\"\n        text first_name \"PII Encrypted\"\n        text last_name \"PII Encrypted\"\n        text email \"PII Encrypted\"\n        text bio \"PII Encrypted\"\n        text phone_number \"PII Encrypted\"\n        text address \"PII Encrypted\"\n        text academic_institution \"PII Encrypted\"\n        text academic_email \"PII Encrypted\"\n        timestamptz created_at\n        timestamptz updated_at\n    }\n",
  "content_size": 8382,
  "collected_at": "2026-02-06T14:11:30.718745",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}