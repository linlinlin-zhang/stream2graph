{
  "id": "gl_flowchart_00637",
  "source": "gitlab",
  "source_url": "https://github.com/sempervent/s3-rust-data-portal/blob/cca3a2354e35a8b56d9891550b2d4188b28c0146/docs/policy-eval.mmd",
  "source_note": "collected_from_github_final",
  "github_repo": "sempervent/s3-rust-data-portal",
  "diagram_type": "flowchart",
  "code": "flowchart TD\n    A[Policy Evaluation Request] --> B{Authentication Valid?}\n    B -->|No| C[Return 401 Unauthorized]\n    B -->|Yes| D{User Has Permission?}\n    \n    D -->|No| E[Return 403 Forbidden]\n    D -->|Yes| F{Resource Exists?}\n    \n    F -->|No| G[Return 404 Not Found]\n    F -->|Yes| H{Check Retention Policy}\n    \n    H --> I{Object Age > Retention Period?}\n    I -->|Yes| J[Mark for Deletion]\n    I -->|No| K{Check Legal Hold}\n    \n    K --> L{Object Under Legal Hold?}\n    L -->|Yes| M[Protect from Deletion]\n    L -->|No| N{Check Access Policy}\n    \n    N --> O{User Role Allowed?}\n    O -->|No| P[Return 403 Forbidden]\n    O -->|Yes| Q{Check Rate Limits}\n    \n    Q --> R{Rate Limit Exceeded?}\n    R -->|Yes| S[Return 429 Too Many Requests]\n    R -->|No| T{Check Budget Limits}\n    \n    T --> U{Budget Exceeded?}\n    U -->|Yes| V[Return 402 Payment Required]\n    U -->|No| W{Check Geographic Restrictions}\n    \n    W --> X{Location Allowed?}\n    X -->|No| Y[Return 403 Forbidden]\n    X -->|Yes| Z{Check Time Restrictions}\n    \n    Z --> AA{Time Window Valid?}\n    AA -->|No| BB[Return 403 Forbidden]\n    AA -->|Yes| CC[Allow Access]\n    \n    CC --> DD[Log Access Event]\n    DD --> EE[Update Usage Metrics]\n    EE --> FF[Return Success Response]\n    \n    J --> GG[Schedule Deletion Job]\n    M --> HH[Skip Deletion]\n    \n    GG --> II[Log Policy Action]\n    HH --> II\n    II --> JJ[Return Policy Decision]\n    \n    %% Styling\n    classDef decision fill:#e1f5fe\n    classDef action fill:#f3e5f5\n    classDef error fill:#ffebee\n    classDef success fill:#e8f5e8\n    \n    class B,D,F,I,L,O,R,U,X,AA decision\n    class J,M,GG,HH,DD,EE,II action\n    class C,E,G,P,S,V,Y,BB error\n    class CC,FF,JJ success\n",
  "content_size": 1711,
  "collected_at": "2026-02-06T14:18:17.672872",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}