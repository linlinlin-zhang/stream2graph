{
  "id": "gl_block-beta_00284",
  "source": "gitlab",
  "source_url": "https://github.com/Kamalbura/PQC/blob/ee8ff95ab091a16f70e285d145288a48828ea8f0/diagrams/camellia_flow.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "Kamalbura/PQC",
  "diagram_type": "block-beta",
  "code": "graph TB\n    %% Camellia-128 Block Cipher Flow Diagram\n    %% Research Paper Quality - Pre-Quantum Algorithm c3\n    \n    classDef droneNode fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000\n    classDef gcsNode fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000\n    classDef cryptoOp fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000\n    classDef dataFlow fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000\n    classDef portNode fill:#fff9c4,stroke:#f9a825,stroke-width:2px,color:#000\n\n    subgraph DRONE_SIDE [\"üöÅ DRONE SIDE - Camellia-128 Implementation\"]\n        FC[Flight Controller<br/>MAVLink Source]:::droneNode\n        \n        subgraph DRONE_CRYPTO [\"drone_camellia.py Process\"]\n            D_LISTEN[Listen Thread<br/>Port 5820<br/>Plaintext Telemetry]:::droneNode\n            \n            subgraph D_ENC_PROCESS [\"Camellia Encryption Process\"]\n                D_IV[Generate Random IV<br/>16 bytes random<br/>CBC Mode Initialization]:::cryptoOp\n                D_PAD[PKCS7 Padding<br/>Pad to 128-bit blocks<br/>ISO/IEC 18033-3 Standard]:::cryptoOp\n                D_CAMELLIA_ENC[Camellia-128 Encrypt<br/>Key: 16-byte PSK<br/>Mode: CBC<br/>Block Size: 128 bits]:::cryptoOp\n                D_FRAME_ENC[Frame Output<br/>IV || Ciphertext<br/>Total: 16 + encrypted_length]:::cryptoOp\n            end\n            \n            D_SEND[Send Thread<br/>Port 5821<br/>Encrypted Telemetry]:::droneNode\n            \n            D_RECV[Receive Thread<br/>Port 5811<br/>Encrypted Commands]:::droneNode\n            \n            subgraph D_DEC_PROCESS [\"Camellia Decryption Process\"]\n                D_SPLIT[Split Frame<br/>Extract: IV (16 bytes)<br/>Extract: Ciphertext (remainder)]:::cryptoOp\n                D_CAMELLIA_DEC[Camellia-128 Decrypt<br/>Key: 16-byte PSK<br/>Mode: CBC<br/>IV: Extracted IV]:::cryptoOp\n                D_UNPAD[Remove PKCS7 Padding<br/>Validate padding<br/>Extract original message]:::cryptoOp\n            end\n            \n            D_FORWARD[Forward Thread<br/>Port 5812<br/>Decrypted Commands]:::droneNode\n        end\n    end\n\n    subgraph NETWORK [\"üåê Network Layer\"]\n        P5820[Port 5820<br/>Drone Plaintext TLM]:::portNode\n        P5821[Port 5821<br/>GCS Encrypted TLM]:::portNode\n        P5810[Port 5810<br/>GCS Plaintext CMD]:::portNode\n        P5811[Port 5811<br/>Drone Encrypted CMD]:::portNode\n        P5812[Port 5812<br/>Drone Decrypted CMD]:::portNode\n        P5822[Port 5822<br/>GCS Decrypted TLM]:::portNode\n    end\n\n    subgraph GCS_SIDE [\"üñ•Ô∏è GCS SIDE - Camellia-128 Implementation\"]\n        GCS_APP[GCS Application<br/>MAVLink Destination]:::gcsNode\n        \n        subgraph GCS_CRYPTO [\"gcs_camellia.py Process\"]\n            G_LISTEN_TLM[Listen Thread<br/>Port 5821<br/>Encrypted Telemetry]:::gcsNode\n            \n            subgraph G_DEC_PROCESS [\"Camellia Decryption Process\"]\n                G_SPLIT[Split Frame<br/>Extract: IV (16 bytes)<br/>Extract: Ciphertext (remainder)]:::cryptoOp\n                G_CAMELLIA_DEC[Camellia-128 Decrypt<br/>Key: 16-byte PSK<br/>Mode: CBC<br/>IV: Extracted IV]:::cryptoOp\n                G_UNPAD[Remove PKCS7 Padding<br/>Validate padding<br/>Extract original message]:::cryptoOp\n            end\n            \n            G_FORWARD_TLM[Forward Thread<br/>Port 5822<br/>Decrypted Telemetry]:::gcsNode\n            \n            G_LISTEN_CMD[Listen Thread<br/>Port 5810<br/>Plaintext Commands]:::gcsNode\n            \n            subgraph G_ENC_PROCESS [\"Camellia Encryption Process\"]\n                G_IV[Generate Random IV<br/>16 bytes random<br/>CBC Mode Initialization]:::cryptoOp\n                G_PAD[PKCS7 Padding<br/>Pad to 128-bit blocks<br/>ISO/IEC 18033-3 Standard]:::cryptoOp\n                G_CAMELLIA_ENC[Camellia-128 Encrypt<br/>Key: 16-byte PSK<br/>Mode: CBC<br/>Block Size: 128 bits]:::cryptoOp\n                G_FRAME_ENC[Frame Output<br/>IV || Ciphertext<br/>Total: 16 + encrypted_length]:::cryptoOp\n            end\n            \n            G_SEND[Send Thread<br/>Port 5811<br/>Encrypted Commands]:::gcsNode\n        end\n    end\n\n    %% Data Flow - Telemetry Path (Drone ‚Üí GCS)\n    FC -->|MAVLink Telemetry| P5820\n    P5820 --> D_LISTEN\n    D_LISTEN --> D_IV\n    D_IV --> D_PAD\n    D_PAD --> D_CAMELLIA_ENC\n    D_CAMELLIA_ENC --> D_FRAME_ENC\n    D_FRAME_ENC --> D_SEND\n    D_SEND -->|UDP Encrypted| P5821\n    P5821 --> G_LISTEN_TLM\n    G_LISTEN_TLM --> G_SPLIT\n    G_SPLIT --> G_CAMELLIA_DEC\n    G_CAMELLIA_DEC --> G_UNPAD\n    G_UNPAD --> G_FORWARD_TLM\n    G_FORWARD_TLM -->|MAVLink Telemetry| P5822\n    P5822 --> GCS_APP\n\n    %% Data Flow - Command Path (GCS ‚Üí Drone)\n    GCS_APP -->|MAVLink Commands| P5810\n    P5810 --> G_LISTEN_CMD\n    G_LISTEN_CMD --> G_IV\n    G_IV --> G_PAD\n    G_PAD --> G_CAMELLIA_ENC\n    G_CAMELLIA_ENC --> G_FRAME_ENC\n    G_FRAME_ENC --> G_SEND\n    G_SEND -->|UDP Encrypted| P5811\n    P5811 --> D_RECV\n    D_RECV --> D_SPLIT\n    D_SPLIT --> D_CAMELLIA_DEC\n    D_CAMELLIA_DEC --> D_UNPAD\n    D_UNPAD --> D_FORWARD\n    D_FORWARD -->|MAVLink Commands| P5812\n    P5812 --> FC\n\n    %% Algorithm Details\n    subgraph ALGO_DETAILS [\"üìã Camellia-128 Algorithm Details\"]\n        SPECS[\"üîê Camellia-128 Specifications<br/>‚Ä¢ Type: Symmetric Block Cipher<br/>‚Ä¢ Key Size: 128 bits (16 bytes)<br/>‚Ä¢ Block Size: 128 bits (16 bytes)<br/>‚Ä¢ Mode: CBC (Cipher Block Chaining)<br/>‚Ä¢ IV Size: 128 bits (16 bytes)<br/>‚Ä¢ Standard: ISO/IEC 18033-3, RFC 3713<br/>‚Ä¢ Variant: Camellia-128 (c3 in research paper)\"]:::dataFlow\n        \n        IMPL[\"‚öôÔ∏è Implementation Details<br/>‚Ä¢ Library: drneha.camellia (custom implementation)<br/>‚Ä¢ Pre-shared Key: Research-specific PSK<br/>‚Ä¢ Padding: PKCS7 (pycryptodome)<br/>‚Ä¢ Frame Format: [16-byte IV][padded_ciphertext]<br/>‚Ä¢ Error Handling: Exception on decrypt failure<br/>‚Ä¢ Thread Safety: Separate cipher instances\"]:::dataFlow\n        \n        SECURITY[\"üõ°Ô∏è Security Properties<br/>‚Ä¢ International Standard: ISO/IEC approved<br/>‚Ä¢ Strong Security: 128-bit key strength<br/>‚Ä¢ CBC Mode: Requires proper IV handling<br/>‚Ä¢ Padding: PKCS7 standard padding<br/>‚Ä¢ Research Context: PSK acceptable for testing\"]:::cryptoOp\n    end\n",
  "content_size": 6079,
  "collected_at": "2026-02-06T14:06:13.376303",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] Á≥ªÁªüÊâæ‰∏çÂà∞ÊåáÂÆöÁöÑÊñá‰ª∂„ÄÇ",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com"
}