{
  "id": "gl_block-beta_00311",
  "source": "gitlab",
  "source_url": "https://github.com/Dera301/projet_stage/blob/3ff0a1769dda7d9425e28b8bee7835e0dc5879b4/diagramme/UC14_EchangerMessages_ClasseConception.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "Dera301/projet_stage",
  "diagram_type": "block-beta",
  "code": "classDiagram\r\n    %% Titre: UC14 - Échanger Messages - Diagramme de Classe de Conception\r\n    \r\n    class User {\r\n        <<entity>>\r\n        -id: Int\r\n        -email: String\r\n        -firstName: String\r\n        -lastName: String\r\n        -userType: UserType\r\n        -phone: String?\r\n        --\r\n        +sendMessage(recipientId, content): void\r\n        +readMessage(messageId): void\r\n    }\r\n\r\n    class Student {\r\n        <<entity>>\r\n        --\r\n        +messageOwner(ownerId, content): void\r\n        +viewConversations(): void\r\n    }\r\n\r\n    class Owner {\r\n        <<entity>>\r\n        --\r\n        +messageStudent(studentId, content): void\r\n        +replyToStudent(messageId, content): void\r\n    }\r\n\r\n    class Admin {\r\n        <<entity>>\r\n        --\r\n    }\r\n\r\n    class UserType {\r\n        <<enumeration>>\r\n        STUDENT\r\n        OWNER\r\n        ADMIN\r\n    }\r\n\r\n    class Boundary_Messaging {\r\n        <<boundary>>\r\n        -conversationsList: Component\r\n        -messageThread: Component\r\n        -inputBox: Component\r\n        -notificationBadge: Component\r\n        --\r\n        +displayConversationList(conversations): void\r\n        +displayMessageThread(conversation): void\r\n        +displayMessageInput(): void\r\n        +onSendMessage(content): void\r\n        +onReadConversation(conversationId): void\r\n        +onMarkAsRead(messageId): void\r\n        +onDeleteConversation(conversationId): void\r\n    }\r\n\r\n    class MessagingController {\r\n        <<control>>\r\n        -conversationRepository: ConversationRepository\r\n        -messageRepository: MessageRepository\r\n        -userRepository: UserRepository\r\n        -validationService: ValidationService\r\n        -encryptionService: EncryptionService\r\n        -notificationService: NotificationService\r\n        --\r\n        +getConversations(userId): List\r\n        +getConversationMessages(conversationId, userId): List\r\n        +sendMessage(senderId, recipientId, content): Message\r\n        +markMessageAsRead(messageId): void\r\n        +deleteConversation(conversationId, userId): void\r\n        +searchMessages(conversationId, query): List\r\n    }\r\n\r\n    class Conversation {\r\n        <<entity>>\r\n        -id: Int\r\n        -user1Id: Int\r\n        -user2Id: Int\r\n        -unreadCount: Int\r\n        -lastMessageAt: DateTime\r\n        -createdAt: DateTime\r\n        --\r\n        +getOtherUser(userId): Int\r\n        +incrementUnreadCount(): void\r\n        +resetUnreadCount(): void\r\n        +getPreview(): String\r\n    }\r\n\r\n    class Message {\r\n        <<entity>>\r\n        -id: Int\r\n        -conversationId: Int\r\n        -senderId: Int\r\n        -receiverId: Int\r\n        -content: String\r\n        -isRead: Boolean\r\n        -readAt: DateTime?\r\n        -createdAt: DateTime\r\n        -updatedAt: DateTime\r\n        --\r\n        +markAsRead(): void\r\n        +canBeDeleted(): Boolean\r\n        +canBeEdited(): Boolean\r\n    }\r\n\r\n    class ConversationRepository {\r\n        <<service>>\r\n        --\r\n        +findByUsers(userId1, userId2): Conversation?\r\n        +createOrGet(userId1, userId2): Conversation\r\n        +findAllByUser(userId): List\r\n        +delete(conversationId, userId): void\r\n        +getUnreadConversations(userId): List\r\n    }\r\n\r\n    class MessageRepository {\r\n        <<service>>\r\n        --\r\n        +create(message): Message\r\n        +findByConversation(conversationId, limit): List\r\n        +findById(messageId): Message\r\n        +findUnreadByUser(userId): List\r\n        +markAsRead(messageId): void\r\n        +searchInConversation(conversationId, query): List\r\n    }\r\n\r\n    class UserRepository {\r\n        <<service>>\r\n        --\r\n        +findById(id): User\r\n        +findByEmail(email): User?\r\n    }\r\n\r\n    class ValidatedMessage {\r\n        <<entity>>\r\n        -content: String\r\n        -isSpam: Boolean\r\n        -wordCount: Int\r\n        -hasLinks: Boolean\r\n        --\r\n        +isValid(): Boolean\r\n        +getSafeContent(): String\r\n    }\r\n\r\n    class ValidationService {\r\n        <<service>>\r\n        -maxMessageLength: Int\r\n        -minMessageLength: Int\r\n        --\r\n        +validateMessage(content): ValidatedMessage\r\n        +validateRecipient(recipientId): Boolean\r\n        +checkBlockedUsers(senderId, recipientId): Boolean\r\n        +checkMessageRate(userId): Boolean\r\n        +filterSpamKeywords(content): String\r\n    }\r\n\r\n    class EncryptionService {\r\n        <<service>>\r\n        --\r\n        +encryptMessage(content): String\r\n        +decryptMessage(encrypted): String\r\n        +hashMessage(content): String\r\n    }\r\n\r\n    class NotificationService {\r\n        <<service>>\r\n        --\r\n        +notifyNewMessage(userId, message): void\r\n        +sendInAppNotification(userId, message): void\r\n        +sendEmailNotification(userId, message): void\r\n        +notifyUnreadCount(userId): void\r\n    }\r\n\r\n    class MessageMetadata {\r\n        <<entity>>\r\n        -messageId: Int\r\n        -deliveredAt: DateTime?\r\n        -readAt: DateTime?\r\n        -editedAt: DateTime?\r\n        -deletedAt: DateTime?\r\n        --\r\n    }\r\n\r\n    class BlockedUser {\r\n        <<entity>>\r\n        -blockerId: Int\r\n        -blockedUserId: Int\r\n        -reason: String?\r\n        -blockedAt: DateTime\r\n        --\r\n    }\r\n\r\n    %% Relationships\r\n    User \"1\" --> \"1\" UserType : has\r\n    Student --|> User : extends\r\n    Owner --|> User : extends\r\n    Admin --|> User : extends\r\n    \r\n    Boundary_Messaging ..> MessagingController : uses\r\n    MessagingController ..> ConversationRepository : queries/creates\r\n    MessagingController ..> MessageRepository : creates/reads\r\n    MessagingController ..> UserRepository : queries\r\n    MessagingController ..> ValidationService : validates\r\n    MessagingController ..> EncryptionService : encrypts\r\n    MessagingController ..> NotificationService : notifies\r\n    \r\n    Message \"1\" --> \"1\" Conversation : in\r\n    Message \"1\" --> \"1\" User : from_sender\r\n    Message \"1\" --> \"1\" User : to_receiver\r\n    \r\n    Conversation \"2\" --> \"1\" User : involves\r\n    Conversation \"1\" --> \"*\" Message : contains\r\n    \r\n    Message \"1\" --> \"1\" MessageMetadata : has\r\n    ValidationService --> ValidatedMessage : produces\r\n",
  "content_size": 6081,
  "collected_at": "2026-02-06T14:06:56.389214",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 1,
  "repo_forks": 0,
  "repo_owner": "Dera301",
  "repo_name": "projet_stage",
  "repo_description": "Application location immobilier",
  "repo_language": "TypeScript",
  "repo_topics": [],
  "repo_created_at": "2025-10-07T07:20:19Z",
  "repo_updated_at": "2026-01-14T19:25:01Z",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}