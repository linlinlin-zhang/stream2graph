{
  "id": "gl_flowchart_00621",
  "source": "gitlab",
  "source_url": "https://github.com/JPP-J/nlp1-spacy/blob/7af74b39f4f66402eeb67159e37c951862c2f349/Diagram.mmd",
  "source_note": "collected_from_github_final",
  "github_repo": "JPP-J/nlp1-spacy",
  "diagram_type": "flowchart",
  "code": "flowchart TD\n subgraph subGraph0[\"Phase 1: Initial AWS Infrastructure Setup (One-time)\"]\n        A2[\"Create Internet Gateway\"]\n        A1[\"Create VPC & Subnets\"]\n        A3[\"Create Route Tables\"]\n        A4[\"Create Security Groups\"]\n        A5[\"Create Application Load Balancer\"]\n        A6[\"Create Target Group\"]\n        A7[\"Create ECR Repository\"]\n        A8[\"Create ECS Cluster\"]\n        A9[\"Create IAM Roles\"]\n        A10[\"Create CloudWatch Log Group\"]\n  end\n subgraph subGraph1[\"Phase 2: Task Definition & Service Setup\"]\n        B2[\"Build Placeholder Image\"]\n        B1[\"Create task-definition.json\"]\n        B3[\"Push Placeholder to ECR\"]\n        B4[\"Register Task Definition\"]\n        B5[\"Create ECS Service with ALB\"]\n        B6[\"Configure Auto Scaling\"]\n  end\n subgraph subGraph2[\"Phase 3: GitHub Actions Setup\"]\n        C2[\"Create deploy.yml workflow\"]\n        C1[\"Set GitHub Secrets\"]\n        C3[\"Create ci.yml workflow\"]\n        C4[\"Test GitHub Actions\"]\n  end\n subgraph subGraph3[\"Phase 4: CI/CD Process (Automated)\"]\n        D2{\"Branch Check\"}\n        D1[\"Developer Push Code\"]\n        D3[\"GitHub Actions Trigger\"]\n        D4[\"Run CI Tests Only\"]\n        D5[\"Checkout Code\"]\n        D6[\"Setup Python & Install Dependencies\"]\n        D7[\"Run Tests & Linting\"]\n        D8{\"Tests Pass?\"}\n        D9[\"❌ Stop Deployment\"]\n        D10[\"Configure AWS Credentials\"]\n        D11[\"Login to ECR\"]\n        D12[\"Build Docker Image\"]\n        D13[\"Tag with Git SHA\"]\n        D14[\"Push to ECR\"]\n        D15[\"Update Task Definition JSON\"]\n        D16[\"Register New Task Definition\"]\n        D17[\"Update ECS Service\"]\n        D18[\"Wait for Service Stability\"]\n        D19[\"Health Check via ALB\"]\n        D20[\"✅ Deployment Complete\"]\n  end\n subgraph subGraph4[\"Detailed AWS Components\"]\n        E1[\"VPC: 10.0.0.0/16\"]\n        E2[\"Public Subnet 1: 10.0.1.0/24\"]\n        E3[\"Public Subnet 2: 10.0.2.0/24\"]\n        E4[\"Private Subnet 1: 10.0.3.0/24\"]\n        E5[\"Private Subnet 2: 10.0.4.0/24\"]\n        F1[\"ALB Security Group: Port 80/443\"]\n        F2[\"ECS Security Group: Port 8000\"]\n        F3[\"Application Load Balancer\"]\n        F4[\"Target Group: HTTP:8000\"]\n        F5[\"Listener: HTTP:80 → Target Group\"]\n        G1[\"ECR Repository: fastapi-app\"]\n        G2[\"ECS Cluster: fastapi-cluster\"]\n        G3[\"ECS Service: fastapi-service\"]\n        G4[\"Fargate Tasks: 1-10 instances\"]\n        H1[\"ecsTaskExecutionRole\"]\n        H2[\"ecsTaskRole\"]\n        H3[\"CloudWatch Log Group: /ecs/fastapi-task\"]\n        H4[\"Auto Scaling Target\"]\n        H5[\"Auto Scaling Policy\"]\n  end\n subgraph subGraph5[\"GitHub Repository Structure\"]\n        I1[\"main.py - FastAPI app\"]\n        I2[\"requirements.txt\"]\n        I3[\"Dockerfile\"]\n        I4[\"task-definition.json\"]\n        I5[\".github/workflows/deploy.yml\"]\n        I6[\".github/workflows/ci.yml\"]\n        I7[\".dockerignore\"]\n        I8[\"tests/\"]\n  end\n subgraph subGraph6[\"Traffic Flow\"]\n        J2[\"Application Load Balancer\"]\n        J1[\"Internet Users\"]\n        J3[\"Target Group Health Check\"]\n        J4[\"Fargate Tasks: Port 8000\"]\n        J5[\"FastAPI Application\"]\n  end\n    A1 --> A2\n    A2 --> A3\n    A3 --> A4\n    A4 --> A5 & F1 & F2\n    A5 --> A6 & F3\n    A6 --> A7 & F4\n    A7 --> A8 & G1\n    A8 --> A9 & G2\n    A9 --> A10 & H1 & H2\n    B1 --> B2\n    B2 --> B3\n    B3 --> B4\n    B4 --> B5\n    B5 --> B6 & G3\n    C1 --> C2\n    C2 --> C3\n    C3 --> C4\n    D1 --> D2\n    D2 -- main --> D3\n    D2 -- other --> D4\n    D3 --> D5\n    D5 --> D6\n    D6 --> D7\n    D7 --> D8\n    D8 -- No --> D9\n    D8 -- Yes --> D10\n    D10 --> D11\n    D11 --> D12\n    D12 --> D13\n    D13 --> D14\n    D14 --> D15 & G1\n    D15 --> D16\n    D16 --> D17\n    D17 --> D18 & G3\n    D18 --> D19\n    D19 --> D20\n    J1 --> J2\n    J2 --> J3\n    J3 --> J4\n    J4 --> J5\n    A10 --> B1 & H3\n    B6 --> C1 & H4\n    C4 --> D1\n    F3 --> F5 & J2\n    G3 --> G4\n    H4 --> H5\n    F4 --> J3\n    G4 --> J4\n    style A1 fill:#fff3e0\n    style A10 fill:#fff3e0\n    style B1 fill:#e3f2fd\n    style B6 fill:#e3f2fd\n    style C1 fill:#f3e5f5\n    style C4 fill:#f3e5f5\n    style D1 fill:#e8f5e8\n    style D9 fill:#ffcdd2\n    style D20 fill:#c8e6c9\n    style E1 fill:#e1f5fe\n    style F3 fill:#e1f5fe\n    style G2 fill:#e1f5fe\n    style H1 fill:#e1f5fe\n    style subGraph0 fill:#FFF9C4\n    style subGraph4 fill:#FFF9C4\n    style subGraph1 fill:#FFF9C4\n    style subGraph2 fill:#C8E6C9\n    style subGraph3 fill:#C8E6C9\n",
  "content_size": 4402,
  "collected_at": "2026-02-06T14:18:06.708526",
  "compilation_status": "failed",
  "license": "gitlab_repo",
  "license_name": "GitLab Repository",
  "license_url": "https://gitlab.com",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}