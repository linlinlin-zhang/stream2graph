{
  "id": "gh_class_01149",
  "source": "github",
  "source_url": "https://github.com/LiquidIce95/Quant_Data_Platform/blob/5665059ba47a787e8e0eefa414759b77949adae9/services_streaming_lane/ib_connector/source/architecture.mmd",
  "github_repo": "LiquidIce95/Quant_Data_Platform",
  "github_file_path": "services_streaming_lane/ib_connector/source/architecture.mmd",
  "diagram_type": "class",
  "code": "classDiagram\n    direction LR\n\n    class EndPoints {\n      <<enum>>\n      +Tickle\n      +AuthStatus\n      +FuturesContractNG\n      +FuturesContractCL\n      +tbtTopic\n      +l2Topic\n    }\n\n    class Status {\n      <<enum>>\n      +Online\n      +Offline\n    }\n\n    class RoundRobin~E,S~ {\n      +entityNames: Vector~E~\n      +symbolNames: Vector~S~\n      -stateMap: Map~E,Status~\n      -entityMap: Map~E,Vector~S~~\n      +initEntityMap(): Unit\n      +onEntityLost(e:E,online:Vector~E~): Unit\n      +onEntityWon(e:E): Unit\n      +apply(online:Vector~E~): Map~E,Vector~S~~\n    }\n\n    class ApiHandler {\n      <<trait>>\n      +numberOfFrontMonths: Int\n      +baseUrl: String\n      +webSocketUrl: String\n      +symbolUniverse: Vector~(Long,String,String)~\n      -sessionCookieOpt: Option~String~\n      -portalOutput: StringBuilder\n      -portalLogger: ProcessLogger\n      -portalProcFuture: Future~Unit~\n      +endpointsMap: Map~EndPoints,Request[String]~\n      +subscribetbt(conId:String,ws:Option~SyncWebSocket~): Unit\n      +unsubscribetbt(conId:String,ws:Option~SyncWebSocket~): Unit\n      +subscribeL2(accId:String,conId:String,ws:Option~SyncWebSocket~): Unit\n      +unsubscribeL2(accId:String,conId:String,ws:Option~SyncWebSocket~): Unit\n      -fetchAndStoreCookie(): Unit\n      +establishWebSocket(): SyncWebSocket\n      +computeSymbolUniverse(): Vector~(Long,String,String)~\n      -hasFatalErrorInLogs: Boolean\n      +computeUser(): Int\n      +isHealthy(): Boolean\n      +startIbPortal(): Boolean\n      +authenticate(userId:Int): Boolean\n      +startPortalLifeCycleManagement(): Unit\n      +startApi(): Unit\n    }\n\n    class KafkaProducerApi {\n      -producer: KafkaProducer[String,String]\n      +symbolUniverse: Vector~(Long,String,String)~\n      +partitionIndices: Map~Long,Int~\n      +partitionSizes: Map~String,Int~\n      +send(topic:String,key:Long,value:String): Future~RecordMetadata~\n      +flush(): Unit\n      +close(): Unit\n    }\n\n    class SmdProcessor {\n      -producerApi: KafkaProducerApi\n      -api: ApiHandler\n      +symbolUniverse: Vector~(Long,String,String)~\n      -conidToCode: Map~Long,String~\n      -stateByConId: Map~Long,TickState~\n      -topic: String\n      -valueAsString(v:Value): String\n      +apply(msg:LinkedHashMap[String,Value]): Unit\n    }\n\n    class KubernetesApiHandler {\n      <<object>>\n      +myPodName: String\n      +myPodNamespace: String\n      +getPeers(): Vector~Pod~\n      +getHealthyPeers(): Vector~Pod~\n      +getOfflinePeers(): Vector~Pod~\n      +getPodName(pod:Pod): String\n      +getThisPodName(): String\n      +getThisNameSpace(): String\n    }\n\n    class ConnectionManager {\n      <<abstract>>\n      -api: ApiHandler\n      +symbolShards: Map~String,Vector~(Long,String,String)~~\n      +symbolUniverse: Vector~(Long,String,String)~\n      +podIdentity: String\n      +computeShards(): Map~String,Vector~(Long,String,String)~~\n      +determinePodIdentity(): String\n      +apply(ws:SyncWebSocket): Unit\n    }\n\n    class StreamManager {\n      <<abstract>>\n      -api: ApiHandler\n      -webSocket: SyncWebSocket\n      -heartBeatTimestamp: Long\n      +connectionsLifeCycleManagement(): Unit\n      +onSmdFrame(msg:LinkedHashMap[String,Value]): Unit\n      +onSbdFrame(msg:LinkedHashMap[String,Value]): Unit\n      +socketLifeCycleManagement(dt:Long): Unit\n      +startReader(): Unit\n      +startStream(): Unit\n    }\n\n\n    %% Relationships\n\n    ApiHandler ..> EndPoints : uses\n    ApiHandler ..> SyncWebSocket : establishes\n\n    RoundRobin ..> Status : uses\n\n    KafkaProducerApi --> ApiHandler : api\n    SmdProcessor --> KafkaProducerApi : producerApi\n    SmdProcessor --> ApiHandler : api\n\n    ConnectionManager --> ApiHandler : api\n    ConnectionManager ..> RoundRobin : uses\n    ConnectionManager ..> KubernetesApiHandler : uses\n\n    StreamManager --> ApiHandler : api\n    StreamManager --> SmdProcessor: uses\n    StreamManager --> ConnectionManager: uses\n    StreamManager o--> SyncWebSocket : manages\n\n    KubernetesApiHandler ..> Pod : fabric8 model\n\n",
  "content_size": 3996,
  "collected_at": "2026-02-06T01:53:40.487353",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0
}