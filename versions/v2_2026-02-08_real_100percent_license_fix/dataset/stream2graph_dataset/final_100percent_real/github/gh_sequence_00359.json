{
  "id": "gh_sequence_00359",
  "source": "github",
  "source_url": "https://github.com/Yssnogood/social-network/blob/03a7698f74480173829b46e7f0140adf156b4fbd/Documentation/Diagramme/Diagramme_S%C3%A9quence_Groupes_%C3%89v%C3%A9nements.mmd",
  "github_repo": "Yssnogood/social-network",
  "github_file_path": "Documentation/Diagramme/Diagramme_Séquence_Groupes_Événements.mmd",
  "diagram_type": "sequence",
  "code": "sequenceDiagram\n    participant Client1 as Client Créateur\n    participant Client2 as Client Membre\n    participant Client3 as Client Invité\n    participant API as API REST\n    participant GS as GroupService\n    participant ES as EventService\n    participant GR as GroupRepository\n    participant GMR as GroupMemberRepository\n    participant ER as EventRepository\n    participant EOR as EventOptionRepository\n    participant ERR as EventResponseRepository\n    participant NS as NotificationService\n    participant WSM as WebSocketManager\n    participant DB as Base de données SQLite\n\n    %% Phase 1: Création d'un groupe\n    Client1->>API: POST /api/groups (title, description)\n    API->>GS: CreateGroup(creatorId, title, description)\n    GS->>GR: Create(group)\n    GR->>DB: INSERT INTO groups\n    DB-->>GR: group_id\n    GR-->>GS: Created Group\n    \n    GS->>GMR: AddMember(groupId, creatorId, isAccepted: true)\n    GMR->>DB: INSERT INTO group_members\n    GS-->>API: Groupe créé\n    API-->>Client1: 201 Created (group)\n\n    %% Phase 2: Invitation d'un membre\n    Client1->>API: POST /api/groups/{group_id}/invitations (user_id)\n    API->>GS: InviteToGroup(groupId, inviterId, inviteeId)\n    GS->>GR: GetByID(groupId)\n    GR->>DB: SELECT FROM groups WHERE id = ?\n    DB-->>GR: Group\n    GR-->>GS: Group\n    \n    GS->>GMR: IsGroupMember(inviterId, groupId)\n    GMR->>DB: SELECT FROM group_members WHERE group_id = ? AND user_id = ? AND is_accepted = true\n    DB-->>GMR: Membership (true)\n    GMR-->>GS: true\n    \n    GS->>GMR: AddMember(groupId, inviteeId, isAccepted: false)\n    GMR->>DB: INSERT INTO group_members (group_id, user_id, is_accepted) VALUES (?, ?, false)\n    \n    GS->>NS: CreateNotification(inviteeId, GROUP_INVITATION_TYPE, groupId)\n    NS->>DB: INSERT INTO notifications\n    NS->>WSM: BroadcastToUser(inviteeId, notification)\n    WSM->>Client3: WS: {\"type\": \"notification\", \"payload\": {...}}\n    \n    GS-->>API: Invitation envoyée\n    API-->>Client1: 200 OK\n\n    %% Phase 3: Acceptation d'invitation\n    Client3->>API: POST /api/groups/invitations/{membership_id}/accept\n    API->>GS: AcceptGroupInvitation(membershipId)\n    GS->>GMR: GetByID(membershipId)\n    GMR->>DB: SELECT FROM group_members WHERE id = ?\n    DB-->>GMR: GroupMember\n    GMR-->>GS: GroupMember\n    \n    GS->>GMR: AcceptInvitation(membershipId)\n    GMR->>DB: UPDATE group_members SET is_accepted = true WHERE id = ?\n    \n    GS->>GR: GetByID(groupId)\n    GR->>DB: SELECT FROM groups WHERE id = ?\n    DB-->>GR: Group\n    GR-->>GS: Group\n    \n    GS->>NS: CreateNotification(group.creatorId, GROUP_JOIN_TYPE, inviteeId)\n    NS->>DB: INSERT INTO notifications\n    NS->>WSM: BroadcastToUser(group.creatorId, notification)\n    WSM->>Client1: WS: {\"type\": \"notification\", \"payload\": {...}}\n    \n    GS-->>API: Invitation acceptée\n    API-->>Client3: 200 OK\n\n    %% Phase 4: Demande de rejoindre un groupe\n    Client2->>API: POST /api/groups/{group_id}/join-requests\n    API->>GS: RequestJoinGroup(groupId, userId)\n    GS->>GR: GetByID(groupId)\n    GR->>DB: SELECT FROM groups WHERE id = ?\n    DB-->>GR: Group (avec creator_id)\n    GR-->>GS: Group\n    \n    GS->>GMR: AddMember(groupId, userId, isAccepted: false)\n    GMR->>DB: INSERT INTO group_members (group_id, user_id, is_accepted) VALUES (?, ?, false)\n    \n    GS->>NS: CreateNotification(group.creatorId, GROUP_JOIN_REQUEST_TYPE, userId, groupId)\n    NS->>DB: INSERT INTO notifications\n    NS->>WSM: BroadcastToUser(group.creatorId, notification)\n    WSM->>Client1: WS: {\"type\": \"notification\", \"payload\": {...}}\n    \n    GS-->>API: Demande envoyée\n    API-->>Client2: 202 Accepted\n\n    %% Phase 5: Acceptation d'une demande d'adhésion\n    Client1->>API: POST /api/groups/join-requests/{membership_id}/accept\n    API->>GS: AcceptJoinRequest(membershipId)\n    GS->>GMR: GetByID(membershipId)\n    GMR->>DB: SELECT FROM group_members WHERE id = ?\n    DB-->>GMR: GroupMember\n    GMR-->>GS: GroupMember\n    \n    GS->>GMR: AcceptJoinRequest(membershipId)\n    GMR->>DB: UPDATE group_members SET is_accepted = true WHERE id = ?\n    \n    GS->>NS: CreateNotification(groupMember.userId, GROUP_JOIN_ACCEPTED_TYPE, groupId)\n    NS->>DB: INSERT INTO notifications\n    NS->>WSM: BroadcastToUser(groupMember.userId, notification)\n    WSM->>Client2: WS: {\"type\": \"notification\", \"payload\": {...}}\n    \n    GS-->>API: Demande acceptée\n    API-->>Client1: 200 OK\n\n    %% Phase 6: Création d'un événement\n    Client1->>API: POST /api/groups/{group_id}/events (title, description, event_time, options[])\n    API->>ES: CreateEvent(userId, groupId, title, description, eventTime)\n    ES->>GR: GetByID(groupId)\n    GR->>DB: SELECT FROM groups WHERE id = ?\n    DB-->>GR: Group\n    GR-->>ES: Group\n    \n    ES->>GMR: IsGroupMember(userId, groupId)\n    GMR->>DB: SELECT FROM group_members WHERE group_id = ? AND user_id = ? AND is_accepted = true\n    DB-->>GMR: Membership (true)\n    GMR-->>ES: true\n    \n    ES->>ER: Create(event)\n    ER->>DB: INSERT INTO events\n    DB-->>ER: event_id\n    ER-->>ES: Created Event\n    \n    loop Pour chaque option\n        ES->>EOR: Create(eventId, optionText)\n        EOR->>DB: INSERT INTO event_options\n    end\n    \n    ES->>GMR: GetGroupMembers(groupId)\n    GMR->>DB: SELECT FROM group_members WHERE group_id = ? AND is_accepted = true\n    DB-->>GMR: Members\n    GMR-->>ES: Members\n    \n    loop Pour chaque membre (sauf le créateur)\n        ES->>NS: CreateNotification(memberId, EVENT_CREATED_TYPE, eventId)\n        NS->>DB: INSERT INTO notifications\n        NS->>WSM: BroadcastToUser(memberId, notification)\n    end\n    \n    WSM->>Client2: WS: {\"type\": \"notification\", \"payload\": {...}}\n    \n    ES-->>API: Événement créé\n    API-->>Client1: 201 Created (event)\n\n    %% Phase 7: Réponse à un événement\n    Client2->>API: POST /api/events/{event_id}/responses (option_id)\n    API->>ES: RespondToEvent(userId, eventId, optionId)\n    ES->>ER: GetByID(eventId)\n    ER->>DB: SELECT FROM events WHERE id = ?\n    DB-->>ER: Event\n    ER-->>ES: Event\n    \n    ES->>GMR: IsGroupMember(userId, event.groupId)\n    GMR->>DB: SELECT FROM group_members WHERE group_id = ? AND user_id = ? AND is_accepted = true\n    DB-->>GMR: Membership (true)\n    GMR-->>ES: true\n    \n    ES->>ERR: Create(eventId, userId, optionId)\n    ERR->>DB: INSERT INTO event_responses\n    \n    ES->>NS: CreateNotification(event.creatorId, EVENT_RESPONSE_TYPE, userId, eventId)\n    NS->>DB: INSERT INTO notifications\n    NS->>WSM: BroadcastToUser(event.creatorId, notification)\n    WSM->>Client1: WS: {\"type\": \"notification\", \"payload\": {...}}\n    \n    ES-->>API: Réponse enregistrée\n    API-->>Client2: 200 OK",
  "content_size": 6614,
  "collected_at": "2026-02-06T01:31:12.117805",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 2,
  "repo_forks": 0,
  "repo_owner": "Yssnogood",
  "repo_name": "social-network",
  "repo_description": "Social Network's project",
  "repo_language": "TypeScript",
  "repo_topics": [],
  "repo_created_at": "2025-04-28T07:48:05Z",
  "repo_updated_at": "2025-10-02T13:36:15Z",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}