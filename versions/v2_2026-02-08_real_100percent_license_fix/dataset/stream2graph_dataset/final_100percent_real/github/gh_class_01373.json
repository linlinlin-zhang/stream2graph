{
  "id": "gh_class_01373",
  "source": "github",
  "source_url": "https://github.com/urica/itschool-app/blob/9944309d4da387afa002ef05f3869b863c6b284a/jpa/src/main/resources/instrumentsDiagram.mmd",
  "github_repo": "urica/itschool-app",
  "github_file_path": "jpa/src/main/resources/instrumentsDiagram.mmd",
  "diagram_type": "class",
  "code": "classDiagram\n%% MODEL Layer\n    class Instrument {\n        <<Entity>>\n        +Long id\n        +String name\n        +BigDecimal price\n        +InstrumentCategory category\n        +String manufacturer\n        +Integer stockQuantity\n        -List~Review~ reviews\n        +boolean isAvailable()\n        +BigDecimal calculateDiscountedPrice()\n    }\n\n    class User {\n        <<Entity>>\n        +Long id\n        +String username\n        +String email\n        +String password\n        +UserRole role\n        -List~Order~ orders\n        +void updateProfile()\n        +boolean isAccountNonExpired()\n    }\n\n    class Order {\n        <<Entity>>\n        +Long id\n        +User user\n        +List~OrderItem~ items\n        +OrderStatus status\n        +BigDecimal totalAmount\n        +LocalDateTime orderDate\n        +void calculateTotalPrice()\n        +void updateStatus()\n    }\n\n    class Review {\n        <<Entity>>\n        +Long id\n        +User author\n        +Instrument instrument\n        +Integer rating\n        +String comment\n        +LocalDateTime reviewDate\n    }\n\n%% REPOSITORY Layer\n    class InstrumentRepository {\n        <<Interface>>\n        +List~Instrument~ findByCategory(InstrumentCategory category)\n        +List~Instrument~ findByPriceBetween(BigDecimal minPrice, BigDecimal maxPrice)\n        +List~Instrument~ findByStockQuantityGreaterThan(Integer quantity)\n    }\n\n    class UserRepository {\n        <<Interface>>\n        +Optional~User~ findByUsername(String username)\n        +Optional~User~ findByEmail(String email)\n        +boolean existsByUsername(String username)\n    }\n\n    class OrderRepository {\n        <<Interface>>\n        +List~Order~ findByUser(User user)\n        +List~Order~ findByStatus(OrderStatus status)\n    }\n\n    class ReviewRepository {\n        <<Interface>>\n        +List~Review~ findByInstrument(Instrument instrument)\n        +List~Review~ findByAuthor(User author)\n    }\n\n%% SERVICE Layer\n    class InstrumentService {\n        <<Service>>\n        -InstrumentRepository instrumentRepository\n        +List~Instrument~ getAllInstruments()\n        +Instrument getInstrumentById(Long id)\n        +Instrument createInstrument(Instrument instrument)\n        +void updateInstrumentStock(Long id, Integer quantity)\n    }\n\n    class UserService {\n        <<Service>>\n        -UserRepository userRepository\n        -PasswordEncoder passwordEncoder\n        +User registerNewUser(User user)\n        +User authenticateUser(String username, String password)\n        +void updateUserProfile(User user)\n    }\n\n    class OrderService {\n        <<Service>>\n        -OrderRepository orderRepository\n        -InstrumentService instrumentService\n        +Order createOrder(User user, List~OrderItem~ items)\n        +void processPayment(Order order)\n        +void updateOrderStatus(Long orderId, OrderStatus status)\n    }\n\n    class ReviewService {\n        <<Service>>\n        -ReviewRepository reviewRepository\n        -InstrumentService instrumentService\n        +Review addReview(User author, Long instrumentId, Review review)\n        +List~Review~ getReviewsForInstrument(Long instrumentId)\n    }\n\n%% CONTROLLER Layer\n    class InstrumentController {\n        <<RestController>>\n        -InstrumentService instrumentService\n        +ResponseEntity~List~Instrument~~ getAllInstruments()\n        +ResponseEntity~Instrument~ getInstrumentById(Long id)\n        +ResponseEntity~Instrument~ createInstrument(Instrument instrument)\n    }\n\n    class UserController {\n        <<RestController>>\n        -UserService userService\n        +ResponseEntity~User~ registerUser(User user)\n        +ResponseEntity~String~ login(LoginRequest loginRequest)\n        +ResponseEntity~User~ updateProfile(User user)\n    }\n\n    class OrderController {\n        <<RestController>>\n        -OrderService orderService\n        +ResponseEntity~Order~ createOrder(OrderRequest orderRequest)\n        +ResponseEntity~List~Order~~ getUserOrders()\n        +ResponseEntity~Order~ updateOrderStatus(Long orderId, OrderStatus status)\n    }\n\n    class ReviewController {\n        <<RestController>>\n        -ReviewService reviewService\n        +ResponseEntity~Review~ addReview(Long instrumentId, Review review)\n        +ResponseEntity~List~Review~~ getInstrumentReviews(Long instrumentId)\n    }\n\n%% Security Configuration\n    class SecurityConfig {\n        <<Configuration>>\n        +void configure(HttpSecurity http)\n        +UserDetailsService userDetailsService()\n        +PasswordEncoder passwordEncoder()\n    }\n\n%% Enums\n    class InstrumentCategory {\n        <<Enumeration>>\n        STRINGS,\n        WIND,\n        PERCUSSION,\n        KEYBOARD\n    }\n\n    class OrderStatus {\n        <<Enumeration>>\n        PENDING\n        PROCESSING\n        SHIPPED\n        DELIVERED\n        CANCELLED\n    }\n\n%% Relationships\n    User \"1\" -- \"0..*\" Order : has\n    User \"1\" -- \"0..*\" Review : writes\n    Instrument \"1\" -- \"0..*\" Review : has\n    Order \"1\" -- \"1..*\" OrderItem : contains\n\n%% Layer Dependencies\n    InstrumentController ..> InstrumentService : uses\n    InstrumentService ..> InstrumentRepository : uses\n\n    UserController ..> UserService : uses\n    UserService ..> UserRepository : uses\n\n    OrderController ..> OrderService : uses\n    OrderService ..> OrderRepository : uses\n\n    ReviewController ..> ReviewService : uses\n    ReviewService ..> ReviewRepository : uses",
  "content_size": 5354,
  "collected_at": "2026-02-06T01:56:54.291080",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}