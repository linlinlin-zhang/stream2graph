{
  "id": "gh_sequence_00799",
  "source": "github",
  "source_url": "https://github.com/Drmusab/-1995/blob/e3a725fc3cd6ffd0ce73c152a672870b18936dc7/docs/architecture/sequence_diagram.mmd",
  "github_repo": "Drmusab/-1995",
  "github_file_path": "docs/architecture/sequence_diagram.mmd",
  "diagram_type": "sequence",
  "code": "```mermaid\nsequenceDiagram\n    participant User\n    participant WebUI as Web UI\n    participant RestAPI as REST API\n    participant MainApp as AI Assistant Main\n    participant CoreEngine as Core Engine\n    participant SessionManager as Session Manager\n    participant MemoryManager as Memory Manager\n    participant LLMProvider as LLM Provider\n    participant SkillExecutor as Skill Executor\n    participant EventBus as Event Bus\n    participant ErrorHandler as Error Handler\n    \n    %% Authentication & Session Setup\n    User->>WebUI: Send query: \"Plan a vacation to Japan\"\n    WebUI->>RestAPI: POST /api/v1/chat {\"message\": \"Plan a vacation to Japan\"}\n    \n    alt No session exists\n        RestAPI->>SessionManager: create_session(user_id)\n        SessionManager->>MemoryManager: initialize_session_memory()\n        MemoryManager-->>SessionManager: session_memory_ready\n        SessionManager-->>RestAPI: session_id\n    end\n    \n    %% Security & Validation\n    RestAPI->>MainApp: process_text_input(text, session_id, user_id)\n    MainApp->>EventBus: emit(MessageReceived)\n    \n    %% Core Processing Pipeline\n    MainApp->>CoreEngine: process_multimodal_input()\n    CoreEngine->>EventBus: emit(ProcessingStarted)\n    \n    %% Memory Context Retrieval\n    CoreEngine->>MemoryManager: retrieve_relevant_context(\"vacation Japan\")\n    MemoryManager->>MemoryManager: vector_search() + semantic_matching()\n    MemoryManager-->>CoreEngine: context_data [previous_trips, preferences]\n    \n    %% Natural Language Understanding\n    CoreEngine->>CoreEngine: natural_language_processing()\n    Note over CoreEngine: Extract intent: trip_planning<br/>Entities: destination=Japan<br/>User preferences analysis\n    \n    %% Reasoning & Planning\n    CoreEngine->>CoreEngine: reasoning_engine.plan_workflow()\n    Note over CoreEngine: Identify required skills:<br/>- travel_research<br/>- itinerary_planning<br/>- budget_estimation<br/>- booking_assistance\n    \n    %% Skill Execution Pipeline\n    loop For each required skill\n        CoreEngine->>SkillExecutor: execute_skill(\"travel_research\", context)\n        SkillExecutor->>LLMProvider: query_model(enhanced_prompt)\n        \n        alt LLM Request Success\n            LLMProvider-->>SkillExecutor: travel_information\n            SkillExecutor->>MemoryManager: store_intermediate_result()\n            SkillExecutor-->>CoreEngine: skill_result\n        else LLM Request Failure\n            SkillExecutor->>ErrorHandler: handle_llm_error()\n            ErrorHandler->>EventBus: emit(ProcessingError)\n            ErrorHandler-->>SkillExecutor: fallback_strategy\n            SkillExecutor-->>CoreEngine: fallback_result\n        end\n    end\n    \n    %% Response Generation & Memory Storage\n    CoreEngine->>CoreEngine: multimodal_fusion()\n    Note over CoreEngine: Combine skill results:<br/>- Destinations & attractions<br/>- Sample itinerary<br/>- Budget estimates<br/>- Next steps\n    \n    CoreEngine->>LLMProvider: generate_final_response(compiled_data)\n    LLMProvider-->>CoreEngine: formatted_response\n    \n    %% Memory Management\n    CoreEngine->>MemoryManager: store_conversation_turn()\n    CoreEngine->>MemoryManager: update_user_preferences()\n    MemoryManager->>MemoryManager: consolidate_knowledge()\n    \n    %% Response Delivery\n    CoreEngine->>EventBus: emit(ProcessingCompleted)\n    CoreEngine-->>MainApp: processing_result\n    MainApp-->>RestAPI: response_data\n    RestAPI-->>WebUI: JSON response\n    WebUI-->>User: Display vacation plan\n    \n    %% Error Handling Path\n    alt Processing Error Occurs\n        CoreEngine->>ErrorHandler: handle_processing_error()\n        ErrorHandler->>EventBus: emit(ErrorOccurred)\n        ErrorHandler->>MemoryManager: log_error_context()\n        ErrorHandler-->>MainApp: error_response\n        MainApp-->>RestAPI: error_data\n        RestAPI-->>WebUI: Error message\n        WebUI-->>User: \"I encountered an issue. Please try again.\"\n    end\n    \n    %% Background Processes\n    Note over EventBus: Async event processing\n    EventBus->>EventBus: process_analytics_events()\n    EventBus->>EventBus: update_metrics()\n    EventBus->>EventBus: trigger_learning_updates()\n```",
  "content_size": 4158,
  "collected_at": "2026-02-06T01:37:14.097374",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0
}