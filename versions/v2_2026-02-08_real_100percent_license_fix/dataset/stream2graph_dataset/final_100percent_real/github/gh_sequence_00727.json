{
  "id": "gh_sequence_00727",
  "source": "github",
  "source_url": "https://github.com/linhh011202/fyp-report/blob/02e94338c04bfbc3eb6bb6a19c19f907aa8358c3/diagrams/jwt_validation_flow.mmd",
  "github_repo": "linhh011202/fyp-report",
  "github_file_path": "diagrams/jwt_validation_flow.mmd",
  "diagram_type": "sequence",
  "code": "sequenceDiagram\n    participant Client\n    participant Guard as JwtAuthGuard\n    participant Strategy as JwtStrategy\n    participant JWT as JwtService\n    participant App as ApplicationService\n    participant User as UserService\n    participant Keys as Key Store\n\n    Client->>Guard: Request with Bearer token\n    Guard->>Strategy: Validate token\n    Strategy->>JWT: decode(token)\n    JWT-->>Strategy: {sub, aud, ...}\n    \n    alt Has audience (third-party app)\n        Strategy->>App: findById(aud)\n        App-->>Strategy: Application with Key\n        Strategy->>Keys: Get app's publicKey\n    else No audience (default)\n        Strategy->>Keys: Get default publicKey\n    end\n    \n    Keys-->>Strategy: publicKey\n    Strategy->>JWT: verify(token, publicKey)\n    \n    alt Invalid signature\n        Strategy-->>Client: 401 Unauthorized\n    end\n    \n    JWT-->>Strategy: Decoded payload\n    Strategy->>User: findById(payload.sub)\n    \n    alt User not found\n        Strategy-->>Client: 401 Unauthorized\n    end\n    \n    User-->>Strategy: User document\n    Strategy-->>Guard: User object\n    Guard-->>Client: Request proceeds\n",
  "content_size": 1123,
  "collected_at": "2026-02-06T01:36:12.971492",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}