{
  "id": "gh_sequence_00623",
  "source": "github",
  "source_url": "https://github.com/WaelOGC/OGC-NewFinity-Palstform/blob/73265edb567f3ef9cac6b118db27d5a350bfd49d/docs/mermaid/09-amy-agent/phase-9.7--amy--system-interaction.mmd",
  "github_repo": "WaelOGC/OGC-NewFinity-Palstform",
  "github_file_path": "docs/mermaid/09-amy-agent/phase-9.7--amy--system-interaction.mmd",
  "diagram_type": "sequence",
  "code": "sequenceDiagram\n\n%% Phase 9.7 - Amy AI Agent System Interaction Flow\n%% System interaction sequence\n\nautonumber\n\nparticipant U as User\nparticipant FE as Frontend\nparticipant AH as Amy Request Handler\nparticipant TR as Tool Router\nparticipant MS as Model Service\nparticipant TC as Tokens/Credits Service\nparticipant AL as Audit Logger\nparticipant NS as Notification Service\n\nU->>FE: Select tool\nFE->>AH: Send structured request<br/>(tool, input, metadata)\n\nAH->>AH: Validate metadata<br/>(auth, format, limits)\n\nalt Validation failed\n    AH-->>FE: Validation error\n    FE-->>U: Show error message\nelse Validation passed\n    AH->>TR: Route request\n    TR->>TR: Select AI model<br/>(based on tool type)\n    TR->>MS: Execute model request\n    \n    MS->>MS: Process AI request\n    MS->>TC: Check credits/tokens\n    TC-->>MS: Credits available\n    \n    MS->>MS: Execute AI model call\n    MS-->>TR: AI results\n    \n    TR->>TC: Deduct tokens/credits\n    TC->>TC: Update usage records\n    TC-->>TR: Tokens deducted\n    \n    TR->>AH: Processed results\n    AH->>AH: Store results<br/>(history, saved outputs)\n    AH->>AL: Log audit entry\n    AL->>AL: Store audit record\n    \n    AH-->>FE: Response with results\n    FE-->>U: Display output\n    \n    opt Optional notification\n        AH->>NS: Trigger notification\n        NS->>NS: Prepare notification\n        NS-->>U: Send notification<br/>(email/push/in-app)\n    end\nend\n\n",
  "content_size": 1412,
  "collected_at": "2026-02-06T01:34:53.315426",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}