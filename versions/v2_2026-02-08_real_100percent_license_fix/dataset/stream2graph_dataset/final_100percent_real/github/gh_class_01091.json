{
  "id": "gh_class_01091",
  "source": "github",
  "source_url": "https://github.com/NioHast/pos-cafe-prototype/blob/f31901624834f991098b73e1ea0a0d37dbeda54e/planning/03_class_diagram.mmd",
  "github_repo": "NioHast/pos-cafe-prototype",
  "github_file_path": "planning/03_class_diagram.mmd",
  "diagram_type": "class",
  "code": "classDiagram\n    direction LR\n\n    %% --- CORE TABLES (PENGGUNA & AKSES) ---\n    \n    class User {\n        +int id\n        +string name\n        +string email\n        +string password_hash\n        +int role_id\n        +datetime created_at\n        +datetime updated_at\n        +datetime deleted_at\n        +login()\n        +logout()\n        +resetPassword()\n        +hasRole(string roleName)\n        +can(string permission)\n    }\n\n    class Role {\n        +int id\n        +string name\n        +string description\n    }\n\n    class StudentProfile {\n        +int id\n        +int user_id\n        +string student_id\n        +string faculty\n        +string major\n        +int year\n    }\n    \n    class CashierSession {\n        +int id\n        +int user_id\n        +datetime shift_start\n        +datetime shift_end\n        +numeric total_sales\n        +int total_transactions\n        +startShift()\n        +endShift()\n        +recordSale(numeric amount)\n    }\n    \n    class UserResetToken {\n        +int id\n        +int user_id\n        +string token\n        +datetime expires_at\n        +boolean used\n    }\n\n    %% --- CORE TABLES (MENU & INVENTARIS) ---\n\n    class Category {\n      +int id\n      +string name\n      +datetime deleted_at\n    }\n\n    class Menu {\n        +int id\n        +string name\n        +string description\n        +numeric price\n        +numeric student_price\n        +string status\n        +int category_id\n        +MenuIngredient[] ingredients\n        +datetime created_at\n        +datetime updated_at\n        +datetime deleted_at\n        +getEffectivePrice(User customer) : numeric\n        +isAvailable() : boolean\n        +calculateCost() : numeric\n    }\n\n    class Ingredient {\n        +int id\n        +string name\n        +string unit\n        +int low_stock_threshold\n        +datetime created_at\n        +datetime updated_at\n        +datetime deleted_at\n        +getTotalStock() : numeric\n        +decreaseStock(numeric quantity)\n    }\n\n    class IngredientBatch {\n        +int id\n        +int ingredient_id\n        +numeric quantity\n        +date expiry_date\n        +datetime received_at\n        +numeric cost_per_unit\n    }\n\n    class MenuIngredient {\n        +int id\n        +int menu_id\n        +int ingredient_id\n        +numeric quantity_used\n    }\n    \n    class WasteRecord {\n        +int id\n        +int ingredient_id\n        +numeric quantity\n        +string reason\n        +int recorded_by\n        +datetime created_at\n    }\n\n    %% --- CORE TABLES (TRANSAKSI) ---\n\n    class Order {\n        +int id\n        +int customer_id\n        +int cashier_id\n        +numeric total_price\n        +string payment_status\n        +string payment_method\n        +OrderItem[] items\n        +AppliedPromotion[] appliedPromotions\n        +datetime created_at\n        +datetime updated_at\n        +addItem(Menu menu, int quantity, User preparedBy)\n        +calculateTotal()\n        +applyPromotion(Promotion promo)\n        +finalizePayment(string method)\n    }\n\n    class OrderItem {\n        +int id\n        +int order_id\n        +int menu_id\n        +int quantity\n        +numeric price_at_transaction\n        +int handled_by\n    }\n    \n    %% --- FITUR TAMBAHAN (PROMOSI & JADWAL) ---\n    \n    class Promotion {\n        +int id\n        +string name\n        +string description\n        +string type\n        +numeric value\n        +datetime start_date\n        +datetime end_date\n        +boolean is_active\n        +PromotionRule[] rules\n        +isApplicable(Order order) : boolean\n        +calculateDiscount(Order order) : numeric\n    }\n    \n    class PromotionRule {\n        +int promotion_id\n        +string applicable_type\n        +int applicable_id\n    }\n    \n    class AppliedPromotion {\n        +int id\n        +int order_id\n        +int promotion_id\n        +numeric amount_saved\n    }\n\n    class AnalyticsSchedule {\n      +int id\n      +string task_name\n      +string frequency\n      +time run_at_time\n      +datetime next_run_at\n      +boolean is_active\n      +updateNextRunTime()\n    }\n    \n    %% --- TABEL ANALITIK / DATA MINING ---\n    \n    class AnalyticsRun {\n        +int id\n        +string run_type\n        +datetime started_at\n        +datetime finished_at\n        +string status\n        +string description\n        +AssociationRule[] associationResults\n        +KmeansCluster[] clusterResults\n        +ClassificationResult[] classificationResults\n        +EstimationResult[] estimationResults\n        Examples\n        +PredictionModel[] predictionModels\n    }\n    \n    class AssociationRule {\n        +int id\n        +int run_id\n        +string antecedent\n        +string consequent\n        +numeric support\n        +numeric confidence\n        +numeric lift\n    }\n    \n    class KmeansCluster {\n        +int id\n        +int run_id\n        +int cluster_id\n        +string cluster_label\n        +jsonb centroid\n        +int num_points\n    }\n    \n    class MenuClusterAssignment {\n        +int run_id\n        +int menu_id\n        +int cluster_id\n    }\n    \n    class ClassificationResult {\n        +int id\n        +int run_id\n        +date classification_date\n        +string predicted_level\n        +string actual_level\n    }\n    \n    class EstimationResult {\n        +int id\n        +int run_id\n        +date estimation_date\n        +numeric estimated_revenue\n        +numeric actual_revenue\n    }\n    \n    class PredictionModel {\n        +int id\n        +int run_id\n        +string model_name\n        +string algorithm\n        +jsonb parameters\n        +numeric f1_score\n        +datetime created_at\n    }\n    \n    class Prediction {\n        +int id\n        +int model_id\n        +int prediction_target_id\n        +jsonb input_data\n        +string predicted_value\n        +string actual_value\n        +datetime created_at\n    }\n\n    %% --- TABEL TAMBAHAN (PIUTANG & LAPORAN) ---\n    \n    class Debt {\n        +int id\n        +string debtor_name\n        +string contact_info\n        +numeric total_amount\n        +date due_date\n        +string status\n        +datetime created_at\n        +datetime updated_at\n    }\n    \n    class FinancialReport {\n        +int id\n        +date period_start\n        +date period_end\n        +numeric total_income\n        +numeric total_expense\n        +numeric net_profit\n        +datetime generated_at\n    }\n\n\n    %% --- FRONTEND CLASSES (IndexedDB Representation) ---\n    \n    class OfflineMenu {\n        +int id\n        +string name\n        +numeric price\n        +numeric student_price\n        +int category_id\n        +object[] recipe\n    }\n    \n    class OfflineCategory {\n        +int id\n        +string name\n    }\n    \n    class OfflineIngredientStock {\n        +int ingredient_id\n        +string name\n        +numeric quantity\n        +getLocalStock() : numeric\n        +decreaseLocalStock(numeric amount)\n    }\n    \n    class OfflinePromotion {\n        +int id\n        +string name\n        +string type\n        +numeric value\n        +object[] rules\n    }\n    \n    class CurrentUser {\n        +int id\n        +string name\n        +string role\n    }\n    \n    class TransactionQueueItem {\n        +int id\n        +string uuid\n        +datetime created_at\n        +object payload\n        +markAsSynced()\n    }\n    \n    class SyncService {\n        +syncDown()\n        +syncUp()\n        +checkOnlineStatus() : boolean\n    }\n\n\n    %% --- Relationships (Telah Diperbaiki) ---\n    \n    Role \"1\" -- \"*\" User : \"defines\"\n    User \"1\" -- \"0..1\" StudentProfile : \"has profile\"\n    User \"1\" -- \"*\" CashierSession : \"has sessions\"\n    User \"1\" -- \"*\" Order : \"places/handles\"\n    User \"1\" -- \"*\" OrderItem : \"prepares\"\n    User \"1\" -- \"*\" WasteRecord : \"records\"\n    User \"1\" -- \"*\" UserResetToken : \"has\"\n    \n    Category \"1\" -- \"*\" Menu : \"contains\"\n    \n    Menu \"1\" -- \"*\" MenuIngredient : \"uses\"\n    Ingredient \"1\" -- \"*\" MenuIngredient : \"is used in\"\n    Ingredient \"1\" -- \"*\" IngredientBatch : \"has batches\"\n    Ingredient \"1\" -- \"*\" WasteRecord : \"can be wasted\"\n    \n    Order \"1\" o-- \"*\" OrderItem : \"contains (composition)\"\n    Menu \"1\" -- \"*\" OrderItem : \"is item in\"\n    \n    Order \"1\" -- \"*\" AppliedPromotion : \"applies\"\n    Promotion \"1\" -- \"*\" AppliedPromotion : \"is applied\"\n    Promotion \"1\" o-- \"*\" PromotionRule : \"has rules (composition)\"\n    \n    AnalyticsRun \"1\" -- \"*\" AssociationRule : \"generates\"\n    AnalyticsRun \"1\" -- \"*\" KmeansCluster : \"generates\"\n    AnalyticsRun \"1\" -- \"*\" ClassificationResult : \"generates\"\n    AnalyticsRun \"1\" -- \"*\" EstimationResult : \"generates\"\n    AnalyticsRun \"1\" -- \"*\" PredictionModel : \"trains\"\n    PredictionModel \"1\" -- \"*\" Prediction : \"makes\"\n    \n    KmeansCluster \"1\" -- \"*\" MenuClusterAssignment : \"assigns\"\n    Menu \"1\" -- \"*\" MenuClusterAssignment : \"is assigned to\"\n    \n    %% --- Frontend Logic ---\n    SyncService ..> TransactionQueueItem : \"manages queue\"\n    SyncService ..> OfflineMenu : \"updates cache\"\n    SyncService ..> OfflineCategory : \"updates cache\"\n    SyncService ..> OfflineIngredientStock : \"updates cache\"\n    SyncService ..> OfflinePromotion : \"updates cache\"\n    SyncService ..> CurrentUser : \"updates cache\"\n    \n    TransactionQueueItem ..> Order : \"represents offline\"\n",
  "content_size": 9126,
  "collected_at": "2026-02-06T01:52:49.036343",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 1,
  "repo_forks": 0
}