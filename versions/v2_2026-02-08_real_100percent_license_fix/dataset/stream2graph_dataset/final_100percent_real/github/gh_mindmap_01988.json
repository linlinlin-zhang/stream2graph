{
  "id": "gh_mindmap_01988",
  "source": "github",
  "source_url": "https://github.com/lapinChiro/branch_work_examples/blob/de3d7845866e491a9226d20993ff265197da3210/mermaid-docs/diagrams/mindmap-implementation-sequence.mmd",
  "github_repo": "lapinChiro/branch_work_examples",
  "github_file_path": "mermaid-docs/diagrams/mindmap-implementation-sequence.mmd",
  "diagram_type": "mindmap",
  "code": "---\nreferences:\n  - \"File: /packages/mermaid/src/diagrams/mindmap/mindmap-definition.ts\"\n  - \"File: /packages/mermaid/src/diagrams/mindmap/mindmapDb.ts\"\n  - \"File: /packages/mermaid/src/diagrams/mindmap/detector.ts\"\n  - \"File: /packages/mermaid/src/diagrams/mindmap/mindmapTypes.ts\"\n  - \"File: /packages/mermaid/src/diagrams/mindmap/mindmapRenderer.ts\"\n  - \"File: /packages/mermaid/src/diagrams/mindmap/styles.ts\"\n  - \"File: /packages/mermaid/src/diagrams/mindmap/svgDraw.ts\"\ngenerationTime: 2025-01-28T16:00:00.000Z\n---\nsequenceDiagram\n    participant User as User Input Text\n    participant Detector as detector.ts\n    participant Loader as DiagramLoader\n    participant Definition as mindmap-definition.ts\n    participant Parser as parser/mindmap.jison\n    participant DB as MindmapDB\n    participant Renderer as mindmapRenderer.ts\n    participant Cytoscape as cytoscape.js\n    participant SVGDraw as svgDraw.ts\n    participant Styles as styles.ts\n    participant Output as Final SVG\n\n    Note over User, Output: Mindmap Implementation Flow\n\n    %% Detection Phase\n    User->>Detector: /^\\s*mindmap/ text input\n    activate Detector\n    Detector->>Detector: detector(txt) validates pattern\n    Detector->>Loader: loader() function called\n    deactivate Detector\n    \n    activate Loader\n    Loader->>Definition: import mindmap-definition.js\n    deactivate Loader\n\n    %% Core Structure Setup\n    activate Definition\n    Definition->>DB: get db() → new MindmapDB()\n    Definition->>Renderer: setup renderer\n    Definition->>Parser: setup parser\n    Definition->>Styles: setup styles\n    deactivate Definition\n\n    %% Database Initialization\n    activate DB\n    Note over DB: MindmapDB Constructor\n    DB->>DB: initialize nodes array\n    DB->>DB: setup nodeType constants\n    DB->>DB: bind methods\n    DB->>DB: clear() state\n    \n    %% Parsing Phase\n    activate Parser\n    User->>Parser: mindmap syntax text\n    \n    loop For each node in hierarchy\n        Parser->>DB: addNode(level, id, descr, type)\n        activate DB\n        DB->>DB: sanitizeText(id, descr)\n        DB->>DB: getType(startStr, endStr)\n        Note right of DB: Shape Detection:<br/>[ → RECT<br/>( → ROUNDED_RECT<br/>(( → CIRCLE<br/>)) → BANG<br/>{{ → HEXAGON\n        DB->>DB: getParent(level)\n        DB->>DB: create MindmapNode\n        DB->>DB: add to hierarchy\n        deactivate DB\n    end\n\n    opt Icon/Class Decoration\n        Parser->>DB: decorateNode(decoration)\n        DB->>DB: set icon/class properties\n    end\n    deactivate Parser\n\n    %% Data Preparation\n    Renderer->>DB: getData() for layout\n    activate DB\n    DB->>DB: collect all nodes\n    DB->>DB: build parent-child relationships\n    DB-->>Renderer: return node hierarchy\n    deactivate DB\n\n    %% Rendering Pipeline\n    activate Renderer\n    Note over Renderer: Rendering Phase\n    \n    Renderer->>Cytoscape: initialize cytoscape\n    activate Cytoscape\n    \n    loop For each node in mindmap\n        Renderer->>Cytoscape: addNodes(mindmap, cy, conf, level)\n        Cytoscape->>Cytoscape: create node data\n        Cytoscape->>Cytoscape: set position (x, y)\n    end\n\n    loop For parent-child relationships\n        Renderer->>Cytoscape: add edges\n        Cytoscape->>Cytoscape: create edge data\n    end\n\n    Renderer->>Cytoscape: configure cose-bilkent layout\n    Cytoscape->>Cytoscape: calculate optimal positions\n    Cytoscape-->>Renderer: return positioned graph\n    deactivate Cytoscape\n\n    %% SVG Generation\n    Renderer->>SVGDraw: drawNodes(db, svg, mindmap, section, conf)\n    activate SVGDraw\n    \n    loop For each node recursively\n        SVGDraw->>SVGDraw: select shape function\n        \n        alt Default Shape\n            SVGDraw->>SVGDraw: defaultBkg() - rounded rectangle\n        else Rectangle Shape\n            SVGDraw->>SVGDraw: rectBkg() - sharp corners\n        else Circle Shape\n            SVGDraw->>SVGDraw: circleBkg() - perfect circle\n        else Cloud Shape\n            SVGDraw->>SVGDraw: cloudBkg() - organic curves\n        else Bang Shape\n            SVGDraw->>SVGDraw: bangBkg() - explosion style\n        else Hexagon Shape\n            SVGDraw->>SVGDraw: hexagonBkg() - six sides\n        end\n        \n        SVGDraw->>SVGDraw: create SVG elements\n        SVGDraw->>SVGDraw: add text labels\n        SVGDraw->>SVGDraw: position node\n        \n        opt Node has children\n            SVGDraw->>SVGDraw: drawNodes() recursive call\n        end\n    end\n    deactivate SVGDraw\n\n    %% Edge Rendering\n    Renderer->>Renderer: drawEdges(edgesEl, cy)\n    loop For each edge\n        Renderer->>Renderer: extract edge bounds\n        Renderer->>Renderer: draw SVG path\n    end\n\n    %% Styling Application\n    Renderer->>Styles: getStyles(options)\n    activate Styles\n    \n    Styles->>Styles: genSections(options)\n    loop For THEME_COLOR_LIMIT sections\n        Styles->>Styles: generate color scale\n        Styles->>Styles: create CSS rules\n        Note right of Styles: .section-X fills<br/>.edge-depth-X widths<br/>.node-icon-X colors\n    end\n    \n    Styles->>Styles: apply theme integration\n    Styles-->>Renderer: return compiled CSS\n    deactivate Styles\n\n    %% Final Assembly\n    Renderer->>Output: selectSvgElement()\n    Renderer->>Output: setupGraphViewbox()\n    Renderer->>Output: apply styles\n    Renderer->>Output: add interactive elements\n    deactivate Renderer\n\n    activate Output\n    Note over Output: Final Mindmap Features\n    Output->>Output: responsive layout\n    Output->>Output: accessibility attributes\n    Output->>Output: hover effects\n    Output->>Output: click handling\n    Output-->>User: rendered mindmap\n    deactivate Output\n\n    %% Configuration Details\n    Note over DB, Styles: Configuration Options\n    Note right of DB: Padding Calculations:<br/>Base padding from config<br/>RECT: ×2 padding<br/>ROUNDED_RECT: ×2 padding<br/>HEXAGON: ×2 padding\n    Note right of Styles: Section Management:<br/>MAX_SECTIONS = 12<br/>Dynamic color generation<br/>Git theme integration\n    Note right of Renderer: Layout Parameters:<br/>Cytoscape configuration<br/>coseBilkent settings<br/>Node spacing rules ",
  "content_size": 6095,
  "collected_at": "2026-02-06T02:06:04.103102",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 1,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}