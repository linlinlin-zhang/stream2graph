{
  "id": "gh_architecture_01841",
  "source": "github",
  "source_url": "https://github.com/Tranbac123/AIaaS-Multi-Agent/blob/f8d36d81a2ca38a1f0e6f69de8f737addf9e3a58/docs/flows/detailed-visual-flow.mmd",
  "github_repo": "Tranbac123/AIaaS-Multi-Agent",
  "github_file_path": "docs/flows/detailed-visual-flow.mmd",
  "diagram_type": "architecture",
  "code": "graph TB\n    %% User Interface Layer\n    subgraph \"ğŸ‘¤ User Interface Layer\"\n        User[\"ğŸ‘¤ User\"]\n        Browser[\"ğŸŒ Web Browser\"]\n        Mobile[\"ğŸ“± Mobile App\"]\n    end\n\n    %% Frontend Services\n    subgraph \"ğŸ¨ Frontend Services\"\n        ChatbotUI[\"ğŸ¤– AI Chatbot UI<br/>:3001<br/>React + Real-time Search\"]\n        WebFrontend[\"ğŸŒ Web Frontend<br/>:3000<br/>React/Vite Dashboard\"]\n        AdminPortal[\"âš™ï¸ Admin Portal<br/>:8099<br/>FastAPI Backend\"]\n    end\n\n    %% API Gateway Layer\n    subgraph \"ğŸšª API Gateway Layer\"\n        APIGateway[\"ğŸšª API Gateway<br/>:8000<br/>Authentication â€¢ Rate Limiting<br/>Request Routing â€¢ CORS\"]\n    end\n\n    %% Core Processing Layer\n    subgraph \"ğŸ§  Core Processing Layer\"\n        RouterService[\"ğŸ¯ Router Service<br/>:8083<br/>Intelligent Routing<br/>Feature Extraction<br/>Tier Classification\"]\n        \n        Orchestrator[\"ğŸ¼ Orchestrator<br/>:8081<br/>Workflow Execution<br/>LangGraph â€¢ Saga Patterns<br/>Loop Safety â€¢ Tool Coordination\"]\n        \n        ModelGateway[\"ğŸ¤– Model Gateway<br/>:8080<br/>AI Model Routing<br/>Provider Management<br/>Cost Optimization\"]\n    end\n\n    %% Data & Tools Layer\n    subgraph \"ğŸ”§ Data & Tools Layer\"\n        RetrievalService[\"ğŸ“š Retrieval Service<br/>:8081<br/>Document Retrieval<br/>RAG â€¢ Vector Search<br/>Semantic Analysis\"]\n        \n        ToolsService[\"ğŸ› ï¸ Tools Service<br/>:8082<br/>External Tools<br/>FIRECRAWL Web Search<br/>API Integrations\"]\n        \n        ChatAdapters[\"ğŸ’¬ Chat Adapters<br/>:8006<br/>Multi-channel Integration<br/>Facebook â€¢ Zalo â€¢ TikTok<br/>Webhook Processing\"]\n    end\n\n    %% Real-time Layer\n    subgraph \"âš¡ Real-time Layer\"\n        RealtimeGateway[\"âš¡ Realtime Gateway<br/>:8084<br/>WebSocket Connections<br/>Message Streaming<br/>Backpressure Management\"]\n        \n        SemanticCache[\"ğŸ§  Semantic Cache<br/>:8085<br/>Intelligent Caching<br/>Response Optimization<br/>Similarity Matching\"]\n    end\n\n    %% Control Plane\n    subgraph \"ğŸ›ï¸ Control Plane\"\n        ConfigService[\"âš™ï¸ Config Service<br/>:8090<br/>Configuration Management<br/>Environment Settings<br/>Feature Toggles\"]\n        \n        PolicyAdapter[\"ğŸ“‹ Policy Adapter<br/>:8091<br/>Policy Enforcement<br/>Compliance Management<br/>Access Control\"]\n        \n        FeatureFlags[\"ğŸš© Feature Flags<br/>:8092<br/>Runtime Toggles<br/>A/B Testing<br/>Canary Deployments\"]\n        \n        UsageMetering[\"ğŸ“Š Usage Metering<br/>:8095<br/>Usage Tracking<br/>Cost Monitoring<br/>Budget Enforcement\"]\n        \n        AuditLog[\"ğŸ“ Audit Log<br/>:8096<br/>Activity Tracking<br/>Compliance Logging<br/>Security Events\"]\n    end\n\n    %% Infrastructure Layer\n    subgraph \"ğŸ—ï¸ Infrastructure Layer\"\n        Postgres[\"ğŸ˜ PostgreSQL<br/>:5432<br/>Primary Database<br/>Multi-tenant RLS<br/>ACID Compliance\"]\n        \n        Redis[\"ğŸ”´ Redis<br/>:6379<br/>Session Storage<br/>Caching Layer<br/>Pub/Sub Messaging\"]\n        \n        NATS[\"ğŸ“¡ NATS JetStream<br/>:4222<br/>Event Streaming<br/>Message Queuing<br/>Guaranteed Delivery\"]\n        \n        VectorDB[\"ğŸ§® Vector Database<br/>Embeddings Storage<br/>Semantic Search<br/>Similarity Matching\"]\n    end\n\n    %% External Services\n    subgraph \"ğŸŒ External Services\"\n        OpenAI[\"ğŸ§  OpenAI API<br/>GPT Models<br/>Text Generation\"]\n        \n        Anthropic[\"ğŸ¤– Anthropic API<br/>Claude Models<br/>Advanced Reasoning\"]\n        \n        FIRECRAWL[\"ğŸ•·ï¸ FIRECRAWL API<br/>Web Scraping<br/>Live Data Search\"]\n        \n        Stripe[\"ğŸ’³ Stripe API<br/>Payment Processing<br/>Billing Management\"]\n        \n        SocialPlatforms[\"ğŸ“± Social Platforms<br/>Facebook Messenger<br/>Zalo Chat â€¢ TikTok<br/>Webhook Endpoints\"]\n    end\n\n    %% User Journey - Main Flow\n    User --> Browser\n    User --> Mobile\n    Browser --> ChatbotUI\n    Browser --> WebFrontend\n    Mobile --> ChatbotUI\n\n    %% Frontend to API Gateway\n    ChatbotUI -->|\"POST /ask<br/>JSON Request<br/>Session Management\"| APIGateway\n    WebFrontend -->|\"REST API Calls<br/>Authentication<br/>CORS Headers\"| APIGateway\n    AdminPortal -->|\"Admin APIs<br/>Management Operations<br/>User Administration\"| APIGateway\n\n    %% API Gateway Processing\n    APIGateway -->|\"JWT Validation<br/>Rate Limiting<br/>Tenant Context\"| ConfigService\n    APIGateway -->|\"Policy Checks<br/>Access Control<br/>Compliance\"| PolicyAdapter\n    APIGateway -->|\"Feature Flags<br/>A/B Testing<br/>Runtime Toggles\"| FeatureFlags\n\n    %% Core Processing Flow\n    APIGateway -->|\"Intelligent Routing<br/>Feature Extraction<br/>Tier Selection\"| RouterService\n    RouterService -->|\"Workflow Execution<br/>Multi-step Processing<br/>Tool Coordination\"| Orchestrator\n    Orchestrator -->|\"AI Model Requests<br/>Provider Selection<br/>Cost Optimization\"| ModelGateway\n\n    %% Data & Tools Processing\n    Orchestrator -->|\"Document Retrieval<br/>Vector Search<br/>RAG Processing\"| RetrievalService\n    Orchestrator -->|\"External Tools<br/>Web Search<br/>API Integrations\"| ToolsService\n    \n    %% Real-time Communication\n    APIGateway -->|\"WebSocket Upgrade<br/>Real-time Streaming<br/>Message Queues\"| RealtimeGateway\n    APIGateway -->|\"Response Caching<br/>Similarity Matching<br/>Performance Optimization\"| SemanticCache\n\n    %% External API Calls\n    ModelGateway -->|\"GPT Completions<br/>Text Generation<br/>Token Usage\"| OpenAI\n    ModelGateway -->|\"Claude Completions<br/>Advanced Reasoning<br/>Multi-modal\"| Anthropic\n    ToolsService -->|\"Web Scraping<br/>Live Data Search<br/>Content Extraction\"| FIRECRAWL\n\n    %% Social Platform Integration\n    SocialPlatforms -->|\"Webhook Messages<br/>Platform Events<br/>User Interactions\"| ChatAdapters\n    ChatAdapters -->|\"Normalized Messages<br/>Platform Abstraction<br/>Response Routing\"| APIGateway\n\n    %% Infrastructure Dependencies\n    APIGateway -->|\"Data Persistence<br/>Multi-tenant Storage<br/>ACID Transactions\"| Postgres\n    APIGateway -->|\"Session Management<br/>Caching Layer<br/>Pub/Sub Events\"| Redis\n    APIGateway -->|\"Event Streaming<br/>Message Queuing<br/>Reliable Delivery\"| NATS\n    \n    RetrievalService -->|\"Vector Storage<br/>Embedding Indexing<br/>Similarity Search\"| VectorDB\n    RetrievalService -->|\"Document Storage<br/>Metadata Management<br/>RLS Isolation\"| Postgres\n    \n    RealtimeGateway -->|\"Session Storage<br/>Message Buffering<br/>Connection Management\"| Redis\n    RealtimeGateway -->|\"Event Broadcasting<br/>Real-time Updates<br/>Message Streaming\"| NATS\n\n    %% Control Plane Dependencies\n    ConfigService -->|\"Configuration Storage<br/>Environment Variables<br/>Settings Cache\"| Redis\n    PolicyAdapter -->|\"Policy Cache<br/>Decision Storage<br/>Access Rules\"| Redis\n    FeatureFlags -->|\"Flag State<br/>A/B Test Data<br/>Toggle History\"| Redis\n    UsageMetering -->|\"Usage Data<br/>Billing Events<br/>Cost Tracking\"| Postgres\n    AuditLog -->|\"Audit Events<br/>Compliance Logs<br/>Security Trails\"| Postgres\n\n    %% Billing Integration\n    UsageMetering -->|\"Payment Processing<br/>Invoice Generation<br/>Subscription Management\"| Stripe\n\n    %% Monitoring & Analytics\n    APIGateway -->|\"Usage Tracking<br/>Cost Monitoring<br/>Performance Metrics\"| UsageMetering\n    APIGateway -->|\"Activity Logging<br/>Security Events<br/>Compliance Tracking\"| AuditLog\n\n    %% Event Publishing\n    APIGateway -.->|\"Usage Events<br/>tenant.usage.*\"| NATS\n    APIGateway -.->|\"Audit Events<br/>tenant.audit.*\"| NATS\n    ModelGateway -.->|\"Model Events<br/>model.usage.*\"| NATS\n    ToolsService -.->|\"Tool Events<br/>tool.execution.*\"| NATS\n    UsageMetering -.->|\"Billing Events<br/>tenant.billing.*\"| NATS\n\n    %% Response Flow\n    ModelGateway -->|\"AI Response<br/>Generated Content<br/>Usage Metrics\"| APIGateway\n    RetrievalService -->|\"Document Results<br/>Relevance Scores<br/>Source Citations\"| APIGateway\n    ToolsService -->|\"Tool Output<br/>External Data<br/>Execution Metrics\"| APIGateway\n    \n    APIGateway -->|\"Final Response<br/>Citations â€¢ Trace<br/>Usage Data\"| ChatbotUI\n    APIGateway -->|\"API Response<br/>JSON Data<br/>Status Codes\"| WebFrontend\n    APIGateway -->|\"Admin Response<br/>Management Data<br/>System Status\"| AdminPortal\n\n    %% Real-time Updates\n    RealtimeGateway -->|\"WebSocket Messages<br/>Real-time Updates<br/>Streaming Response\"| ChatbotUI\n\n    %% Styling\n    classDef userLayer fill:#e3f2fd,stroke:#1976d2,stroke-width:3px\n    classDef frontendLayer fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    classDef gatewayLayer fill:#fff3e0,stroke:#f57c00,stroke-width:3px\n    classDef coreLayer fill:#e8f5e8,stroke:#388e3c,stroke-width:2px\n    classDef dataLayer fill:#fce4ec,stroke:#c2185b,stroke-width:2px\n    classDef realtimeLayer fill:#e0f2f1,stroke:#00796b,stroke-width:2px\n    classDef controlLayer fill:#fff8e1,stroke:#fbc02d,stroke-width:2px\n    classDef infraLayer fill:#efebe9,stroke:#5d4037,stroke-width:2px\n    classDef externalLayer fill:#ffebee,stroke:#d32f2f,stroke-width:2px\n\n    class User,Browser,Mobile userLayer\n    class ChatbotUI,WebFrontend,AdminPortal frontendLayer\n    class APIGateway gatewayLayer\n    class RouterService,Orchestrator,ModelGateway coreLayer\n    class RetrievalService,ToolsService,ChatAdapters dataLayer\n    class RealtimeGateway,SemanticCache realtimeLayer\n    class ConfigService,PolicyAdapter,FeatureFlags,UsageMetering,AuditLog controlLayer\n    class Postgres,Redis,NATS,VectorDB infraLayer\n    class OpenAI,Anthropic,FIRECRAWL,Stripe,SocialPlatforms externalLayer\n",
  "content_size": 9342,
  "collected_at": "2026-02-06T02:04:01.053216",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚",
  "license": "none",
  "license_name": "No License (Assumed)",
  "license_url": null,
  "repo_stars": 0,
  "repo_forks": 0
}