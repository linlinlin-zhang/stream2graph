{
  "id": "gh_flowchart_00540",
  "source": "github",
  "source_url": "https://github.com/Riff-Technologies/elite-raffle-docs/blob/42f245bf6ebf08c6e75c4fb39d1af771f31eca8d/planning/archive/architecture-diagram-v1.mmd",
  "github_repo": "Riff-Technologies/elite-raffle-docs",
  "github_file_path": "planning/archive/architecture-diagram-v1.mmd",
  "diagram_type": "flowchart",
  "code": "flowchart TB\n   %% ───────────────────────────────\n   %% Frontend Applications\n   %% ───────────────────────────────\n   subgraph Frontend[\"Frontend Applications\"]\n       PUBLIC[\"Public Website<br>(Next.js/Amplify)\"]\n       ADMIN[\"Admin Portal<br>(Next.js/Amplify)\"]\n       subgraph RSU[\"RSU Mobile App\"]\n           EXPO[\"Expo UI Layer\"]\n           PACKAGE[\"Android Package<br>✅ GLI Certified<br>• Ticket Generation<br>• Offline Queue<br>• Self-Verification\"]\n       end\n   end\n\n   %% ───────────────────────────────\n   %% API & Security Layer\n   %% ───────────────────────────────\n   subgraph API[\"API & Security Layer\"]\n       APIGW[\"API Gateway<br>(Regional/Public)<br>+ WAF Protection\"]\n       COGNITO[\"AWS Cognito<br>• Admin Users<br>• RSU Operators\"]\n       VPN[\"VPN Gateway<br>(Site-to-Site)\"]\n   end\n\n   %% ───────────────────────────────\n   %% Core Services\n   %% ───────────────────────────────\n   subgraph Services[\"Core Services (Lambda Functions in Go)\"]\n       RAFFLE[\"Raffle Core Service<br>✅ Critical Files #4,5<br>• Ticket Management<br>• Draw Processing<br>• Device Registry\"]\n       RNG[\"RNG Service<br>✅ Critical File #1<br>• Crypto Secure<br>• Draw Selection\"]\n       REPORT[\"Reporting Service<br>• GLI-31 Reports<br>• Analytics\"]\n       PAYMENT[\"Payment Service<br>• Order Processing<br>• Payment Status<br>• Reconciliation\"]\n   end\n\n   %% ───────────────────────────────\n   %% External Services\n   %% ───────────────────────────────\n   subgraph External[\"External Services\"]\n       PROCESSOR[\"Payment Processor<br>(Stripe/Square/etc)<br>• Card Processing<br>• Webhooks\"]\n   end\n\n   %% ───────────────────────────────\n   %% Data Storage\n   %% ───────────────────────────────\n   subgraph Data[\"Data Layer\"]\n       AURORA[(\"Aurora PostgreSQL<br>Multi-AZ<br>✅ Critical File #3<br>• Raffle State<br>• Transactions\")]\n       DYNAMO[(\"DynamoDB<br>• Event Logs<br>• High-velocity Writes<br>• TTL Enabled\")]\n       PARAM[\"Parameter Store<br>• Checksums<br>• Configuration\"]\n       S3[(\"S3 Archive<br>• Long-term Storage<br>• Glacier Lifecycle\")]\n   end\n\n   %% ───────────────────────────────\n   %% Compliance & Monitoring\n   %% ───────────────────────────────\n   subgraph Monitoring[\"Compliance & Monitoring\"]\n       VERIFY[\"Verification Lambda<br>✅ Critical File #2<br>• Hourly Execution<br>• Checksum Aggregation\"]\n       METRICS[\"CloudWatch Metrics<br>• Self-Check Results<br>• System Health\"]\n       ALARMS[\"CloudWatch Alarms<br>• Failure Detection<br>• SNS Alerts\"]\n       CONFIG[\"AWS Config<br>• Compliance Rules<br>• Resource Tracking\"]\n       S3WEB[\"Public Verification Site<br>(S3 + CloudFront)<br>• System Checksums<br>• Compliance Status\"]\n   end\n\n   %% ───────────────────────────────\n   %% Connections - User Flows\n   %% ───────────────────────────────\n   PUBLIC -->|Public Data| APIGW\n   ADMIN -->|Auth + JWT| COGNITO\n   EXPO -->|Auth + JWT| COGNITO\n   COGNITO -->|Validate| APIGW\n   EXPO <-->|Local IPC| PACKAGE\n   PACKAGE -->|Device Auth| VPN\n   VPN -->|Secure Channel| APIGW\n\n   %% ───────────────────────────────\n   %% Connections - Service Flows\n   %% ───────────────────────────────\n   APIGW -->|Route| RAFFLE\n   APIGW -->|Route| REPORT\n   APIGW -->|Route| PAYMENT\n   RAFFLE -->|Generate Numbers| RNG\n   PAYMENT <-->|Process Cards| PROCESSOR\n   PAYMENT -->|Confirm Payment| RAFFLE\n\n   %% ───────────────────────────────\n   %% Connections - Data Flows\n   %% ───────────────────────────────\n   RAFFLE -->|Read/Write| AURORA\n   RAFFLE -->|Write Events| DYNAMO\n   RAFFLE -->|Read Config| PARAM\n   REPORT -->|Read Only| AURORA\n   RNG -->|Read Config| PARAM\n   PAYMENT -->|Payment Records| AURORA\n\n   %% ───────────────────────────────\n   %% Connections - Monitoring Flows\n   %% ───────────────────────────────\n   RNG -.->|Self-Check| METRICS\n   RAFFLE -.->|Self-Check| METRICS\n   PACKAGE -.->|Self-Check| METRICS\n   DYNAMO -->|Stream| S3\n   METRICS -->|Trigger| ALARMS\n   METRICS -->|Aggregate| VERIFY\n   VERIFY -->|Publish| S3WEB\n   CONFIG -.->|Monitor| Services\n   PROCESSOR -.->|Webhooks| APIGW\n\n   %% ───────────────────────────────\n   %% Styling\n   %% ───────────────────────────────\n   classDef critical fill:#ffcccc,stroke:#ff0000,stroke-width:3px\n   classDef storage fill:#ccccff,stroke:#0000ff,stroke-width:2px\n   classDef network fill:#ffffcc,stroke:#ff9900,stroke-width:2px\n   classDef monitor fill:#ccffcc,stroke:#00aa00,stroke-width:2px\n   classDef external fill:#ffccff,stroke:#ff00ff,stroke-width:2px\n\n   class RNG,RAFFLE,PACKAGE,VERIFY,AURORA critical\n   class DYNAMO,S3,PARAM storage\n   class APIGW,VPN,COGNITO network\n   class METRICS,ALARMS,CONFIG,S3WEB monitor\n   class PROCESSOR external\n",
  "content_size": 4637,
  "collected_at": "2026-02-06T01:44:53.559755",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "repo_owner": "Riff-Technologies",
  "repo_name": "elite-raffle-docs",
  "repo_description": "Documentation around Elite Raffle project",
  "repo_language": "Mermaid",
  "repo_topics": [],
  "repo_created_at": "2025-06-02T17:16:49Z",
  "repo_updated_at": "2025-07-22T16:40:57Z"
}