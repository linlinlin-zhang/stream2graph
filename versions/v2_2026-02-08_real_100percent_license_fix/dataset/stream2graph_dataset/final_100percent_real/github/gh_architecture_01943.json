{
  "id": "gh_architecture_01943",
  "source": "github",
  "source_url": "https://github.com/ryo-arima/circulator/blob/988729d48a4084dac094190a2d1d75badccae5dd/docs/architecture.mmd",
  "github_repo": "ryo-arima/circulator",
  "github_file_path": "docs/architecture.mmd",
  "diagram_type": "architecture",
  "code": "graph TB\n    subgraph \"Circulator - Distributed System Architecture\"\n        subgraph \"Client Layer\"\n            CLI[CLI Client]\n            WEB[Web Client]\n            API_CLIENT[API Client]\n            CLIENT_REPO[Client Repository]\n        end\n\n        subgraph \"Server Layer\"\n            subgraph \"HTTP API Gateway\"\n                REST[REST API Server]\n                GRPC[gRPC Server]\n            end\n            \n            subgraph \"Server Instance 1\"\n                SC1[Server Controller 1]\n                SU1[Server UseCase 1]\n                SR1[Server Repository 1]\n            end\n            \n            subgraph \"Server Instance 2\"\n                SC2[Server Controller 2]\n                SU2[Server UseCase 2]\n                SR2[Server Repository 2]\n            end\n        end\n\n        subgraph \"Agent Layer\"            \n            subgraph \"Agent Instance 1\"\n                A1[Agent Node 1]\n                AC1[Agent Controller 1]\n                AU1[Agent UseCase 1]\n                AR1[Agent Repository 1]\n                FS1[File System 1]\n            end\n            \n            subgraph \"Agent Instance 2\"\n                A2[Agent Node 2]\n                AC2[Agent Controller 2]\n                AU2[Agent UseCase 2]\n                AR2[Agent Repository 2]\n                FS2[File System 2]\n            end\n            \n            subgraph \"Agent Instance N\"\n                AN[Agent Node N]\n                ACN[Agent Controller N]\n                AUN[Agent UseCase N]\n                ARN[Agent Repository N]\n                FSN[File System N]\n            end\n        end\n\n        subgraph \"Infrastructure Layer\"\n            subgraph \"Message Streaming\"\n                PULSAR[(Apache Pulsar)]\n                TOPICS[Topics: Commands, Events, Reports, Notifications, Inter-Server]\n            end\n            \n            subgraph \"Data Storage\"\n                MYSQL[(MySQL Database)]\n                TABLES[Tables: Agents, AgentInfo, SystemInfo, ServerInstances]\n            end\n        end\n\n        subgraph \"Configuration and Logging\"\n            MCP[MCode System]\n            LOG[Centralized Logging]\n            BASE_CONFIG[BaseConfig DI]\n        end\n    end\n\n    %% Client to Server Communication\n    CLI --> REST\n    WEB --> REST\n    API_CLIENT --> GRPC\n    \n    %% Client Internal Communication\n    CLI --> CLIENT_REPO\n    WEB --> CLIENT_REPO\n    API_CLIENT --> CLIENT_REPO\n    \n    %% API Gateway to Server Controllers\n    REST --> SC1\n    REST --> SC2\n    GRPC --> SC1\n    GRPC --> SC2\n    \n    %% Server Internal Communication (Database Access)\n    SR1 --> MYSQL\n    SR2 --> MYSQL\n    \n    %% Agent to Server HTTP Communication\n    A1 --> REST\n    A2 --> REST\n    AN --> REST\n    \n    %% Agent Internal Communication (Instance 1)\n    A1 --> AC1\n    AC1 --> AU1\n    AU1 --> AR1\n    AR1 --> FS1\n    \n    %% Agent Internal Communication (Instance 2)\n    A2 --> AC2\n    AC2 --> AU2\n    AU2 --> AR2\n    AR2 --> FS2\n    \n    %% Agent Internal Communication (Instance N)\n    AN --> ACN\n    ACN --> AUN\n    AUN --> ARN\n    ARN --> FSN\n    \n    %% Server Repository to Pulsar to REST API Server Controller\n    SR1 -.->|Publish Events| PULSAR\n    SR2 -.->|Publish Events| PULSAR\n    PULSAR -.->|Server Events| REST\n    \n    %% Server Controller to UseCase to Repository Pulsar Chain\n    SC1 --> SU1\n    SU1 --> SR1\n    SC2 --> SU2\n    SU2 --> SR2\n    \n    %% Agent Repository to Pulsar to gRPC Server Agent Controller\n    AR1 -.->|Agent Reports| PULSAR\n    AR2 -.->|Agent Reports| PULSAR\n    ARN -.->|Agent Reports| PULSAR\n    PULSAR -.->|Agent Data| GRPC\n    \n    %% Client Repository to Pulsar to REST API\n    CLIENT_REPO -.->|Client Events| PULSAR\n    PULSAR -.->|System Status| REST\n    \n    %% Additional Pulsar Communication Patterns\n    PULSAR -.->|Commands| AR1\n    PULSAR -.->|Commands| AR2\n    PULSAR -.->|Commands| ARN\n    \n    %% Server to Server Communication via Pulsar\n    SR1 -.->|Inter-Server Sync| PULSAR\n    SR2 -.->|Inter-Server Sync| PULSAR\n    PULSAR -.->|Server Coordination| SR1\n    PULSAR -.->|Server Coordination| SR2\n    \n    %% Configuration and Logging\n    MCP --> LOG\n    BASE_CONFIG --> SC1\n    BASE_CONFIG --> SC2\n    BASE_CONFIG --> AC1\n    BASE_CONFIG --> AC2\n    BASE_CONFIG --> ACN\n    BASE_CONFIG --> SR1\n    BASE_CONFIG --> SR2\n    BASE_CONFIG --> AR1\n    BASE_CONFIG --> AR2\n    BASE_CONFIG --> ARN\n\n    %% Styling\n    classDef clientLayer fill:#e1f5fe,stroke:#01579b,stroke-width:2px\n    classDef serverLayer fill:#f3e5f5,stroke:#4a148c,stroke-width:2px\n    classDef agentLayer fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px\n    classDef infraLayer fill:#fff3e0,stroke:#e65100,stroke-width:2px\n    classDef configLayer fill:#fce4ec,stroke:#880e4f,stroke-width:2px\n\n    class CLI,WEB,API_CLIENT,CLIENT_REPO clientLayer\n    class REST,GRPC,SC1,SU1,SR1,SC2,SU2,SR2 serverLayer\n    class A1,A2,AN,AC1,AU1,AR1,AC2,AU2,AR2,ACN,AUN,ARN agentLayer\n    class PULSAR,TOPICS,MYSQL,TABLES,FS1,FS2,FSN infraLayer\n    class MCP,LOG,BASE_CONFIG configLayer",
  "content_size": 5014,
  "collected_at": "2026-02-06T02:05:05.761497",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0
}