{
  "id": "gh_flowchart_00398",
  "source": "github",
  "source_url": "https://github.com/trutkowski22/claude-task-master/blob/80b6b87d8682d53235785872ed02e4e8c2106272/project-overlord-context/Mermaid-Diagrams/Core-Implementation/custom-sdk/language-model_diagram.mmd",
  "github_repo": "trutkowski22/claude-task-master",
  "github_file_path": "project-overlord-context/Mermaid-Diagrams/Core-Implementation/custom-sdk/language-model_diagram.mmd",
  "diagram_type": "flowchart",
  "code": "flowchart TB\n    subgraph Imports [\"ğŸ“¥ Imports\"]\n        IMP1[\"convertToMCPFormat, convertFromMCPFormat from G:\\claude-task-master\\claude-task-master\\mcp-server\\src\\custom-sdk\\message-converter.js\"]\n        IMP2[\"MCPError, mapMCPError from G:\\claude-task-master\\claude-task-master\\mcp-server\\src\\custom-sdk\\errors.js\"]\n        IMP3[\"extractJson from G:\\claude-task-master\\claude-task-master\\mcp-server\\src\\custom-sdk\\json-extractor.js\"]\n        IMP4[\"convertSchemaToInstructions, enhancePromptForJSON from G:\\claude-task-master\\claude-task-master\\mcp-server\\src\\custom-sdk\\schema-converter.js\"]\n    end\n    \n    subgraph Classes [\"ğŸ”§ Classes Defined\"]\n        CL1[\"MCPLanguageModel\"]\n    end\n    \n    subgraph Functions [\"âš™ï¸ Functions Defined\"]\n        FN1[\"constructor(options)\"]\n        FN2[\"validateSession()\"]\n        FN3[\"doGenerate(options)\"]\n        FN4[\"doGenerateObject(options)\"]\n        FN5[\"doStream(options)\"]\n        FN6[\"simulateStreaming(result)\"]\n    end\n    \n    subgraph Exports [\"ğŸ“¤ Exports\"]\n        EX1[\"class MCPLanguageModel\"]\n    end\n    \n    subgraph Parameters [\"ğŸ“‹ Parameters\"]\n        PA1[\"constructor: options{session, modelId, settings}\"]\n        PA2[\"doGenerate: options{prompt, abortSignal}\"]\n        PA3[\"doGenerateObject: options{prompt, schema, mode, abortSignal, objectName}\"]\n        PA4[\"doStream: options{...generation options}\"]\n        PA5[\"simulateStreaming: result{text, finishReason, usage}\"]\n    end\n    \n    subgraph Constants [\"ğŸ“Š Constants\"]\n        CO1[\"specificationVersion: 'v1'\"]\n        CO2[\"defaultObjectGenerationMode: 'json'\"]\n        CO3[\"supportsImageUrls: false\"]\n        CO4[\"supportsStructuredOutputs: true\"]\n        CO5[\"provider: 'mcp-ai-sdk'\"]\n        CO6[\"timeout: 240000ms (4 minutes)\"]\n        CO7[\"chunkSize: Math.max(1, Math.floor(text.length / 10))\"]\n        CO8[\"streamDelay: 50ms\"]\n    end\n    \n    subgraph ExecutionFlow [\"ğŸ”„ Execution Flow\"]\n        FL1[\"Initialize language model with MCP session and settings\"]\n        FL2[\"Validate session has required sampling capabilities\"]\n        FL3[\"For text generation: convert AI SDK prompt to MCP format\"]\n        FL4[\"Call MCP session.requestSampling with converted messages\"]\n        FL5[\"Convert MCP response back to AI SDK format with usage stats\"]\n        FL6[\"For object generation: convert schema to JSON instructions\"]\n        FL7[\"Enhance prompt with JSON generation requirements\"]\n        FL8[\"Extract and parse JSON from MCP response text\"]\n        FL9[\"Validate parsed object against provided schema\"]\n        FL10[\"For streaming: simulate by chunking complete response\"]\n        FL11[\"Yield text chunks with delays to mimic streaming\"]\n        FL12[\"Handle errors by mapping to appropriate MCP error types\"]\n    end\n    \n    %% Flow connections\n    FL1 --> FL2\n    FL2 --> FL3\n    FL3 --> FL4\n    FL4 --> FL5\n    FL5 --> FL6\n    FL6 --> FL7\n    FL7 --> FL8\n    FL8 --> FL9\n    FL9 --> FL10\n    FL10 --> FL11\n    FL11 --> FL12\n    \n    %% Cross-references\n    CL1 -.-> FN1\n    FN1 -.-> PA1\n    FN2 -.-> CO1\n    FN3 -.-> PA2\n    FN4 -.-> PA3\n    FN5 -.-> PA4\n    FN6 -.-> PA5\n    IMP1 -.-> FL3\n    IMP1 -.-> FL5\n    IMP2 -.-> FL12\n    IMP3 -.-> FL8\n    IMP4 -.-> FL6\n    CO6 -.-> FL4",
  "content_size": 3209,
  "collected_at": "2026-02-06T01:43:50.714628",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚"
}