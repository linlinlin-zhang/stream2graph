{
  "id": "gh_class_01133",
  "source": "github",
  "source_url": "https://github.com/ariesanhthu/AI4STYLE/blob/cbdce994dfbfc1737454c29c09755aa2b89836ff/docs/diagram/class/backend/services_entities.mmd",
  "github_repo": "ariesanhthu/AI4STYLE",
  "github_file_path": "docs/diagram/class/backend/services_entities.mmd",
  "diagram_type": "class",
  "code": "---\nconfig:\n  look: neo\n  theme: default\n---\nclassDiagram\n    namespace Auth {\n        class AuthService {\n            -userRepository: IUserRepository\n            -roleRepository: IRoleRepository\n            -tokenService: ITokenService\n            -cacheService: ICacheService\n            -logger: ILoggerService\n            +signUpStaff(dto)\n            +signUpGuest(dto)\n            +signIn(dto)\n            +signOut(userId)\n            +changePassword(dto)\n            +forgetPassword(dto)\n            +refreshToken(token)\n            +generateOtp(dto)\n            +verifyOtp(dto)\n        }\n    }\n\n    namespace Category {\n        class CategoryValidationService {\n            -categoryRepository: ICategoryRepository\n            -logger: ILoggerService\n            +validateCategoryExists(id)\n            +validateUnique(slug, name)\n            +validateParentExists(parentId)\n            +validateNoCircularReference(id, parentId)\n            +validateNoChildren(id)\n            +validateNoProductsInCategory(id)\n        }\n        class CategoryService {\n            -categoryRepository: ICategoryRepository\n            -validationService: CategoryValidationService\n            -logger: ILoggerService\n            +createCategory(dto)\n            +getCategoryById(id)\n            +getCategoryTree()\n            +getCategoryBySlug(slug)\n            +getListCategory(query)\n            +updateCategory(id, dto)\n            +deleteCategory(id)\n        }\n        class CategoryEntity {\n            +categoryId: string\n            +parentId: string\n            +name: string\n            +slug: string\n            +icon: string\n            +description: string\n            +createdAt: Date\n            +updatedAt: Date\n            +parent: CategoryEntity\n            +toJSON()\n        }\n    }\n    CategoryService ..> CategoryEntity\n    CategoryValidationService ..> CategoryEntity\n    CategoryEntity --> CategoryEntity : parent\n\n    namespace Dashboard {\n        class DashboardService {\n            -dashboardRepository: IDashboardRepository\n            -logger: ILoggerService\n            +getOrderStatistics(query)\n            +getRevenueStatistics(query)\n        }\n    }\n\n    namespace Order {\n        class OrderService {\n            -orderRepository: IOrderRepository\n            -logger: ILoggerService\n            -unitOfWork: IUnitOfWork\n            +createOrder(userId, dto)\n            +getListOfOrders(query)\n            +getById(id)\n            +getByCode(code)\n            +updateOrderStatus(id, dto)\n            +deleteOrder(id)\n        }\n        class OrderDetailEntity {\n            +orderDetailId: string\n            +orderId: string\n            +variantId: string\n            +quantity: number\n            +pricePerUnit: number\n            +createdAt: Date\n            +updatedAt: Date\n            +toJSON()\n        }\n        class OrderEntity {\n            +orderId: string\n            +userId: string\n            +orderCode: string\n            +totalPrice: number\n            +status: EOrderStatus\n            +recipientName: string\n            +phoneNumber: string\n            +shippingAddress: string\n            +email: string\n            +createdAt: Date\n            +updatedAt: Date\n            +orderDetails: OrderDetailEntity[]\n            +toJSON()\n        }\n    }\n    OrderService ..> OrderEntity\n    OrderEntity *-- OrderDetailEntity\n\n    namespace Payment {\n        class PaymentService {\n            -providerDiscoveryService: IProviderDiscovery\n            -paymentRepository: IPaymentRepository\n            -logger: ILoggerService\n            -unitOfWork: IUnitOfWork\n            +createPayment(dto)\n            +getListOfPayments(query)\n            +getPaymentById(id)\n            +capturePayment(id)\n            +cancelPayment(id)\n            +refundPayment(id)\n            +handleProviderWebhook(method, payload)\n        }\n        class PaymentAttemptEntity {\n            +paymentAttemptId: string\n            +paymentId: string\n            +paymentMethodId: string\n            +type: EPaymentMethod\n            +orderNumber: number\n            +status: EPaymentStatus\n            +createdAt: Date\n            +updatedAt: Date\n            +transactions: PaymentTransactionEntity[]\n            +canBeRetried()\n            +isFinalState()\n            +cancel()\n            +toJSON()\n        }\n        class PaymentTransactionEntity {\n            +transactionId: string\n            +paymentAttemptId: string\n            +requestBody: string\n            +responseBody: string\n            +type: ETransactionType\n            +createdAt: Date\n            +updatedAt: Date\n            +toJSON()\n        }\n        class PaymentEntity {\n            +paymentId: string\n            +orderId: string\n            +paymentMethodId: string\n            +amount: number\n            +type: EPaymentType\n            +status: EPaymentStatus\n            +createdAt: Date\n            +updatedAt: Date\n            +attempts: PaymentAttemptEntity[]\n            +toJSON()\n        }\n    }\n    PaymentService ..> PaymentEntity\n    PaymentEntity *-- PaymentAttemptEntity\n    PaymentAttemptEntity *-- PaymentTransactionEntity\n\n    namespace PaymentMethod {\n        class PaymentMethodService {\n            -paymentMethodRepository: IPaymentMethodRepository\n            -logger: ILoggerService\n            +getAllPaymentMethods()\n        }\n        class PaymentMethodEntity {\n            +paymentMethodId: string\n            +displayName: string\n            +type: EPaymentMethod\n            +icon: string\n            +description: string\n            +createdAt: Date\n            +updatedAt: Date\n            +toJSON()\n        }\n    }\n    PaymentMethodService ..> PaymentMethodEntity\n\n    namespace Product {\n        class ProductService {\n            -productRepository: IProductRepository\n            -logger: ILoggerService\n            +createProduct(dto)\n            +updateProduct(id, dto)\n            +updateProductStockPrice(id, dto)\n            +deleteProduct(id)\n            +getAllProducts(query)\n            +getAllProductOptions(query)\n            +getProductOptionById(id)\n            +getBestSellers(query)\n        }\n        class ProductOptionEntity {\n            +optionId: string\n            +productId: string\n            +name: string\n            +slug: string\n            +color: string\n            +colorFamily: string\n            +images: string[]\n            +price: number\n            +newPrice: number\n            +outOfStock: boolean\n            +isShow: boolean\n            +search: string\n            +createdAt: Date\n            +updatedAt: Date\n            +variants: ProductVariantEntity[]\n            +getDisplayPrice()\n            +hasDiscount()\n            +getDiscountPercentage()\n            +getThumbnail()\n            +toJSON()\n        }\n        class ProductVariantEntity {\n            +variantId: string\n            +optionId: string\n            +sku: string\n            +size: string\n            +price: number\n            +newPrice: number\n            +stockQuantity: number\n            +createdAt: Date\n            +updatedAt: Date\n            +getDisplayPrice()\n            +hasDiscount()\n            +getDiscountPercentage()\n            +isInStock()\n            +isLowStock(threshold)\n            +toJSON()\n        }\n        class ProductEntity {\n            +productId: string\n            +categoryId: string\n            +name: string\n            +description: string\n            +thumbnail: string\n            +createdAt: Date\n            +updatedAt: Date\n            +options: ProductOptionEntity[]\n            +toJSON()\n        }\n    }\n    ProductService ..> ProductEntity\n    ProductEntity *-- ProductOptionEntity\n    ProductOptionEntity *-- ProductVariantEntity\n\n    namespace Role {\n        class RoleService {\n            -roleRepository: IRoleRepository\n            -logger: ILoggerService\n            +createRole(newRole)\n            +getRoleById(id)\n            +getRoleByName(name)\n            +getListRoles(query)\n            +updateRole(id, updatedRole)\n            +deleteRole(id)\n        }\n        class RoleEntity {\n            +id: string\n            +name: string\n            +description: string\n            +type: EUserType\n            +permissions: EPermission[]\n            +createdAt: Date\n            +updatedAt: Date\n            +toJSON()\n        }\n    }\n    RoleService ..> RoleEntity\n\n    namespace Upload {\n        class UploadService {\n            -imageRepository: IImageRepository\n            -storageProvider: IStorageProvider\n            -logger: ILoggerService\n            +uploadImage(file, title)\n            +bulkUploadImages(files, titles)\n            +getListImages(query)\n            +getImageById(id)\n            +deleteImage(id)\n            +bulkDeleteImages(ids)\n        }\n        class ImageEntity {\n            +id: string\n            +title: string\n            +url: string\n            +format: string\n            +size: number\n            +createdAt: Date\n            +updatedAt: Date\n            +toJSON()\n        }\n    }\n    UploadService ..> ImageEntity\n\n    namespace User {\n        class UserService {\n            -userRepository: IUserRepository\n            -logger: ILoggerService\n            +getListOfUsers(query)\n            +getUserProfile(id)\n            +updateProfile(userId, body)\n        }\n        class UserEntity {\n            +id: string\n            +email: string\n            +phone: string\n            +hashedPassword: string\n            +name: string\n            +avatar: string\n            +birthdate: Date\n            +address: string\n            +updatedAt: Date\n            +createdAt: Date\n            +roleId: string\n            +role: RoleEntity\n            +toJSON()\n        }\n    }\n    UserService ..> UserEntity\n",
  "content_size": 9746,
  "collected_at": "2026-02-06T01:53:25.431967",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0
}