{
  "id": "gh_sequence_00513",
  "source": "github",
  "source_url": "https://github.com/comsa33/porfolio-site/blob/c73cbe20f09305f1683bb39a5801ae130d98c492/public/architecture/evaluator/evaluation-pipeline.mmd",
  "github_repo": "comsa33/porfolio-site",
  "github_file_path": "public/architecture/evaluator/evaluation-pipeline.mmd",
  "diagram_type": "sequence",
  "code": "sequenceDiagram\n    participant User as ì‚¬ìš©ì/Agent\n    participant API as API Endpoint\n    participant Proc as Processor\n    participant Track as ProgressTracker\n    participant Eval as Evaluator\n    participant MinIO as MinIO Storage\n    participant DH as DataHub API\n    \n    Note over User,DH: 1ë‹¨ê³„: QnA ë°ì´í„°ì…‹ ìƒì„±\n    User->>+API: POST /generation/qna<br/>(collection_id, index_id, chat_logs_id)\n    API->>+Proc: create_task(QnAGenerator)\n    Proc->>Track: start(\"QnA ìƒì„±\")\n    Track->>DH: ğŸš€ QnA ìƒì„± 0% ì‹œì‘\n    \n    loop ê° ë¬¸ì„œ ì²˜ë¦¬\n        Proc->>Eval: generate_qna_for_passage()\n        Eval->>Eval: LLMìœ¼ë¡œ ì§ˆë¬¸/ë‹µë³€ ìƒì„±\n        Proc->>Track: update(1)\n        alt 10% ë„ë‹¬\n            Track->>DH: â³ 10% ~ 100% ì§„í–‰ë¥  ì—…ë°ì´íŠ¸\n        end\n    end\n    \n    Proc->>MinIO: save(qna_dataset.csv)\n    MinIO-->>Proc: file_id\n    Proc->>Track: complete([file_id])\n    Track->>DH: âœ… QnA ìƒì„± ì™„ë£Œ\n    Proc-->>-API: {status: \"completed\", files: [qna_dataset.csv]}\n    API-->>-User: Response\n    \n    Note over User,DH: 2ë‹¨ê³„: Recall í‰ê°€ (ê²€ìƒ‰ ì •í™•ë„)\n    User->>+API: POST /evaluation/passage<br/>(qna_file, top_k, chat_logs_id)\n    API->>+Proc: create_task(RecallProcessor)\n    Proc->>MinIO: load(qna_dataset.csv)\n    MinIO-->>Proc: QnA data\n    \n    Proc->>Track: start(\"Recall í‰ê°€\")\n    Track->>DH: ğŸš€ Recall í‰ê°€ 0% ì‹œì‘\n    \n    loop ê° ì§ˆë¬¸ í‰ê°€\n        Proc->>Eval: evaluate_recall(question)\n        Eval->>DH: search_passages(query)\n        DH-->>Eval: retrieved_passages\n        Eval->>Eval: gold_passage ìˆœìœ„ í™•ì¸\n        Proc->>Track: update(1)\n        alt 10% ë„ë‹¬\n            Track->>DH: â³ 10% ~ 100% ì§„í–‰ë¥  ì—…ë°ì´íŠ¸\n        end\n    end\n    \n    Proc->>MinIO: save(recall_results.csv)\n    MinIO-->>Proc: recall_file_id\n    Proc->>MinIO: save(ragas_dataset.jsonl)\n    MinIO-->>Proc: ragas_file_id\n    Proc->>Track: complete([recall_file_id, ragas_file_id])\n    Track->>DH: âœ… Recall í‰ê°€ ì™„ë£Œ\n    Proc-->>-API: {status: \"completed\", files: [recall.csv, ragas.jsonl]}\n    API-->>-User: Response\n    \n    Note over User,DH: 3ë‹¨ê³„: Ragas í‰ê°€ (ìƒì„± í’ˆì§ˆ)\n    User->>+API: POST /evaluation/ragas<br/>(ragas_file, metrics, chat_logs_id)\n    API->>+Proc: create_task(RagasProcessor)\n    Proc->>MinIO: load(ragas_dataset.jsonl)\n    MinIO-->>Proc: Ragas data\n    \n    Proc->>Track: start(\"Ragas í‰ê°€\")\n    Track->>DH: ğŸš€ Ragas í‰ê°€ 0% ì‹œì‘\n    \n    Proc->>Eval: evaluate_ragas_batch(data, metrics)\n    Eval->>Eval: Faithfulness, Answer Relevancy,<br/>Context Precision, Context Recall ê³„ì‚°\n    Proc->>Track: update(batch_size)\n    Track->>DH: â³ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸\n    \n    Proc->>MinIO: save(ragas_results.csv)\n    MinIO-->>Proc: result_file_id\n    Proc->>Track: complete([result_file_id])\n    Track->>DH: âœ… Ragas í‰ê°€ ì™„ë£Œ\n    Proc-->>-API: {status: \"completed\", files: [ragas_results.csv]}\n    API-->>-User: Response\n    \n    Note over User,DH: ë¹„ë™ê¸° ì²˜ë¦¬ (chat_logs_id ìˆì„ ê²½ìš°)\n    rect rgb(255, 245, 200)\n        Note right of Proc: asyncio.create_task()ë¡œ<br/>ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰\n        Note right of Track: ì‹¤ì‹œê°„ ì§„í–‰ë¥ ì„<br/>DataHubì— ì§€ì† ë³´ê³ \n    end\n",
  "content_size": 2934,
  "collected_at": "2026-02-06T01:33:19.359975",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 1,
  "repo_forks": 0,
  "repo_owner": "comsa33",
  "repo_name": "porfolio-site",
  "repo_description": "í¬íŠ¸í´ë¦¬ì˜¤ ì‚¬ì´íŠ¸",
  "repo_language": "TypeScript",
  "repo_topics": [],
  "repo_created_at": "2025-12-13T13:44:58Z",
  "repo_updated_at": "2026-01-31T13:33:35Z",
  "compilation_error": "[WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚"
}