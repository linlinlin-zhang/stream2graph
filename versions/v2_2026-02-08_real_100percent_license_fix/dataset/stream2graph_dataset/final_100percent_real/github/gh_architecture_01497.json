{
  "id": "gh_architecture_01497",
  "source": "github",
  "source_url": "https://github.com/LamequeFernandes/oficina-mecanica-fase1/blob/e9c4b6915faf984d5bb00f0d7264fe9486f621cd/architecture.mmd",
  "github_repo": "LamequeFernandes/oficina-mecanica-fase1",
  "github_file_path": "architecture.mmd",
  "diagram_type": "architecture",
  "code": "graph TB\n    subgraph \"CLIENT LAYER\"\n        Browser[fa:fa-globe Browser<br/>Web Application]\n        Mobile[fa:fa-mobile Mobile App<br/>iOS/Android]\n        Postman[fa:fa-flask Postman<br/>API Testing]\n    end\n\n    subgraph \"AUTHENTICATION SERVICE\"\n        Lambda[fa:fa-bolt AWS Lambda<br/>Auth Service<br/>JWT Generation]\n    end\n\n    subgraph \"KUBERNETES CLUSTER - EKS\"\n        subgraph \"LOAD BALANCER\"\n            LB[fa:fa-balance-scale AWS Load Balancer<br/>Type: LoadBalancer<br/>Port: 80 -> 8000<br/>Health Checks]\n        end\n\n        subgraph \"NAMESPACE: oficina\"\n            subgraph \"PODS - oficina-api\"\n                subgraph \"POD 1\"\n                    subgraph \"PRESENTATION LAYER\"\n                        FastAPI1[fa:fa-server FastAPI App<br/>main.py<br/>Port: 8000]\n                        \n                        Routes1[fa:fa-route API Routes<br/>- /usuarios<br/>- /clientes<br/>- /funcionarios<br/>- /veiculos<br/>- /pecas<br/>- /servicos<br/>- /orcamentos<br/>- /ordens]\n                        \n                        Middleware1[Middleware<br/>- CORS<br/>- JWT Validation<br/>- Exception Handlers<br/>- JSON Logging]\n                    end\n\n                    subgraph \"APPLICATION LAYER\"\n                        UseCases1[fa:fa-cogs Use Cases<br/>Business Logic<br/>- CriarVeiculo<br/>- CriarOrcamento<br/>- CriarOrdemServico]\n                        \n                        DTOs1[fa:fa-exchange DTOs<br/>Data Transfer Objects<br/>Request/Response Models]\n                        \n                        Interfaces1[fa:fa-plug Interfaces<br/>Abstract Repositories<br/>Dependency Injection]\n                    end\n\n                    subgraph \"DOMAIN LAYER\"\n                        Entities1[fa:fa-cube Entities<br/>Business Objects<br/>- Veiculo<br/>- Orcamento<br/>- OrdemServico<br/>- Cliente<br/>- Funcionario]\n                        \n                        Rules1[fa:fa-check Business Rules<br/>Validations<br/>Domain Logic]\n                    end\n\n                    subgraph \"INFRASTRUCTURE LAYER\"\n                        Repos1[fa:fa-database Repositories<br/>SQLAlchemy<br/>Database Access]\n                        \n                        Models1[fa:fa-table ORM Models<br/>SQLAlchemy Models<br/>Database Mapping]\n                        \n                        Mappers1[fa:fa-arrows Mappers<br/>Entity <-> Model<br/>Conversion Logic]\n                    end\n\n                    subgraph \"CORE LAYER\"\n                        Config1[fa:fa-cog Config<br/>Environment Variables<br/>Settings]\n                        \n                        DB1[fa:fa-plug Database Connection<br/>SQLAlchemy Session<br/>Connection Pool]\n                        \n                        Security1[fa:fa-lock Security<br/>JWT Validation<br/>Auth Dependencies]\n                    end\n                end\n\n                Pod2[fa:fa-cube POD 2<br/>Same Structure<br/>Load Balanced]\n                Pod3[fa:fa-cube POD 3<br/>Same Structure<br/>Load Balanced]\n            end\n\n            HPA[fa:fa-expand Horizontal Pod Autoscaler<br/>Min: 2, Max: 10<br/>Target CPU: 70%<br/>Auto Scaling]\n\n            Secrets[fa:fa-key Kubernetes Secrets<br/>- DB_HOST<br/>- DB_PASSWORD<br/>- JWT_SECRET<br/>Base64 Encoded]\n\n            ConfigMaps[fa:fa-file-code ConfigMaps<br/>- APP_ENV<br/>- LOG_LEVEL<br/>- CORS_ORIGINS]\n        end\n    end\n\n    subgraph \"DATABASE LAYER - AWS RDS\"\n        RDS[(fa:fa-database MySQL 8.0<br/>oficina_db<br/>Managed Service)]\n        \n        subgraph \"DATABASE SCHEMA\"\n            TableClientes[(fa:fa-table clientes<br/>- id PK<br/>- cpf UNIQUE<br/>- nome<br/>- email<br/>- ativo)]\n            \n            TableFuncionarios[(fa:fa-table funcionarios<br/>- id PK<br/>- cpf UNIQUE<br/>- nome<br/>- email<br/>- ativo)]\n            \n            TableVeiculos[(fa:fa-table veiculos<br/>- id PK<br/>- placa<br/>- modelo<br/>- ano<br/>- cliente_id FK)]\n            \n            TablePecas[(fa:fa-table pecas<br/>- id PK<br/>- nome<br/>- preco<br/>- estoque)]\n            \n            TableServicos[(fa:fa-table servicos<br/>- id PK<br/>- nome<br/>- preco<br/>- tempo_estimado)]\n            \n            TableOrcamentos[(fa:fa-table orcamentos<br/>- id PK<br/>- valor_total<br/>- status<br/>- veiculo_id FK)]\n            \n            TableOrdens[(fa:fa-table ordens_servico<br/>- id PK<br/>- status<br/>- data_inicio<br/>- data_fim<br/>- orcamento_id FK)]\n        end\n    end\n\n    subgraph \"OBSERVABILITY\"\n        Datadog[fa:fa-chart-line Datadog APM<br/>- Distributed Tracing<br/>- Performance Metrics<br/>- Error Tracking]\n        \n        CloudWatch[fa:fa-chart-bar CloudWatch<br/>- Container Logs<br/>- Application Logs<br/>- Metrics & Alarms]\n        \n        Prometheus[fa:fa-chart-area Prometheus<br/>- Custom Metrics<br/>- Future Integration]\n    end\n\n    subgraph \"CI/CD PIPELINE\"\n        GitHub[fa:fa-github GitHub Actions<br/>Workflow<br/>Triggered on Push]\n        \n        subgraph \"PIPELINE STAGES\"\n            Tests[fa:fa-flask Run Tests<br/>pytest<br/>Coverage Report]\n            \n            Build[fa:fa-docker Build Docker Image<br/>docker build<br/>Tag: latest]\n            \n            Push[fa:fa-cloud Push to Registry<br/>Docker Hub<br/>seu-usuario/oficina-api]\n            \n            Deploy[fa:fa-rocket Deploy to EKS<br/>kubectl apply<br/>Rolling Update]\n            \n            Health[fa:fa-heartbeat Health Checks<br/>Verify Deployment<br/>Readiness Probes]\n        end\n    end\n\n    subgraph \"CONTAINER REGISTRY\"\n        DockerHub[fa:fa-docker Docker Hub<br/>Container Images<br/>oficina-api:latest<br/>oficina-api:v1.0.0]\n    end\n\n    %% Client Flow\n    Browser -->|HTTPS Request| LB\n    Mobile -->|HTTPS Request| LB\n    Postman -->|HTTPS Request| LB\n    \n    %% Authentication Flow\n    Browser -->|POST /auth| Lambda\n    Lambda -->|JWT Token| Browser\n    Browser -->|Bearer Token| LB\n    \n    %% Load Balancer to Pods\n    LB -->|Distribute Traffic| FastAPI1\n    LB -->|Distribute Traffic| Pod2\n    LB -->|Distribute Traffic| Pod3\n    \n    %% Internal Pod Flow\n    FastAPI1 --> Middleware1\n    Middleware1 --> Routes1\n    Routes1 --> UseCases1\n    UseCases1 --> DTOs1\n    DTOs1 --> Interfaces1\n    Interfaces1 --> Entities1\n    Entities1 --> Rules1\n    Rules1 --> Repos1\n    Repos1 --> Models1\n    Models1 --> Mappers1\n    \n    %% Core Dependencies\n    Repos1 --> DB1\n    Routes1 --> Security1\n    FastAPI1 --> Config1\n    \n    %% Secrets and Config\n    FastAPI1 -->|Read| Secrets\n    FastAPI1 -->|Read| ConfigMaps\n    \n    %% Database Connection\n    DB1 -->|SQL Queries| RDS\n    RDS --> TableClientes\n    RDS --> TableFuncionarios\n    RDS --> TableVeiculos\n    RDS --> TablePecas\n    RDS --> TableServicos\n    RDS --> TableOrcamentos\n    RDS --> TableOrdens\n    \n    %% Auto Scaling\n    HPA -->|Monitors & Scales| FastAPI1\n    HPA -->|Monitors & Scales| Pod2\n    HPA -->|Monitors & Scales| Pod3\n    \n    %% Observability\n    FastAPI1 -.->|Send Traces| Datadog\n    FastAPI1 -.->|Send Logs| CloudWatch\n    Pod2 -.->|Send Logs| CloudWatch\n    Pod3 -.->|Send Logs| CloudWatch\n    FastAPI1 -.->|Export Metrics| Prometheus\n    \n    %% CI/CD Flow\n    GitHub -->|Trigger| Tests\n    Tests -->|Pass| Build\n    Build -->|Create Image| Push\n    Push -->|Upload| DockerHub\n    Push -->|Deploy| Deploy\n    Deploy -->|Update| FastAPI1\n    Deploy -->|Update| Pod2\n    Deploy -->|Update| Pod3\n    Deploy -->|Verify| Health\n    \n    %% Container Registry\n    FastAPI1 -.->|Pull Image| DockerHub\n    Pod2 -.->|Pull Image| DockerHub\n    Pod3 -.->|Pull Image| DockerHub\n\n    %% Styling\n    classDef client fill:#4CAF50,stroke:#2E7D32,stroke-width:2px,color:#fff\n    classDef auth fill:#FFA726,stroke:#EF6C00,stroke-width:2px,color:#fff\n    classDef k8s fill:#326CE5,stroke:#1A4D9F,stroke-width:2px,color:#fff\n    classDef presentation fill:#2196F3,stroke:#1565C0,stroke-width:2px,color:#fff\n    classDef application fill:#03A9F4,stroke:#0277BD,stroke-width:2px,color:#fff\n    classDef domain fill:#00BCD4,stroke:#00838F,stroke-width:2px,color:#fff\n    classDef infrastructure fill:#009688,stroke:#00695C,stroke-width:2px,color:#fff\n    classDef core fill:#4DB6AC,stroke:#00796B,stroke-width:2px,color:#fff\n    classDef database fill:#673AB7,stroke:#4527A0,stroke-width:2px,color:#fff\n    classDef monitoring fill:#FF5722,stroke:#D84315,stroke-width:2px,color:#fff\n    classDef cicd fill:#28A745,stroke:#1E7E34,stroke-width:2px,color:#fff\n    classDef registry fill:#2196F3,stroke:#0D47A1,stroke-width:2px,color:#fff\n    \n    class Browser,Mobile,Postman client\n    class Lambda auth\n    class LB,HPA,Secrets,ConfigMaps,Pod2,Pod3 k8s\n    class FastAPI1,Routes1,Middleware1 presentation\n    class UseCases1,DTOs1,Interfaces1 application\n    class Entities1,Rules1 domain\n    class Repos1,Models1,Mappers1 infrastructure\n    class Config1,DB1,Security1 core\n    class RDS,TableClientes,TableFuncionarios,TableVeiculos,TablePecas,TableServicos,TableOrcamentos,TableOrdens database\n    class Datadog,CloudWatch,Prometheus monitoring\n    class GitHub,Tests,Build,Push,Deploy,Health cicd\n    class DockerHub registry\n",
  "content_size": 9060,
  "collected_at": "2026-02-06T01:47:01.601878",
  "license": "none",
  "license_name": "No License",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license_url": "",
  "repo_stars": 1,
  "repo_forks": 0
}