{
  "id": "gh_architecture_01888",
  "source": "github",
  "source_url": "https://github.com/emujicad/my-selfhosted-ai-kit/blob/2097a04f4e68d01f720a80a265e6f4eab67239c8/diagrams_mmd/architecture_complete.mmd",
  "github_repo": "emujicad/my-selfhosted-ai-kit",
  "github_file_path": "diagrams_mmd/architecture_complete.mmd",
  "diagram_type": "architecture",
  "code": "%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#1a1a2e', 'primaryTextColor':'#eaeaea', 'primaryBorderColor':'#4a4a6a', 'lineColor':'#6c63ff', 'fontSize':'13px', 'fontFamily':'Inter, Segoe UI, sans-serif'}}}%%\ngraph TB\n    subgraph FRONTEND [\"ğŸŒ Frontend Layer\"]\n        USER([\"ğŸ‘¤ User<br/>Browser\"])\n        HAPROXY[\"ğŸ”€ HAProxy<br/>Load Balancer<br/>:80 / :443\"]\n    end\n    \n    subgraph SECURITY [\"ğŸ” Security Layer\"]\n        KC[\"ğŸ” Keycloak<br/>SSO Provider<br/>:8080\"]\n        MODSEC[\"ğŸ›¡ï¸ ModSecurity<br/>WAF\"]\n        KCINIT[\"âš™ï¸ keycloak-init<br/>Auto-config\"]\n    end\n    \n    subgraph AI [\"ğŸ¤– AI Services\"]\n        OLLAMA[\"ğŸ§  Ollama<br/>LLM Engine<br/>:11434\"]\n        WEBUI[\"ğŸ’¬ Open WebUI<br/>Chat Interface<br/>:3000\"]\n    end\n    \n    subgraph AUTOMATION [\"âš™ï¸ Automation\"]\n        N8N[\"âš™ï¸ n8n<br/>Workflows<br/>:5678\"]\n        JENKINS[\"ğŸ”§ Jenkins<br/>CI/CD<br/>:8081â†’8082\"]\n        WATCH[\"ğŸ”„ Watchtower<br/>Auto-updates\"]\n        SYNC[\"ğŸ“‚ Sync<br/>Data sync\"]\n    end\n    \n    subgraph MONITORING [\"ğŸ“Š Monitoring Stack\"]\n        PROM[\"ğŸ“Š Prometheus<br/>Metrics<br/>:9090\"]\n        GRAF[\"ğŸ“ˆ Grafana<br/>Dashboards<br/>:3001\"]\n        ALERT[\"ğŸ”” AlertManager<br/>Alerts<br/>:9093\"]\n        BACKUP[\"ğŸ’¾ Backup Runner<br/>Daily backups\"]\n    end\n    \n    subgraph EXPORTERS [\"ğŸ“¡ Metrics Exporters\"]\n        direction LR\n        NVEXP[\"nvidia<br/>:9400\"]\n        OLLEXP[\"ollama<br/>:9888\"]\n        N8NEXP[\"n8n<br/>:9889\"]\n        OWEXP[\"webui<br/>:9890\"]\n        REDEXP[\"redis<br/>:9121\"]\n        PGEXP[\"postgres<br/>:9187\"]\n        NODEEXP[\"node<br/>:9100\"]\n        CADV[\"cAdvisor<br/>:8082\"]\n    end\n    \n    subgraph DATA [\"ğŸ—„ï¸ Data Layer\"]\n        PG[\"ğŸ—„ï¸ PostgreSQL<br/>Main DB<br/>:5432\"]\n        REDIS[\"ğŸ’¾ Redis<br/>Cache<br/>:6379\"]\n        QDRANT[\"ğŸ”® Qdrant<br/>Vectors<br/>:6333\"]\n        PGVEC[\"ğŸ“ pgvector<br/>:5433\"]\n    end\n    \n    %% User Flow\n    USER -->|\"HTTP/S\"| HAPROXY\n    HAPROXY -->|\"/chat\"| WEBUI\n    HAPROXY -->|\"/grafana\"| GRAF\n    HAPROXY -->|\"/prometheus\"| PROM\n    HAPROXY -->|\"/alertmanager\"| ALERT\n    HAPROXY --> MODSEC\n    \n    %% AI Flow\n    WEBUI -->|\"Inference\"| OLLAMA\n    WEBUI -->|\"OIDC\"| KC\n    WEBUI -->|\"Cache\"| REDIS\n    WEBUI -->|\"Data\"| PG\n    WEBUI -->|\"Embeddings\"| QDRANT\n    \n    %% Automation Flow\n    N8N -->|\"AI Calls\"| OLLAMA\n    N8N -->|\"OIDC\"| KC\n    N8N -->|\"Data\"| PG\n    JENKINS -->|\"OIDC\"| KC\n    \n    %% Monitoring Flow\n    GRAF -->|\"Query\"| PROM\n    GRAF -->|\"OIDC\"| KC\n    PROM -->|\"Alerts\"| ALERT\n    \n    %% Exporters to Prometheus\n    NVEXP -.-> PROM\n    OLLEXP -.-> PROM\n    N8NEXP -.-> PROM\n    OWEXP -.-> PROM\n    REDEXP -.-> PROM\n    PGEXP -.-> PROM\n    NODEEXP -.-> PROM\n    CADV -.-> PROM\n    \n    %% Security init\n    KCINIT -->|\"Configure\"| KC\n    \n    %% Styling\n    classDef frontend fill:#0d47a1,stroke:#1976d2,stroke-width:2px,color:#fff\n    classDef security fill:#b71c1c,stroke:#d32f2f,stroke-width:2px,color:#fff\n    classDef ai fill:#1565c0,stroke:#1e88e5,stroke-width:2px,color:#fff\n    classDef automation fill:#4a148c,stroke:#7b1fa2,stroke-width:2px,color:#fff\n    classDef monitoring fill:#1b5e20,stroke:#388e3c,stroke-width:2px,color:#fff\n    classDef exporters fill:#e65100,stroke:#f57c00,stroke-width:2px,color:#fff\n    classDef data fill:#37474f,stroke:#607d8b,stroke-width:2px,color:#fff\n    \n    class USER,HAPROXY frontend\n    class KC,MODSEC,KCINIT security\n    class OLLAMA,WEBUI ai\n    class N8N,JENKINS,WATCH,SYNC automation\n    class PROM,GRAF,ALERT,BACKUP monitoring\n    class NVEXP,OLLEXP,N8NEXP,OWEXP,REDEXP,PGEXP,NODEEXP,CADV exporters\n    class PG,REDIS,QDRANT,PGVEC data\n",
  "content_size": 3570,
  "collected_at": "2026-02-06T02:04:35.616167",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶ã€‚",
  "license": "apache-2.0",
  "license_name": "Apache License 2.0",
  "license_url": "https://api.github.com/licenses/apache-2.0",
  "repo_stars": 0,
  "repo_forks": 0
}