{
  "id": "gh_flowchart_00639",
  "source": "github",
  "source_url": "https://github.com/carrowmw/phd-project-gnn/blob/07a2695df02fe44b7507c15b3ae9b069b0bca0d7/docs/archive/tensor_flow.mmd",
  "github_repo": "carrowmw/phd-project-gnn",
  "github_file_path": "docs/archive/tensor_flow.mmd",
  "diagram_type": "flowchart",
  "code": "flowchart TD\n    subgraph DataLoader\n        A[Input Data] --> B[SpatioTemporalDataset]\n        B --> C[\"collate_fn()\"]\n        C -->|\"x [batch, seq, 1]\"| D[DataLoader Output]\n        C -->|\"x_mask [batch, seq, 1]\"| D\n        C -->|\"y [batch, horizon, 1]\"| D\n        C -->|\"y_mask [batch, horizon, 1]\"| D\n        C -->|\"node_indices [batch]\"| D\n        C -->|\"adj [nodes, nodes]\"| D\n    end\n\n    D --> E[\"STGNNTrainer.train_epoch()\"]\n\n    subgraph STGNNTrainer\n        E -->|\"x, adj, x_mask\"| F[\"STGNN.forward()\"]\n        F -->|\"y_pred\"| G[\"Loss Computation\"]\n        G --> H[\"Backward + Optimizer Step\"]\n    end\n\n    subgraph STGNN[\"STGNN Model\"]\n        F -->|\"x [batch, nodes, seq, features]\"| I[\"TemporalGCN.forward()\"]\n        I -->|\"encoded [batch, nodes, seq, hidden]\"| J[\"Last Hidden State + Decoder\"]\n        J -->|\"predictions [batch, nodes, horizon, features]\"| F\n\n        subgraph TemporalGCN\n            I -->|\"For each timestep\"| K[\"Per-timestep processing\"]\n            K -->|\"x_t [batch, nodes, features]\"| L[\"GraphConvolution.forward()\"]\n            L -->|\"h [batch, nodes, hidden]\"| M[\"Node Attention\"]\n            M -->|\"h_node_attn [batch, hidden]\"| N[\"Stack outputs\"]\n            N -->|\"out_stacked [batch, seq, hidden]\"| O[\"Temporal Attention\"]\n            O --> P[\"GRU + Output Layer\"]\n            P -->|\"out_final [batch, nodes, seq, features]\"| I\n        end\n    end\n\n    classDef shapeCheck fill:#f9a,stroke:#333,stroke-width:2px;\n    classDef noShapeCheck fill:#bdf,stroke:#333,stroke-width:1px;\n\n    class F shapeCheck;\n    class I shapeCheck;\n    class K,L,M,N,O,P noShapeCheck;",
  "content_size": 1607,
  "collected_at": "2026-02-06T01:46:13.587938",
  "compilation_status": "failed",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "compilation_error": "[WinError 2] 系统找不到指定的文件。"
}