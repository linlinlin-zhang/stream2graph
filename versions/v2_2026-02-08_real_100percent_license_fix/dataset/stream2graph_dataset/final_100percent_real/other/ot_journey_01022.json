{
  "id": "ot_journey_01022",
  "source": "other",
  "source_url": "https://github.com/hieucao2404/CarbonCreditMarketplace/blob/7ffea1406d01a6537eef27efe7d0d5e8248e365e/docs/db_er.mmd",
  "source_type": "github_search",
  "github_repo": "hieucao2404/CarbonCreditMarketplace",
  "diagram_type": "journey",
  "code": "erDiagram\n    USERS {\n        UUID user_id PK\n        VARCHAR username\n        VARCHAR email\n        VARCHAR password_hash\n        VARCHAR role     \"EV_OWNER | BUYER | CVA | ADMIN\"\n        VARCHAR phone\n        VARCHAR full_name\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n    }\n\n    VEHICLES {\n        UUID vehicle_id PK\n        UUID user_id FK\n        VARCHAR vin\n        VARCHAR model\n        DATE registration_date\n        TIMESTAMP created_at\n    }\n\n    JOURNEY_DATA {\n        UUID journey_id PK\n        UUID vehicle_id FK\n        UUID user_id FK\n        DECIMAL distance_km\n        DECIMAL energy_consumed_kwh\n        TIMESTAMP start_time\n        TIMESTAMP end_time\n        DECIMAL co2_reduced_kg\n        TIMESTAMP created_at\n    }\n\n    CARBON_CREDITS {\n        UUID credit_id PK\n        UUID user_id FK\n        UUID journey_id FK\n        DECIMAL co2_reduced_kg\n        DECIMAL credit_amount\n        VARCHAR status    \"PENDING|VERIFIED|LISTED|SOLD|REJECTED\"\n        TIMESTAMP created_at\n        TIMESTAMP verified_at\n        TIMESTAMP listed_at\n    }\n\n    CREDIT_LISTINGS {\n        UUID listing_id PK\n        UUID credit_id FK\n        VARCHAR listing_type \"FIXED|AUCTION\"\n        DECIMAL price\n        DECIMAL min_bid\n        TIMESTAMP auction_end_time\n        VARCHAR status       \"ACTIVE|CLOSED|CANCELLED\"\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n    }\n\n    TRANSACTIONS {\n        UUID transaction_id PK\n        UUID credit_id FK\n        UUID listing_id FK\n        UUID buyer_id FK\n        UUID seller_id FK\n        DECIMAL amount\n        VARCHAR status       \"PENDING|COMPLETED|CANCELLED|DISPUTED\"\n        TIMESTAMP created_at\n        TIMESTAMP completed_at\n    }\n\n    WALLETS {\n        UUID wallet_id PK\n        UUID user_id FK\n        DECIMAL credit_balance\n        DECIMAL cash_balance\n        TIMESTAMP updated_at\n    }\n\n    CERTIFICATES {\n        UUID certificate_id PK\n        UUID transaction_id FK\n        UUID buyer_id FK\n        UUID credit_id FK\n        TIMESTAMP issue_date\n        DECIMAL co2_reduced_kg\n        VARCHAR certificate_code\n    }\n\n    AUDIT_LOGS {\n        UUID audit_id PK\n        UUID credit_id FK\n        UUID verifier_id FK\n        VARCHAR action    \"SUBMITTED|VERIFIED|REJECTED\"\n        TEXT comments\n        TIMESTAMP created_at\n    }\n\n    DISPUTES {\n        UUID dispute_id PK\n        UUID transaction_id FK\n        UUID raised_by_id FK\n        TEXT reason\n        VARCHAR status    \"OPEN|RESOLVED|CLOSED\"\n        TEXT resolution\n        TIMESTAMP created_at\n        TIMESTAMP resolved_at\n        UUID resolved_by_id FK\n    }\n\n    PAYMENTS {\n        UUID payment_id PK\n        UUID transaction_id FK\n        UUID payer_id FK\n        UUID payee_id FK\n        DECIMAL amount\n        VARCHAR payment_method\n        VARCHAR payment_status\n        VARCHAR payment_reference\n        TIMESTAMP created_at\n    }\n\n    NOTIFICATIONS {\n        UUID notification_id PK\n        UUID user_id FK\n        VARCHAR notification_type\n        VARCHAR title\n        TEXT message\n        BOOLEAN is_read\n        TIMESTAMP created_at\n        UUID related_entity_id\n        VARCHAR related_entity_type\n    }\n\n    %% Relationships (cardinality)\n    USERS ||--o{ VEHICLES : \"owns\"\n    USERS ||--o{ JOURNEY_DATA : \"records\"\n    VEHICLES ||--o{ JOURNEY_DATA : \"has\"\n    USERS ||--o{ CARBON_CREDITS : \"issues\"\n    JOURNEY_DATA ||--|| CARBON_CREDITS : \"may generate\"\n    CARBON_CREDITS ||--o{ CREDIT_LISTINGS : \"listed as\"\n    CREDIT_LISTINGS ||--o{ TRANSACTIONS : \"sold via\"\n    USERS ||--o{ TRANSACTIONS : \"buys\"\n    USERS ||--o{ TRANSACTIONS : \"sells\"\n    USERS ||--|| WALLETS : \"has\"\n    TRANSACTIONS ||--o{ PAYMENTS : \"has\"\n    TRANSACTIONS ||--o{ CERTIFICATES : \"may produce\"\n    CARBON_CREDITS ||--o{ AUDIT_LOGS : \"audited by\"\n    TRANSACTIONS ||--o{ DISPUTES : \"may have\"\n    USERS ||--o{ NOTIFICATIONS : \"receives\"\n\n\nRelationships\n\nUsers → Vehicles : 1:N\n\nUsers → Journey Data : 1:N\n\nUsers → Carbon Credits : 1:N\n\nVehicles → Journey Data : 1:N\n\nJourney Data → Carbon Credits : 1:N\n\nCarbon Credits → Credit Listings : 1:N\n\nCredit Listings → Transactions : 1:N\n\nCarbon Credits → Transactions : 1:N\n\nUsers → Transactions (Buyer/Seller) : 1:N\n\nTransactions → Certificates : 1:1\n\nCarbon Credits → Certificates : 1:N\n\nCarbon Credits → Audit Logs : 1:N\n\nTransactions → Disputes : 1:N\n\nUsers → Disputes (Raised/Resolved) : 1:N\n\nTransactions → Payments : 1:N\n\nUsers → Payments (Payer/Payee) : 1:N\n\nUsers → Wallets : 1:1\n\nUsers → Notifications : 1:N",
  "content_size": 4490,
  "collected_at": "2026-02-06T11:02:09.903257",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "other_source",
  "license_name": "Other Source (GitHub-based)"
}