{
  "id": "ot_stateDiagram_00010",
  "source": "other",
  "source_url": "https://github.com/zone17/sovren/blob/d3da3358e52da6ae6b2365e89401eca50f337a0c/docs/architecture/diagrams/cicd-dashboard-deployment-process.mmd",
  "source_type": "github_search_special",
  "github_repo": "zone17/sovren",
  "diagram_type": "stateDiagram",
  "code": "stateDiagram-v2\n    [*] --> Idle: Dashboard Loaded\n\n    Idle --> FetchingData: Initial Load\n    FetchingData --> DisplayingData: Data Fetched\n    DisplayingData --> MonitoringDeployment: Deployment Detected\n\n    MonitoringDeployment --> QualityGatesStage: Stage: Quality Gates\n    QualityGatesStage --> QualityGatesPassed: All Checks Pass\n    QualityGatesStage --> QualityGatesFailed: Checks Failed\n\n    QualityGatesFailed --> DisplayingError: Show Error Details\n    DisplayingError --> AwaitingUserAction: Suggest Remediation\n\n    QualityGatesPassed --> DockerBuildStage: Stage: Docker Build\n    DockerBuildStage --> DockerBuildComplete: Build Success\n    DockerBuildStage --> DockerBuildFailed: Build Failed\n\n    DockerBuildFailed --> DisplayingError\n\n    DockerBuildComplete --> DeploymentStage: Stage: Staging Deploy\n    DeploymentStage --> HealthChecking: Deployment Complete\n    HealthChecking --> HealthChecksPassed: All Healthy\n    HealthChecking --> HealthChecksFailed: Health Check Failed\n\n    HealthChecksFailed --> AutoRollback: Trigger Automatic Rollback\n    AutoRollback --> RollbackInProgress: Rolling Back...\n    RollbackInProgress --> RollbackComplete: Rollback Success\n    RollbackComplete --> DisplayingError\n\n    HealthChecksPassed --> SmokeTestStage: Stage: Smoke Tests\n    SmokeTestStage --> SmokeTestsRunning: Running 28 Tests\n    SmokeTestsRunning --> SmokeTestsPassed: 28/28 Passed\n    SmokeTestsRunning --> SmokeTestsFailed: Tests Failed\n\n    SmokeTestsFailed --> AutoRollback\n\n    SmokeTestsPassed --> TrafficShiftStage: Stage: Traffic Shift\n    TrafficShiftStage --> TrafficShift10: 10% Traffic\n    TrafficShift10 --> MonitoringMetrics: Monitor Error Rate\n    MonitoringMetrics --> MetricsHealthy: Error Rate < 5%\n    MonitoringMetrics --> MetricsUnhealthy: Error Rate >= 5%\n\n    MetricsUnhealthy --> AutoRollback\n\n    MetricsHealthy --> TrafficShift50: 50% Traffic\n    TrafficShift50 --> MonitoringMetrics50: Monitor Metrics\n    MonitoringMetrics50 --> Metrics50Healthy: Healthy\n    MonitoringMetrics50 --> Metrics50Unhealthy: Unhealthy\n\n    Metrics50Unhealthy --> AutoRollback\n\n    Metrics50Healthy --> TrafficShift100: 100% Traffic\n    TrafficShift100 --> FinalValidation: Final Validation\n    FinalValidation --> DeploymentSuccess: All Checks Pass\n    FinalValidation --> ValidationFailed: Validation Failed\n\n    ValidationFailed --> AutoRollback\n\n    DeploymentSuccess --> CollectingMetrics: Update Metrics\n    CollectingMetrics --> NotifyingTeam: Send Slack Notification\n    NotifyingTeam --> DisplayingSuccess: Show Success Status\n    DisplayingSuccess --> MonitoringProduction: Continuous Monitoring\n\n    MonitoringProduction --> MonitoringProduction: Health Checks Every 30s\n    MonitoringProduction --> ProductionIssue: Issue Detected\n    ProductionIssue --> AwaitingUserAction: Alert Team\n\n    AwaitingUserAction --> ManualRollback: User Triggers Rollback\n    ManualRollback --> RollbackInProgress\n\n    AwaitingUserAction --> RetryDeployment: User Retries\n    RetryDeployment --> QualityGatesStage\n\n    AwaitingUserAction --> InvestigatingIssue: View Logs & Errors\n    InvestigatingIssue --> AwaitingUserAction: User Decides Next Action\n\n    DisplayingSuccess --> Idle: No Active Deployment\n    RollbackComplete --> Idle: Deployment Rolled Back\n\n    note right of QualityGatesStage\n        Runs:\n        - ESLint checks\n        - TypeScript type checking\n        - Unit tests\n        - Security scans\n        - Circular dependency check\n        Duration: ~5-7 minutes\n    end note\n\n    note right of DockerBuildStage\n        Runs:\n        - Multi-stage Docker build\n        - Multi-arch (amd64, arm64)\n        - Trivy security scan\n        - Image signing (Cosign)\n        - SBOM generation\n        - Push to GHCR\n        Duration: ~3-5 minutes\n    end note\n\n    note right of DeploymentStage\n        Runs:\n        - Blue-green deployment\n        - Database migrations\n        - Service startup\n        - Initial health checks\n        Duration: ~3-5 minutes\n    end note\n\n    note right of SmokeTestStage\n        Runs:\n        - 28 automated smoke tests\n        - API endpoint tests\n        - Database connectivity\n        - Cache functionality\n        - Auth flow\n        Duration: ~2-3 minutes\n    end note\n\n    note right of TrafficShiftStage\n        Progressive shift:\n        - 10% → wait 2 min → validate\n        - 50% → wait 2 min → validate\n        - 100% → final validation\n        Duration: ~5-7 minutes\n    end note\n\n    note left of AutoRollback\n        Automatic rollback triggers:\n        - Health check failures (3 consecutive)\n        - Error rate > 5% (2 min)\n        - Response time P95 > 1000ms\n        - Smoke test failures\n        Rollback time: < 2 minutes\n    end note\n\n    note left of ManualRollback\n        Manual rollback actions:\n        - Emergency rollback button\n        - Requires confirmation\n        - One-click execution\n        - Real-time progress\n        Rollback time: < 2 minutes\n    end note\n",
  "content_size": 4972,
  "collected_at": "2026-02-06T10:36:43.897514",
  "compilation_status": "failed",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license": "other_source",
  "license_name": "Other Source (GitHub-based)"
}