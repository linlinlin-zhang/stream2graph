{
  "id": "gh_architecture_01482",
  "source": "github",
  "source_url": "https://github.com/trutkowski22/claude-task-master/blob/80b6b87d8682d53235785872ed02e4e8c2106272/project-overlord-context/Pre-CLI-Removal-MMDs/Task-Manager/task-manager_research.mmd",
  "github_repo": "trutkowski22/claude-task-master",
  "github_file_path": "project-overlord-context/Pre-CLI-Removal-MMDs/Task-Manager/task-manager_research.mmd",
  "diagram_type": "architecture",
  "code": "flowchart TB\n    subgraph research-Imports[\"research-Imports\"]\n        I1[\"IMPORT: fs, FROM: fs\"]\n        I2[\"IMPORT: path, FROM: path\"]\n        I7[\"IMPORT: ContextGatherer, FROM: /claude-task-master/scripts/modules/utils/contextGatherer.js\"]\n        I8[\"IMPORT: FuzzyTaskSearch, FROM: /claude-task-master/scripts/modules/utils/fuzzyTaskSearch.js\"]\n        I9[\"IMPORT: generateTextService, FROM: /claude-task-master/scripts/modules/ai-services-unified.js\"]\n        I10[\"IMPORT: getPromptManager, FROM: /claude-task-master/scripts/modules/prompt-manager.js\"]\n        I11[\"IMPORT: log, FROM: /claude-task-master/scripts/modules/utils.js\"]\n        I12[\"IMPORT: findProjectRoot, FROM: /claude-task-master/scripts/modules/utils.js\"]\n        I13[\"IMPORT: readJSON, FROM: /claude-task-master/scripts/modules/utils.js\"]\n        I14[\"IMPORT: flattenTasksWithSubtasks, FROM: /claude-task-master/scripts/modules/utils.js\"]\n    end\n    subgraph research-Dependencies[\"research-Dependencies\"]\n        D1[\"DEP: AI services (OpenAI, Anthropic, etc.)\"]\n        D2[\"DEP: File system\"]\n        D3[\"DEP: Terminal UI libraries\"]\n        D4[\"DEP: Syntax highlighting\"]\n        D5[\"DEP: Interactive prompts\"]\n    end\n    subgraph research-FunctionsDefined[\"research-Functions Defined\"]\n        FU1[\"FUNCTION: performResearch\"]\n        FU2[\"FUNCTION: displayDetailedTokenBreakdown\"]\n        FU3[\"FUNCTION: processCodeBlocks\"]\n        FU4[\"FUNCTION: displayResearchResults\"]\n        FU5[\"FUNCTION: handleFollowUpQuestions\"]\n        FU6[\"FUNCTION: handleSaveToTask\"]\n        FU7[\"FUNCTION: handleSaveToFile\"]\n        FU8[\"FUNCTION: formatConversationForFile\"]\n        FU9[\"FUNCTION: formatConversationForSaving\"]\n        FU10[\"FUNCTION: buildConversationContext\"]\n    end\n    subgraph research-Exports[\"research-Exports\"]\n        E1[\"EXP: performResearch\"]\n    end\n    subgraph research-Parameters[\"research-Parameters\"]\n        P1[\"PARAM: {string} query - Research query/prompt\"]\n        P2[\"PARAM: {Object} options - Research options\"]\n        P3[\"PARAM: {Array<string>} options.taskIds - Task/subtask IDs for context\"]\n        P4[\"PARAM: {Array<string>} options.filePaths - File paths for context\"]\n        P5[\"PARAM: {string} options.customContext - Additional custom context\"]\n        P6[\"PARAM: {boolean} options.includeProjectTree - Include project file tree\"]\n        P7[\"PARAM: {string} options.detailLevel - Detail level: 'low', 'medium', 'high'\"]\n        P8[\"PARAM: {string} options.projectRoot - Project root directory\"]\n        P9[\"PARAM: {string} options.tag - Tag for the task\"]\n        P10[\"PARAM: {boolean} options.saveToFile - Whether to save results to file\"]\n        P11[\"PARAM: {Object} context - Execution context\"]\n        P12[\"PARAM: {Object} context.session - MCP session object\"]\n        P13[\"PARAM: {Object} context.mcpLog - MCP logger object\"]\n        P14[\"PARAM: {string} context.commandName - Command name for telemetry\"]\n        P15[\"PARAM: {string} context.outputType - Output type ('cli' or 'mcp')\"]\n        P16[\"PARAM: {string} outputFormat - Output format ('text' or 'json')\"]\n        P17[\"PARAM: {boolean} allowFollowUp - Whether to allow follow-up questions\"]\n    end\n    subgraph research-Constants[\"research-Constants\"]\n        C1[\"CONST: isMCP, VALUE: !!mcpLog\"]\n        C2[\"CONST: projectRoot, VALUE: providedProjectRoot || findProjectRoot()\"]\n        C3[\"CONST: logFn, VALUE: logger function wrapper\"]\n        C4[\"CONST: contextGatherer, VALUE: new ContextGatherer()\"]\n        C5[\"CONST: finalTaskIds, VALUE: combined task IDs array\"]\n        C6[\"CONST: autoDiscoveredIds, VALUE: fuzzy search results\"]\n        C7[\"CONST: tasksData, VALUE: readJSON result\"]\n        C8[\"CONST: flattenedTasks, VALUE: flattenTasksWithSubtasks result\"]\n        C9[\"CONST: fuzzySearch, VALUE: new FuzzyTaskSearch()\"]\n        C10[\"CONST: contextResult, VALUE: contextGatherer.gather() result\"]\n        C11[\"CONST: gatheredContext, VALUE: contextResult.context\"]\n        C12[\"CONST: tokenBreakdown, VALUE: contextResult.tokenBreakdown\"]\n        C13[\"CONST: promptManager, VALUE: getPromptManager result\"]\n        C14[\"CONST: aiResult, VALUE: generateTextService result\"]\n        C15[\"CONST: researchResult, VALUE: aiResult.mainResult\"]\n        C16[\"CONST: telemetryData, VALUE: aiResult.telemetryData\"]\n        C17[\"CONST: conversationHistory, VALUE: conversation array\"]\n        C18[\"CONST: interactiveSaveInfo, VALUE: save tracking object\"]\n    end\n    subgraph research-ExecutionFlow[\"research-Execution Flow\"]\n        FL1[\"Initialize project root and logging systems\"]\n        FL2[\"Auto-discover relevant tasks using fuzzy search\"]\n        FL3[\"Gather context from tasks, files, and project tree\"]\n        FL4[\"Load prompts using PromptManager with context\"]\n        FL5[\"Count tokens for context and prompts breakdown\"]\n        FL6[\"Display detailed token analysis in CLI mode\"]\n        FL7[\"Call AI service with research role and context\"]\n        FL8[\"Process and format AI response results\"]\n        FL9[\"Display research results with syntax highlighting\"]\n        FL10[\"Handle follow-up questions in interactive mode\"]\n        FL11[\"Process save-to-task or save-to-file requests\"]\n        FL12[\"Build conversation context for follow-ups\"]\n        FL13[\"Format and save conversation history\"]\n        FL14[\"Return research results with telemetry data\"]\n    end\n    subgraph research[\"research.js\"]\n        research-Imports\n        research-Dependencies\n        research-FunctionsDefined\n        research-Exports\n        research-Parameters\n        research-Constants\n        research-ExecutionFlow\n    end\n    FL1 --> FL2\n    FL2 --> FL3\n    FL3 --> FL4\n    FL4 --> FL5\n    FL5 --> FL6\n    FL6 --> FL7\n    FL7 --> FL8\n    FL8 --> FL9\n    FL9 --> FL10\n    FL10 --> FL11\n    FL11 --> FL12\n    FL12 --> FL13\n    FL13 --> FL14",
  "content_size": 5825,
  "collected_at": "2026-02-06T01:46:49.571478",
  "license": "none",
  "license_name": "No License",
  "compilation_status": "success",
  "compilation_error": "[WinError 2] 系统找不到指定的文件。",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0
}