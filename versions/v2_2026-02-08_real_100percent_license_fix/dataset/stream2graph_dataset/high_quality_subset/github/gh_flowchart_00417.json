{
  "id": "gh_flowchart_00417",
  "source": "github",
  "source_url": "https://github.com/irahulsawhney/crypto-concepts/blob/421b34506119fb1ef623014ff5ccda6016d46210/diagrams/03-aead.mmd",
  "github_repo": "irahulsawhney/crypto-concepts",
  "github_file_path": "diagrams/03-aead.mmd",
  "diagram_type": "flowchart",
  "code": "%% AEAD (Authenticated Encryption with Associated Data) â€” Mermaid Cheat Sheet\n%% Save as .mmd and preview with any Mermaid renderer.\n\n%% ------------ FLOW OVERVIEW ------------\nflowchart TB\n  Title[\"ğŸ” AEAD: Authenticated Encryption with Associated Data\"]\n  \n  subgraph Sender[\"ğŸ“¤ Sender (Encrypt)\"]\n    direction TB\n    P[\"ğŸ“„ Plaintext P<br/>(secret data)\"]\n    AD[\"ğŸ“‹ Associated Data AD<br/>â€¢ NOT encrypted (sent plaintext)<br/>â€¢ IS authenticated (tamper-evident)<br/>â€¢ Should contain NON-SECRET metadata<br/>â€¢ Examples: headers, userID, timestamp, API version<br/>â€¢ âš ï¸ Never put secrets in AD!\"]\n    K[(\"ğŸ”‘ Secret Key K<br/>(shared with receiver)\")]\n    N[\"ğŸ² Nonce N<br/>â€¢ Unique per message with same key K<br/>â€¢ Can be sequential (1, 2, 3...) or random<br/>â€¢ NEVER reuse nonce with same key<br/>â€¢ Nonce reuse = catastrophic security failure\"]\n    \n    P --> E\n    AD --> E\n    K -.->|encrypts & signs| E\n    N --> E\n    \n    E[\"âš™ï¸ AEAD Encrypt\"]\n    \n    E --> C[\"ğŸ”’ Ciphertext C<br/>(encrypted P)\"]\n    E --> TagCreate[\"ğŸ”§ Tag Creation:<br/>T = MAC (Message Auth Code) with K, N, C, AD<br/><br/>MAC Algorithm (e.g., HMAC, Poly1305):<br/>â€¢ Takes inputs: K, N, C, AD<br/>â€¢ Runs cryptographic hash function<br/>â€¢ Outputs fixed-size tag T<br/><br/>Tag binds C + AD + N to secret key K\"]\n    TagCreate --> T[\"âœ… Auth Tag T<br/>(proves integrity)\"]\n    \n    SNote[\"ğŸ’¡ Key Point:<br/>Tag T = HMAC-SHA256 with K, N, C, AD or similar<br/>One-way function: Cannot reverse to get K<br/>Change ANY input â†’ completely different tag<br/>Without K, attacker cannot create valid tag\"]\n  end\n\n  C --> Channel\n  T --> Channel\n  N --> Channel\n  AD --> Channel\n  \n  subgraph Channel[\"ğŸŒ Network / Untrusted Channel\"]\n    Bundle[\"ğŸ“¦ Sent Together:<br/>â€¢ Ciphertext C (encrypted - secret)<br/>â€¢ Auth Tag T (public - proves integrity)<br/>â€¢ Nonce N (public - must be unique)<br/>â€¢ Associated Data AD (plaintext - visible)<br/><br/>âš ï¸ Attacker can see AD, N, C, T<br/>âš ï¸ But cannot modify without breaking tag<br/>âš ï¸ And cannot decrypt C without key K\"]\n  end\n\n  Channel --> Receiver\n  \n  subgraph Receiver[\"ğŸ“¥ Receiver (Verify & Decrypt)\"]\n    direction TB\n    KR[(\"ğŸ”‘ Secret Key K<br/>(same as sender)\")]\n    \n    RecompTag[\"ğŸ”§ Recompute Tag:<br/>T' = MAC (Message Auth Code) with K, N, C, AD<br/><br/>Using received C, AD, N\"]\n    \n    Compare[\"âš–ï¸ Compare Tags:<br/>Is T' = T?\"]\n    \n    KR -.->|used to compute T'| RecompTag\n    RecompTag --> Compare\n    \n    Compare -->|âœ… Match!| Valid[\"ğŸ‰ Success!<br/>â†’ Decrypt C â†’ P<br/><br/>âœ“ C, AD, N unchanged<br/>âœ“ Sender had key K<br/>âœ“ No tampering\"]\n    Compare -->|âŒ No Match!| Invalid[\"ğŸš« REJECT<br/>No plaintext revealed<br/><br/>Why tags differ:<br/>â€¢ C or AD or N was changed, or Wrong K used â†’ different T'<br/>â€¢ Attacker can't forge T without K\"]\n    \n    RNote[\"ğŸ’¡ Key Point:<br/>Receiver recomputes tag T' using same inputs<br/>If T' â‰  T, something changed or wrong key<br/>Attacker without K cannot create matching tag\"]\n  end\n\n  %% Styling\n  style Sender stroke:#1976d2,stroke-width:2px\n  style Channel stroke:#f57c00,stroke-width:2px\n  style Receiver stroke:#388e3c,stroke-width:2px\n  style Title fill:none,stroke:none,font-size:16px\n  style Valid stroke:#2e7d32,stroke-width:2px\n  style Invalid stroke:#c62828,stroke-width:2px\n  style T stroke:#f9a825,stroke-width:2px\n  style SNote stroke:#9e9e9e,stroke-width:1px\n  style RNote stroke:#9e9e9e,stroke-width:1px\n\n  %% Notes\n  %% - Confidentiality: P is hidden inside C.\n  %% - Integrity & Authenticity: T binds (C, AD, N) to K; tampering causes verify failure.\n  %% - AD is authenticated but not encrypted (visible headers/metadata).\n  %% - N must NEVER repeat with the same K. Reuse can break security catastrophically.\n\n  %% AT-A-GLANCE\n  %% â€¢ AEAD = Authenticated Encryption with Associated Data\n  %% â€¢ Protects two things at once:\n  %%     1) Confidentiality (encrypts P into C)\n  %%     2) Integrity/Authenticity (T proves C+AD+N come from someone with K)\n  %% â€¢ Associated Data (AD):\n  %%     - Not encrypted (visible), but authenticated (tamper-evident)\n  %%     - Examples: headers, user/account IDs, API version, timestamps\n  %% â€¢ Nonce/IV (N):\n  %%     - Unique per (K) to prevent reuse attacks\n  %% â€¢ Typical algorithms:\n  %%     - AES-GCM, ChaCha20-Poly1305",
  "content_size": 4245,
  "collected_at": "2026-02-06T01:43:58.243533",
  "compilation_status": "success",
  "license": "none",
  "license_name": "No License",
  "license_url": "",
  "repo_stars": 0,
  "repo_forks": 0,
  "repo_owner": "irahulsawhney",
  "repo_name": "crypto-concepts",
  "repo_description": "Developing my understanding of cryptography concepts",
  "repo_language": "Mermaid",
  "repo_topics": [],
  "repo_created_at": "2025-11-10T16:00:29Z",
  "repo_updated_at": "2025-11-14T15:10:20Z"
}