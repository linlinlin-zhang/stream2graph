{
  "id": "gl_block-beta_00280",
  "source": "gitlab",
  "source_url": "https://github.com/YaduEnc/PlasticWorld/blob/0b9863fbe608d4756537b8e0bd846bb707645b90/SystemDesign/Backend%20Architecture-2026-01-09-023316.mmd",
  "source_note": "collected_from_github_additional",
  "github_repo": "YaduEnc/PlasticWorld",
  "diagram_type": "block-beta",
  "code": "---\nconfig:\n  layout: dagre\n---\nflowchart TB\n subgraph subGraph0[\"Client Layer\"]\n        WEB[\"Web App<br>React.js/Next.js\"]\n        MOBILE[\"Mobile Apps<br>React Native<br>iOS &amp; Android\"]\n        WEB_SOCKET_CLIENT[\"WebSocket Client<br>Socket.io-client\"]\n        ENCRYPTION_CLIENT[\"E2E Encryption<br>Signal Protocol<br>Client-side Keys\"]\n  end\n subgraph subGraph1[\"CDN & Security Layer\"]\n        CF[\"Cloudflare<br>DNS + DDoS Protection\"]\n        CF_TUNNEL[\"Cloudflare Tunnel<br>cloudflared daemon\"]\n        SSL[\"SSL/TLS 1.3<br>Certificate Management\"]\n  end\n subgraph subGraph2[\"Reverse Proxy Layer\"]\n        NGINX[\"Nginx<br>Reverse Proxy<br>Load Balancer<br>Rate Limiting\"]\n  end\n subgraph subGraph3[\"API Gateway\"]\n        API_GATEWAY[\"API Gateway<br>Request Routing<br>JWT Validation<br>Version Control /api/v1/\"]\n  end\n subgraph subGraph4[\"Authentication Service\"]\n        AUTH_API[\"Auth API<br>REST Endpoints\"]\n        FIREBASE_ADMIN[\"Firebase Admin SDK<br>Token Verification\"]\n        JWT_SERVICE[\"JWT Service<br>Access &amp; Refresh Tokens\"]\n        SESSION_MGR[\"Session Manager<br>Redis-based Sessions\"]\n  end\n subgraph subGraph5[\"User Service\"]\n        USER_API[\"User API<br>Profile CRUD\"]\n        USER_SEARCH[\"Search Engine<br>Indexed Queries<br>Username/Email/Phone\"]\n        USER_VALIDATOR[\"Validation Service<br>Uniqueness Checks\"]\n  end\n subgraph subGraph6[\"Friendship Service\"]\n        FRIEND_API[\"Friendship API<br>Request Management\"]\n        FRIEND_STATE[\"State Machine<br>Pendingâ†’Accepted/Denied\"]\n        BLOCK_SERVICE[\"Block/Unblock Service\"]\n  end\n subgraph subGraph7[\"Messaging Service\"]\n        MSG_API[\"Message API<br>REST Endpoints\"]\n        WS_SERVER[\"WebSocket Server<br>Socket.io<br>Real-time Events\"]\n        MSG_QUEUE[\"Message Queue<br>Offline User Handling\"]\n        TYPING_SERVICE[\"Typing Indicators<br>Ephemeral Events\"]\n        RECEIPT_SERVICE[\"Read Receipts<br>Delivery Status\"]\n  end\n subgraph subGraph8[\"Encryption Service\"]\n        KEY_EXCHANGE[\"Key Exchange<br>X3DH Protocol\"]\n        DOUBLE_RATCHET[\"Double Ratchet<br>Forward Secrecy\"]\n        KEY_STORAGE[\"Server Key Store<br>Public Keys Only\"]\n  end\n subgraph subGraph9[\"Application Services Layer\"]\n        subGraph4\n        subGraph5\n        subGraph6\n        subGraph7\n        subGraph8\n  end\n subgraph subGraph10[\"PostgreSQL Database\"]\n        DB_USERS[(\"Users Table<br>id, firebase_uid<br>username, email<br>phone, name, age\")]\n        DB_FRIENDS[(\"Friendships Table<br>requester_id<br>addressee_id<br>status, timestamps\")]\n        DB_MESSAGES[(\"Messages Table<br>sender_id, recipient_id<br>encrypted_content<br>status, timestamps\")]\n        DB_KEYS[(\"Encryption Keys<br>user_id, device_id<br>identity_key<br>prekeys\")]\n  end\n subgraph subGraph11[\"Redis Cache\"]\n        REDIS_SESSION[\"Session Store<br>session:user_id\"]\n        REDIS_ONLINE[\"Online Status<br>online:user_id<br>TTL: 30s\"]\n        REDIS_TYPING[\"Typing Indicators<br>typing:conv_id:user_id<br>TTL: 3s\"]\n        REDIS_QUEUE[\"Message Queue<br>msg_queue:user_id\"]\n        REDIS_RATE[\"Rate Limiting<br>rate_limit:user_id\"]\n  end\n subgraph subGraph12[\"Data Layer\"]\n        subGraph10\n        subGraph11\n  end\n subgraph subGraph13[\"External Services\"]\n        FIREBASE[\"Firebase Auth<br>Google Sign-In<br>OAuth Provider\"]\n  end\n subgraph subGraph14[\"Monitoring & Logging\"]\n        PROMETHEUS[\"Prometheus<br>Metrics Collection<br>API/WebSocket/DB metrics\"]\n        GRAFANA[\"Grafana<br>Dashboards<br>Alerts\"]\n        LOGS[\"Application Logs<br>Winston/Python Logging<br>Structured JSON\"]\n  end\n subgraph Infrastructure[\"Infrastructure\"]\n        DOCKER[\"Docker Containers<br>Isolated Services\"]\n        LINUX[\"Linux Server<br>Ubuntu/Debian<br>Self-hosted\"]\n  end\n    WEB --> CF\n    MOBILE --> CF\n    CF --> CF_TUNNEL\n    CF_TUNNEL --> SSL\n    SSL --> NGINX\n    NGINX --> API_GATEWAY & REDIS_RATE\n    API_GATEWAY --> AUTH_API & USER_API & FRIEND_API & MSG_API\n    NGINX -. ws:// .-> WS_SERVER\n    AUTH_API --> FIREBASE_ADMIN & JWT_SERVICE\n    FIREBASE_ADMIN --> FIREBASE\n    JWT_SERVICE --> SESSION_MGR\n    SESSION_MGR --> REDIS_SESSION\n    USER_API --> USER_SEARCH & USER_VALIDATOR & DB_USERS\n    FRIEND_API --> FRIEND_STATE & BLOCK_SERVICE & DB_FRIENDS\n    MSG_API --> MSG_QUEUE & DB_MESSAGES & KEY_EXCHANGE\n    WS_SERVER --> TYPING_SERVICE & RECEIPT_SERVICE & REDIS_ONLINE\n    MSG_QUEUE --> REDIS_QUEUE\n    TYPING_SERVICE --> REDIS_TYPING\n    RECEIPT_SERVICE --> DB_MESSAGES\n    KEY_EXCHANGE --> DOUBLE_RATCHET\n    DOUBLE_RATCHET --> KEY_STORAGE\n    KEY_STORAGE --> DB_KEYS\n    WEB_SOCKET_CLIENT --> ENCRYPTION_CLIENT\n    ENCRYPTION_CLIENT -. Encrypted Payload .-> WS_SERVER\n    AUTH_API -. Metrics .-> PROMETHEUS\n    USER_API -. Metrics .-> PROMETHEUS\n    FRIEND_API -. Metrics .-> PROMETHEUS\n    MSG_API -. Metrics .-> PROMETHEUS\n    WS_SERVER -. Metrics .-> PROMETHEUS\n    DB_USERS -. Metrics .-> PROMETHEUS\n    PROMETHEUS --> GRAFANA\n    AUTH_API -. Logs .-> LOGS\n    USER_API -. Logs .-> LOGS\n    FRIEND_API -. Logs .-> LOGS\n    MSG_API -. Logs .-> LOGS\n    WS_SERVER -. Logs .-> LOGS\n    DOCKER --> AUTH_API & USER_API & FRIEND_API & MSG_API & WS_SERVER & DB_USERS & REDIS_SESSION & NGINX\n    LINUX --> DOCKER\n\n    style WEB fill:#61dafb\n    style MOBILE fill:#61dafb\n    style CF fill:#f38020\n    style NGINX fill:#009639\n    style DB_USERS fill:#336791\n    style DB_FRIENDS fill:#336791\n    style DB_MESSAGES fill:#336791\n    style DB_KEYS fill:#336791\n    style REDIS_SESSION fill:#dc382d\n    style REDIS_ONLINE fill:#dc382d\n    style REDIS_TYPING fill:#dc382d\n    style REDIS_QUEUE fill:#dc382d\n    style FIREBASE fill:#ffca28\n    style PROMETHEUS fill:#e6522c\n    style GRAFANA fill:#f46800\n    style DOCKER fill:#2496ed\n    style LINUX fill:#fcc624",
  "content_size": 5715,
  "collected_at": "2026-02-06T14:06:10.273792",
  "compilation_status": "success",
  "license": "mit",
  "license_name": "MIT License",
  "license_url": "https://api.github.com/licenses/mit",
  "repo_stars": 2,
  "repo_forks": 0,
  "repo_owner": "YaduEnc",
  "repo_name": "PlasticWorld",
  "repo_description": "Production-grade messaging platform backend with E2E encryption",
  "repo_language": "TypeScript",
  "repo_topics": [],
  "repo_created_at": "2026-01-09T03:28:09Z",
  "repo_updated_at": "2026-01-25T13:07:52Z"
}