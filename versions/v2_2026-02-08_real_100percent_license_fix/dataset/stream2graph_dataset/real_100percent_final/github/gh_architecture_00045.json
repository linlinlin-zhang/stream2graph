{
  "id": "gh_architecture_00045",
  "source": "github",
  "source_url": "https://github.com/GSA-TTS/dns/blob/0ea34be0f2463ee3165f03b6de079a0186eecf25/doc/bootstrap.mmd",
  "github_repo": "GSA-TTS/dns",
  "github_file_path": "doc/bootstrap.mmd",
  "diagram_type": "architecture",
  "code": "graph TD\n    %% Define main resources\n    User(\"CircleCI User\")\n    MainS3[\"S3 Bucket<br>tts-dns-terraform-state<br>(Main)\"]\n    LogsS3[\"S3 Bucket<br>tts-dns-terraform-state-logs<br>(Logs)\"]\n    LogsLogsS3[\"S3 Bucket<br>tts-dns-terraform-state-logs-logs<br>(Logs of Logs)\"]\n    ReplicaS3[\"S3 Bucket<br>tts-dns-terraform-state-replica<br>(DR Replica)\"]\n    ReplicaLogsS3[\"S3 Bucket<br>tts-dns-terraform-state-replica-logs<br>(DR Logs)\"]\n    \n    %% KMS Keys\n    KMSKey[\"KMS Key<br>terraform-state-key<br>(East)\"]\n    KMSKeyWest[\"KMS Key<br>terraform-state-key-west<br>(West)\"]\n    \n    %% SNS Topics\n    SNSMain[\"SNS Topic<br>terraform-state-bucket-events\"]\n    SNSLogs[\"SNS Topic<br>terraform-logs-bucket-events\"]\n    SNSReplica[\"SNS Topic<br>terraform-replica-bucket-events\"]\n    \n    %% IAM Resources\n    IAMUser[\"IAM User<br>circleci-deployer\"]\n    IAMPolicy[\"IAM Policy<br>route53-deployment\"]\n    IAMRole[\"IAM Role<br>terraform-state-replication-role\"]\n    IAMReplication[\"IAM Policy<br>terraform-state-replication-policy\"]\n    \n    %% Email Notifications\n    Email[\"Email Notifications<br><a href='mailto:devops+dns@gsa.gov'>notification_email</a>\"]\n    \n    %% Security configurations\n    PABMain[\"Public Access Block<br>(Main Bucket)\"]\n    PABLogs[\"Public Access Block<br>(Logs Bucket)\"]\n    PABLogsLogs[\"Public Access Block<br>(Logs of Logs Bucket)\"]\n    PABReplica[\"Public Access Block<br>(Replica Bucket)\"]\n    PABReplicaLogs[\"Public Access Block<br>(Replica Logs Bucket)\"]\n\n    %% Define regions\n    subgraph \"US-EAST-1 (Primary Region)\"\n        MainS3\n        LogsS3\n        LogsLogsS3\n        KMSKey\n        SNSMain\n        SNSLogs\n        IAMUser\n        IAMPolicy\n        IAMRole\n        IAMReplication\n        PABMain\n        PABLogs\n        PABLogsLogs\n    end\n\n    subgraph \"US-WEST-2 (DR Region)\"\n        ReplicaS3\n        ReplicaLogsS3\n        KMSKeyWest\n        SNSReplica\n        PABReplica\n        PABReplicaLogs\n    end\n    \n    %% Define relationships\n    User -->|Uses| IAMUser\n    IAMUser -->|Has| IAMPolicy\n    IAMPolicy -->|Manages| MainS3\n    IAMPolicy -->|Uses| KMSKey\n    \n    MainS3 -->|Replicated to| ReplicaS3\n    MainS3 -->|Logs to| LogsS3\n    LogsS3 -->|Logs to| LogsLogsS3\n    ReplicaS3 -->|Logs to| ReplicaLogsS3\n    \n    MainS3 -->|Encrypted by| KMSKey\n    LogsS3 -->|Encrypted by| KMSKey\n    LogsLogsS3 -->|Encrypted by| KMSKey\n    ReplicaS3 -->|Encrypted by| KMSKeyWest\n    ReplicaLogsS3 -->|Encrypted by| KMSKeyWest\n    \n    MainS3 -->|Notifies| SNSMain\n    LogsS3 -->|Notifies| SNSLogs\n    ReplicaS3 -->|Notifies| SNSReplica\n    \n    SNSMain -->|Sends to| Email\n    SNSLogs -->|Sends to| Email\n    SNSReplica -->|Sends to| Email\n    \n    IAMRole -->|Assumes| IAMReplication\n    IAMReplication -->|Allows| MainS3\n    IAMReplication -->|To| ReplicaS3\n    \n    MainS3 --- PABMain\n    LogsS3 --- PABLogs\n    LogsLogsS3 --- PABLogsLogs\n    ReplicaS3 --- PABReplica\n    ReplicaLogsS3 --- PABReplicaLogs\n    ",
  "content_size": 2946,
  "collected_at": "2026-02-06T01:24:39.092585"
}